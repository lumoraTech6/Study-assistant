<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Exam Study Assistant</title>
    <link rel="icon" href="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 256 256'%3E%3Cstyle%3E.cap-fill { fill: %2305359c; } .tassel-fill { fill: %23125dff; }%3C/style%3E%3Cpath class='cap-fill' d='M128 172.8l-112-56v44.8l112 56 112-56v-44.8l-112 56z'/%3E%3Cpath class='cap-fill' d='M240 72.8L128 16l-112 56.8 112 56 112-56.8zM32 172.8h192v16H32v-16z'/%3E%3Cpath class='tassel-fill' d='M208 88.8v56h16v-56h-16z'/%3E%3C/svg%3E" type="image/svg+xml">
    <!-- Fonts and Icons -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;700;900&family=Montserrat:wght@300;400;600&display=swap" rel="stylesheet">
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.css" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/7.0.0/css/all.min.css">
    <link href="https://fonts.googleapis.com/css2?family=Edu+NSW+ACT+Cursive:wght@400..700&display=swap" rel="stylesheet">
    
    <!-- Libraries -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/three.js/r128/three.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/gsap/3.9.1/gsap.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/vanta@latest/dist/vanta.halo.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>


     <!-- META TAGS FOR LINK PREVIEWS (Open Graph & Twitter Cards) -->
    <!-- Open Graph tags for platforms like Facebook, LinkedIn, etc. -->
    <meta property="og:title" content="Exam Study Assistant for DTI">
    <meta property="og:description" content="An interactive quiz and study platform designed to help DTI students excel in their exams.">
    <!-- Corrected: Replace the SVG data URL with a direct link to an image.
         Social media crawlers need a valid URL to an image file (e.g., .png, .jpg). -->
    <meta property="og:image" content="https://placehold.co/1200x630/05359c/ffffff?text=Exam+Study+Assistant">
    <meta property="og:url" content="https://study-assistant-one.vercel.app">
    <!-- Recommended: Add the type of content, e.g., 'website'. -->
    <meta property="og:type" content="website">

    <!-- Twitter Card tags for Twitter/X -->
    <!-- Use summary_large_image for a more prominent preview. -->
    <meta name="twitter:card" content="summary_large_image">
    <!-- Twitter-specific title and description. You can reuse the Open Graph ones. -->
    <meta name="twitter:title" content="Exam Study Assistant for DTI">
    <meta name="twitter:description" content="An interactive quiz and study platform designed to help DTI students excel in their exams.">
    <!-- The Twitter image should also be a direct URL. -->
    <meta name="twitter:image" content="https://placehold.co/1200x630/05359c/ffffff?text=Exam+Study+Assistant">
    <!-- Recommended: Add a site handle for attribution on Twitter. -->
    <meta name="twitter:site" content="@yourtwitterhandle">
    <!-- END OF META TAGS -->

   <style>
    /* Global Styles */
    
* {
    margin: 0;
    padding: 0;
    box-sizing: border-box;
    list-style: none;
    text-decoration: none;
}

:root {
    --primary-color: #05359c;
    --secondary-color: #125dff;
    --accent-color: #4e73df;
    --text-color: #333;
    --light-text: #fff;
    --background: #f0f4f8; /* Changed background */
    --card-bg: #fff;
    --success: #28a745;
    --warning: #ffc107;
    --danger: #dc3545;
    --info: #17a2b8;
    --border-color: #e0e0e0;
    --hover-glow: rgba(78, 115, 223, 0.4);
}

body {
    font-family: 'Inter', sans-serif; /* Changed font */
    background: var(--background);
    color: var(--text-color);
    overflow-x: hidden;
    min-height: 100vh;
}

/* App Structure */
#app {
    display: flex;
    min-height: 100vh;
    position: relative;
}

/* Enhanced Loading Screen */
#loading-screen {
    position: fixed;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    background-color: #000;
    z-index: 10000;
    display: flex;
    justify-content: center;
    align-items: center;
    color: white;
    flex-direction: column;
    text-align: center;
    transition: opacity 0.5s ease;
}

#tunnel-canvas {
    position: absolute;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    z-index: 1;
}

.text-container {
    position: relative;
    z-index: 2;
    text-align: center;
    opacity: 0; /* Initially hidden, controlled by GSAP */
}

.men {
    font-family: "Edu NSW ACT Cursive", cursive;
    font-optical-sizing: auto;
    font-weight: 500;
}

.text-4xl {
    font-size: 2.25rem;
    line-height: 2.5rem;
}

.md\:text-6xl {
    font-size: 3.75rem;
    line-height: 1;
}

.font-black {
    font-weight: 900;
}

.tracking-wider {
    letter-spacing: 0.05em;
}

.uppercase {
    text-transform: uppercase;
}

.text-lg {
    font-size: 1.125rem;
    line-height: 1.75rem;
}

.md\:text-xl {
    font-size: 1.25rem;
    line-height: 1.75rem;
}

.font-light {
    font-weight: 300;
}

.mt-2 {
    margin-top: 0.5rem;
}

.text-gray-300 {
    color: rgb(209 213 219);
}

.text-2xl {
    font-size: 1.5rem;
    line-height: 2rem;
}

.md\:text-4xl {
    font-size: 2.25rem;
    line-height: 2.5rem;
}

.font-bold {
    font-weight: 700;
}

.text-cyan-300 {
    color: rgb(103 232 249);
}

.tracking-wide {
    letter-spacing: 0.025em;
}

.absolute {
    position: absolute;
}

/* Login Page Styles - FIXED */
#login-page {
    position: fixed;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    z-index: 10000;
    overflow: hidden;
}

/* .login-container {
    position: absolute;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    display: flex;
    justify-content: center;
    align-items: center;
    padding: 20px;
}

#vanta-bg {
    position: absolute;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    z-index: 1;
} */


/* Styles for the new Kaleidoscope Background */
#kaleidoscope-bg {
    position: fixed;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    z-index: 1; /* Keep it in the background */
    cursor: crosshair;
}

/* Ensure the login form stays on top */
.login-container {
    position: relative;
    z-index: 2;
     width: 100%;
    height: 100%;
    display: flex;
    justify-content: center;
    align-items: center;
    padding: 20px;
}

.login {
    text-align: center;
    position: relative;
    width: 350px;
    max-width: 90%;
    padding: 40px;
    height: fit-content;
    background-color: rgba(77, 77, 77, 0.685);
    border: 1px solid rgba(255, 255, 255, 0.5);
    border-radius: 15px;
    z-index: 2;
    backdrop-filter: blur(25px);
    box-shadow: 10px 10px 40px rgba(0, 0, 0, 0.2),
                -10px -10px 40px rgba(0, 0, 0, 0.2);
}
.login img {
    height: 80px;
    margin-bottom: 30px;
}

@media (max-width:400px) {
   .login {
        width: 90%;
        padding: 25px 20px;
    }
    
    .login h1 {
        font-size: 1.5rem;
        margin-bottom: 30px;
    }
    
    .login form .input-box input,
    .login form .input-box select {
        padding: 0.8rem 2.7rem 0.8rem 1rem;
        font-size: 1rem;
    }
}

.login h1 {
    font-size: 1.8rem;
    color: #fff;
    margin-bottom: 40px;
    margin-top: 0;
    text-align: center;
}

.login form {
    width: 100%;
    height: 100%;
    outline: none;
    border: none;
}

.login form .input-box {
    width: 100%;
    position: relative;
    margin-bottom: 30px;
    display: flex;
}

.login form .input-box input {
    width: 100%;
    border: none;
    padding: 1rem 2.7rem 1rem 1rem;
    border-radius: 10px;
    color: black;
    background-color: rgba(255, 255, 255, 0.2);
    border: 1px solid rgba(255, 255, 255, 0.4);
    font-size: 1.2em;
    font-weight: 500;
}

.login form .input-box select {
    width: 100%;
    border: none;
    padding: 1rem 1rem 1rem 1rem;
    border-radius: 10px;
    background-color: rgba(255, 255, 255, 0.2);
    border: 1px solid rgba(255, 255, 255, 0.4);
    font-size: 1.1em;
    font-weight: 500;
    outline: none;
}

.login form .input-box input::placeholder {
    color: #fff;
    font-size: 0.8rem;
    transition: 0.5s ease;
}

.login form .input-box input:focus::placeholder {
    opacity: 0;
}

.login form .input-box input:focus {
    outline: none;
}

.login form .input-box i {
    position: absolute;
    top: 50%;
    right: 15px;
    transform: translateY(-50%);
    color: #fff;
    font-size: 1.2rem;
}

.login form .rembar {
    margin-bottom: 30px;
    width: 100%;
    text-align: left;
    font-size: 1.1em;
    font-weight: 600;
    display: flex;
    align-items: center;
    color: white;
}

.login form .rembar input {
    margin-right: 10px;
}

.login form button {
    width: 100%;
    border: none;
    padding: 1rem;
    border-radius: 10px;
    color: #fff;
    margin-bottom: 30px;
    background-color: #161623;
    border: 1px solid rgba(255, 255, 255, 0.4);
    transition: 0.5s ease;
    cursor: pointer;
    font-weight: 600;
    text-align: center;
    font-size: 1.1rem;
}

.login form button:hover {
    background-color: #111;
}

/* Add this to hide content until login */
.content-hidden {
    display: none !important;
}

/* Navigation */
.side-nav {
    width: 250px;
    background-color: var(--secondary-color);
    height: 100vh;
    position: fixed;
    left: 0;
    top: 0;
    z-index: 100;
    overflow-y: auto;
     transform: translateX(0);
    transition: none; /* Remove CSS transitions if using GSAP */
    display: flex;
    flex-direction: column;
}

.side-nav ul {
    padding: 0;
    flex-grow: 1;
}

.side-nav ul li a {
    display: flex;
    align-items: center;
    gap: 15px;
    text-decoration: none;
    font-size: 16px;
    font-weight: 500;
    color: var(--light-text);
    position: relative;
    padding: 18px 0 18px 38px;
    transition: all 0.3s;
}

.side-nav ul li a i {
    width: 20px;
    text-align: center;
}

.side-nav ul li a:before {
    content: '';
    position: absolute;
    top: 0;
    right: 0;
    width: 0%;
    height: 100%;
    background: var(--background);
    border-radius: 40px 0 0 40px;
    z-index: -1;
    transition: all 300ms ease-in-out;
}

.side-nav ul li a:hover, .side-nav ul li a.active {
    color: var(--primary-color);
}

.side-nav ul li a:hover:before, .side-nav ul li a.active:before {
    width: 95%;
}

.logo {
    width: 120px;
    height: 120px;
    border-radius: 50%;
    overflow: hidden;
    margin: 25px auto;
    border: 4px solid var(--secondary-color);
    background: #ddd;
}

.logo .image-container {
    width: 100%;
    height: 100%;
    display: flex;
    justify-content: center;
    align-items: center;
    font-size: 12px;
    color: var(--text-color);
}

.logo img {
    width: 100%;
    height: 100%;
    object-fit: cover;
}

.stat {
    width: 100%;
    text-align: center;
    margin-bottom: 30px;
    color: var(--light-text);
}

.stat p {
    font-size: 1.1em;
    font-weight: 600;
}

/* Main Content */
.main-content {
    margin-left: 240px;
    flex: 1;
    padding: 30px;
    transition: margin-left 0.3s ease;
}

/* Hamburger Menu */
.ham {
    display: none;
    position: fixed;
    top: 15px;
    right: 15px;
    z-index: 1001;
     transform: translateX(0);
    transition: none; /* Remove CSS transitions if using GSAP */
}

.ham-m {
    height: 45px;
    width: 45px;
    border-radius: 8px;
    background: var(--secondary-color);
    display: flex;
    justify-content: center;
    align-items: center;
    font-size: 1.4em;
    color: white;
    cursor: pointer;
    box-shadow: 0 4px 10px rgba(0,0,0,0.2);
}

/* Pages */
.page {
    display: none;
}

.page.active {
    display: block;
    animation: fadeIn 0.5s ease-in-out;
}

@keyframes fadeIn {
    from { opacity: 0; transform: translateY(10px); }
    to { opacity: 1; transform: translateY(0); }
}

/* Generic Button Styles */
.btn {
    padding: 12px 24px;
    border: none;
    border-radius: 8px;
    font-size: 1rem;
    font-weight: 600;
    cursor: pointer;
    transition: all 0.3s ease;
    display: inline-flex;
    align-items: center;
    justify-content: center;
    gap: 8px;
    position: relative;
    overflow: hidden;
    z-index: 1;
}

.btn:before {
    content: '';
    position: absolute;
    top: 0;
    left: 0;
    width: 0;
    height: 100%;
    background: rgba(255, 255, 255, 0.2);
    transition: width 0.3s ease;
    z-index: -1;
}

.btn:hover:before {
    width: 100%;
}


.btn:disabled {
    background-color: #ccc;
    cursor: not-allowed;
    box-shadow: none;
    transform: none;
}

.btn-primary {
    background-color: var(--secondary-color);
    color: var(--light-text);
}
.btn-primary:hover:not(:disabled) {
    background-color: var(--primary-color);
    transform: translateY(-2px);
    box-shadow: 0 6px 20px var(--hover-glow);
}

.btn-secondary {
    background-color: #6c757d;
    color: var(--light-text);
}
.btn-secondary:hover:not(:disabled) {
    background-color: #5a6268;
    transform: translateY(-2px);
    box-shadow: 0 4px 15px rgba(0,0,0, 0.2);
}

.btn-outline {
    background-color: transparent;
    color: var(--secondary-color);
    border: 2px solid var(--secondary-color);
}
.btn-outline:hover {
    background-color: var(--secondary-color);
    color: var(--light-text);
    transform: translateY(-2px);
}

.login button {
    width: 100%;
}

/* Home Page */
.bigs {
    margin-bottom: 30px;
}

.bigs h2 {
    font-size: 2.5em;
    font-weight: 700;
    margin-bottom: 10px;
}

.subject-filters {
    display: flex;
    gap: 15px;
    margin-bottom: 30px;
    flex-wrap: wrap;
}

.subject-filter {
    padding: 10px 25px;
    border-radius: 30px;
    background: var(--card-bg);
    cursor: pointer;
    transition: all 0.3s ease;
    box-shadow: 0 2px 5px rgba(0,0,0,0.05);
    font-weight: 500;
    border: 2px solid transparent;
}

.subject-filter:hover {
    transform: translateY(-2px);
    border-color: var(--secondary-color);
}

.subject-filter.active {
    background: var(--secondary-color);
    color: var(--light-text);
    box-shadow: 0 4px 10px rgba(18, 93, 255, 0.3);
    border-color: var(--secondary-color);
}

.quiz-grid {
    display: grid;
    grid-template-columns: repeat(auto-fill, minmax(300px, 1fr));
    gap: 25px;
}

/* NEW QUIZ CARD DESIGN */
.quiz-card {
    background: linear-gradient(145deg, #ffffff, #e6e9ee);
    border-radius: 20px;
    overflow: hidden;
    box-shadow: 0 8px 30px rgba(0, 0, 0, 0.1);
    transition: all 0.4s cubic-bezier(0.175, 0.885, 0.32, 1.275);
    cursor: pointer;
    position: relative;
    display: flex;
    flex-direction: column;
    border: none;
}

.quiz-card:hover {
    transform: translateY(-10px) scale(1.02);
    box-shadow: 0 15px 40px rgba(0, 0, 0, 0.15);
}

.quiz-card::before {
    content: '';
    position: absolute;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    background: linear-gradient(to top, var(--secondary-color), transparent);
    opacity: 0;
    transition: opacity 0.3s ease-in-out;
    z-index: 1;
}

.quiz-card:hover::before {
    opacity: 0.1;
}

.quiz-image {
    width: 100%;
    height: 160px;
    background-size: cover;
    background-position: center;
    clip-path: polygon(0 0, 100% 0, 100% 85%, 0 100%);
    transition: clip-path 0.3s ease;
}

.quiz-card:hover .quiz-image {
    clip-path: polygon(0 0, 100% 0, 100% 100%, 0 100%);
}

.quiz-content {
    padding: 25px;
    flex-grow: 1;
    position: relative;
    z-index: 2;
}

.quiz-title {
    font-size: 1.35em;
    margin-bottom: 12px;
    font-weight: 700;
    color: var(--primary-color);
}

.quiz-description {
    color: #555;
    margin-bottom: 20px;
    font-size: 0.95em;
    line-height: 1.5;
}


/* Quiz Page - NEW DESIGN */
#quiz-page {
    max-width: 600px;
    margin: auto;
}

.quiz-header {
    margin-bottom: 1.5rem;
}

.quiz-header .flex-container {
    display: flex;
    justify-content: space-between;
    align-items: center;
    color: #4a5568;
    margin-bottom: 0.5rem;
}

.question-count, .timer-text {
    font-size: 0.875rem;
    font-weight: 600;
}

#timer-container {
    width: 100%;
    background-color: #e2e8f0;
    border-radius: 9999px;
    height: 10px;
}

#timer-bar {
    background-image: linear-gradient(to right, #4f46e5, #3b82f6);
    height: 10px;
    border-radius: 9999px;
    transition: width 1s linear;
}

#timer-bar.time-low-pulse {
    background-image: linear-gradient(to right, #ef4444, #b91c1c);
    animation: pulse 1.5s infinite;
}

@keyframes pulse {
    0% { opacity: 1; }
    50% { opacity: 0.6; }
    100% { opacity: 1; }
}

.question-card {
    background-color: transparent;
    border-radius: 1.5rem;
    box-shadow: none;
    padding: 0;
    text-align: center;
}

.question-text-wrapper {
    min-height: 100px;
    display: flex;
    align-items: center;
    justify-content: center;
    margin-bottom: 2rem;
}

.question-text {
    font-size: 1.25rem;
    line-height: 1.6;
    font-weight: 600;
    color: #1a202c;
}

.options-container {
    display: grid;
    grid-template-columns: 1fr;
    gap: 1rem;
}

.option {
    background-color: #e2e8f0;
    color: #334155;
    padding: 0.75rem 1.25rem;
    border-radius: 0.75rem;
    cursor: pointer;
    transition: background-color 0.3s ease, transform 0.1s ease;
    text-align: left;
    width: 100%;
    font-size: 1rem;
    border: 1px solid transparent;
}

.option:hover:not(.disabled) {
    background-color: #cbd5e1;
    transform: translateY(-2px);
}

/* FIX: Added style for selected option */
.option.selected {
    background: #dbe4ff;
    border-color: var(--secondary-color);
    color: var(--primary-color);
    font-weight: 600;
}

.option.correct {
    background-color: #d1fae5;
    color: #065f46;
    border-color: #34d399;
}

.option.incorrect {
    background-color: #fee2e2;
    color: #991b1b;
    border-color: #ef4444;
}

.option.disabled {
    cursor: not-allowed;
    opacity: 0.7;
}

.quiz-controls {
    display: flex;
    justify-content: space-between;
    margin-top: 30px;
}


/* Results Page */
.results-container {
    background: var(--card-bg);
    border-radius: 15px;
    padding: 40px;
    box-shadow: 0 4px 15px rgba(0,0,0,0.08);
}
.score-container {
    text-align: center;
    margin-bottom: 30px;
}

.score {
    font-size: 4em;
    font-weight: 700;
    color: var(--primary-color);
}

.score-message {
    font-size: 1.4em;
    margin: 10px 0 20px;
}

.answers-review {
    margin: 30px 0;
}

.answers-review h3 {
    font-size: 1.5em;
    margin-bottom: 20px;
    text-align: center;
    font-weight: 600;
}

.review-item {
    background: #f8f9fa;
    border-radius: 8px;
    padding: 20px;
    margin-bottom: 15px;
    border-left: 5px solid;
}

.review-item.correct { border-color: var(--success); }
.review-item.incorrect { border-color: var(--danger); }

.review-question {
    font-weight: 600;
    margin-bottom: 10px;
}
.review-answers p {
    margin-bottom: 5px;
    padding-left: 20px;
    position: relative;
}
.review-answers p::before {
    position: absolute;
    left: 0;
    font-family: "Font Awesome 5 Free";
    font-weight: 900;
}
.review-answers .user-answer.incorrect::before {
    content: '\f00d'; /* fa-times */
    color: var(--danger);
}
.review-answers .correct-answer::before {
    content: '\f00c'; /* fa-check */
    color: var(--success);
}

.share-options {
    display: flex;
    justify-content: center;
    gap: 15px;
    margin: 20px 0 30px;
    flex-wrap: wrap;
}

.share-btn {
    padding: 10px 15px;
    border-radius: 8px;
    background: var(--primary-color);
    color: var(--light-text);
    cursor: pointer;
    display: flex;
    align-items: center;
    gap: 8px;
    transition: all 0.3s ease;
}
.share-btn:hover {
    transform: scale(1.05) translateY(-2px);
    box-shadow: 0 4px 10px rgba(0,0,0,0.2);
}

.results-actions {
    display: flex;
    justify-content: center;
    gap: 15px;
    margin-top: 30px;
    flex-wrap: wrap;
}

/* Study Page */
.study-header {
    text-align: center;
    margin-bottom: 30px;
}

.video-grid {
    display: grid;
    grid-template-columns: repeat(auto-fill, minmax(300px, 1fr));
    gap: 25px;
}

.video-card {
    background: var(--card-bg);
    border-radius: 15px;
    overflow: hidden;
    box-shadow: 0 4px 15px rgba(0,0,0,0.08);
    transition: all 0.3s ease;
    cursor: pointer;
}

.video-card:hover {
    transform: translateY(-8px);
    box-shadow: 0 10px 25px rgba(0,0,0,0.12);
}

.video-thumbnail {
    position: relative;
    width: 100%;
    height: 180px;
    overflow: hidden;
}

.video-thumbnail img {
    width: 100%;
    height: 100%;
    object-fit: cover;
    transition: transform 0.3s ease;
}
.video-card:hover .video-thumbnail img {
    transform: scale(1.05);
}

.play-icon {
    position: absolute;
    top: 50%;
    left: 50%;
    transform: translate(-50%, -50%);
    font-size: 4em;
    color: rgba(255, 255, 255, 0.9);
    text-shadow: 0 2px 8px rgba(0,0,0,0.5);
    transition: transform 0.3s ease;
}
.video-card:hover .play-icon {
    transform: translate(-50%, -50%) scale(1.1);
}

.video-info { padding: 20px; }
.video-title {
    font-size: 1.1em;
    margin-bottom: 10px;
    font-weight: 600;
}

/* Video Modal - FIXED for mobile responsiveness */
.video-modal {
    position: fixed;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    background: rgba(0,0,0,0.8);
    backdrop-filter: blur(5px);
    display: flex;
    justify-content: center;
    align-items: center;
    z-index: 1000;
    opacity: 0;
    visibility: hidden;
    transition: all 0.3s ease;
}

.video-modal.active {
    opacity: 1;
    visibility: visible;
}

.video-modal-content {
    width: 95%;
    max-width: 900px;
    background: #000;
    border-radius: 15px;
    overflow: hidden;
    position: relative;
    box-shadow: 0 10px 30px rgba(0,0,0,0.5);
    aspect-ratio: 16 / 9;
}

.video-modal-content iframe {
    width: 100%;
    height: 100%;
    border: none;
    position: absolute;
    top: 0;
    left: 0;
}

.close-modal {
    position: absolute;
    top: 15px;
    right: 15px;
    background: rgba(0,0,0,0.5);
    color: var(--light-text);
    width: 35px;
    height: 35px;
    border-radius: 50%;
    display: flex;
    justify-content: center;
    align-items: center;
    cursor: pointer;
    z-index: 10;
    transition: background 0.3s ease;
}
.close-modal:hover {
    background: rgba(255, 0, 0, 0.7);
    transform: rotate(90deg);
}

/* Chat Page */
.chat-container {
    height: calc(100vh - 120px);
    background: var(--card-bg);
    border-radius: 15px;
    overflow: hidden;
    display: flex;
    flex-direction: column;
    box-shadow: 0 4px 15px rgba(0,0,0,0.08);
}

.chat-header {
    padding: 15px 20px;
    background: var(--primary-color);
    color: var(--light-text);
    display: flex;
    align-items: center;

    gap: 15px;
}

.chat-avatar {
    width: 45px;
    height: 45px;
    border-radius: 50%;
    text-align: center;
    align-content: center;
    background: linear-gradient(135deg, #4aee88, #2bd);
}

.chat-messages {
    flex: 1;
    padding: 20px;
    overflow-y: auto;
    display: flex;
    flex-direction: column;
    gap: 15px;
}

.message {
    max-width: 70%;
    padding: 12px 18px;
    border-radius: 18px;
    position: relative;
    line-height: 1.4;
    opacity: 0;
    transform: translateY(10px);
    animation: messageFadeIn 0.3s forwards;
}

@keyframes messageFadeIn {
    to {
        opacity: 1;
        transform: translateY(0);
    }
}

.message.incoming {
    align-self: flex-start;
    background: #f0f0f0;
    border-top-left-radius: 4px;
}

.message.outgoing {
    align-self: flex-end;
    background: var(--secondary-color);
    color: var(--light-text);
    border-top-right-radius: 4px;
}

.message-meta {
    display: block;
    font-size: 0.75em;
    margin-top: 5px;
    opacity: 0.8;
    text-align: right;
}
.message.incoming .message-meta {
    text-align: left;
}

.chat-input {
    display: flex;
    padding: 15px;
    border-top: 1px solid var(--border-color);
    gap: 10px;
}

.chat-input input {
    flex: 1;
    padding: 12px 18px;
    border-radius: 25px;
    border: 1px solid var(--border-color);
    font-size: 1rem;
    transition: border-color 0.3s ease;
}
.chat-input input:focus {
    outline: none;
    border-color: var(--secondary-color);
    box-shadow: 0 0 8px var(--hover-glow);
}

.send-btn {
    background: var(--secondary-color);
    color: var(--light-text);
    border: none;
    border-radius: 50%;
    width: 48px;
    height: 48px;
    display: flex;
    justify-content: center;
    align-items: center;
    cursor: pointer;
    font-size: 1.2rem;
    transition: all 0.3s ease;
}
.send-btn:hover {
    background: var(--primary-color);
    transform: scale(1.1);
}

/* Dashboard Page */
.profile-header {
    display: flex;
    align-items: center;
    gap: 30px;
    margin-bottom: 30px;
    padding: 30px;
    background: var(--card-bg);
    border-radius: 15px;
    box-shadow: 0 4px 15px rgba(0,0,0,0.08);
}

/* Add this to your existing CSS */
.profile-image {
    width: 120px;
    height: 120px;
    border-radius: 50%;
    border: 4px solid var(--secondary-color);
    background: #ddd;
    display: flex;
    justify-content: center;
    align-items: center;
    font-size: 14px;
    overflow: hidden;
}

.profile-image img {
    width: 100%;
    height: 100%;
    object-fit: cover;
}

/* Update the existing .profile-image-container if it exists */
.profile-image-container {
    width: 120px;
    height: 120px;
    border-radius: 50%;
    border: 4px solid var(--secondary-color);
    background: #ddd;
    display: flex;
    justify-content: center;
    align-items: center;
    font-size: 14px;
    overflow: hidden;
}

.profile-image-container img {
    width: 100%;
    height: 100%;
    object-fit: cover;
}

.profile-info { flex: 1; }
.profile-info h3 { font-size: 1.8rem; margin-bottom: 5px; }
.profile-info h4 { font-size: 1.1rem; color: #666; font-weight: 500;}

.profile-actions {
    display: flex;
    gap: 10px;
}

.stats-grid {
    display: grid;
    grid-template-columns: repeat(auto-fill, minmax(220px, 1fr));
    gap: 25px;
    margin-bottom: 30px;
}

.stat-card {
    background: var(--card-bg);
    border-radius: 15px;
    padding: 25px;
    box-shadow: 0 4px 15px rgba(0,0,0,0.08);
    text-align: center;
    transition: all 0.3s ease;
}

.stat-card:hover {
    transform: translateY(-5px);
    box-shadow: 0 8px 20px rgba(0,0,0,0.1);
}

.stat-value {
    font-size: 2.5em;
    font-weight: 700;
    color: var(--primary-color);
    margin-bottom: 5px;
}

.stat-label { color: #666; }

.progress-charts {
    display: grid;
    grid-template-columns: 1fr 1fr;
    gap: 25px;
    margin-bottom: 30px;

}

.chart-container {
    background: var(--card-bg);
    border-radius: 15px;
    padding: 25px;
    box-shadow: 0 4px 15px rgba(0,0,0,0.08);
}

.chart-title {
    font-size: 1.3em;
    margin-bottom: 20px;
    font-weight: 600;
}

.recent-activity {
    background: var(--card-bg);
    border-radius: 15px;
    padding: 25px;
    box-shadow: 0 4px 15px rgba(0,0,0,0.08);
}
.recent-activity h3 { font-size: 1.3em; margin-bottom: 15px; font-weight: 600; }

.activity-item {
    padding: 15px 0;
    border-bottom: 1px solid var(--border-color);
    display: flex;
    justify-content: space-between;
    align-items: center;
    gap: 15px;
}

.activity-item:last-child { border-bottom: none; }

.activity-info .title {
    font-weight: 500;
}
.activity-info .date {
    font-size: 0.85em;
    color: 777;
}
.activity-score {
    font-weight: 600;
    font-size: 1.1em;
    color: var(--primary-color);
}

/* Modal */
.modal {
    position: fixed;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    background: rgba(0,0,0,0.6);
    backdrop-filter: blur(8px);
    display: flex;
    justify-content: center;
    align-items: center;
    z-index: 50000;
    opacity: 0;
    visibility: hidden;
    transition: all 0.3s ease;
}

.modal.active {
    opacity: 1;
    visibility: visible;
}

.modal-content {
    background: var(--card-bg);
    border-radius: 15px;
    padding: 30px;
    width: 90%;
    max-width: 500px;
    box-shadow: 0 10px 30px rgba(0,0,0,0.25);
    transform: scale(0.95) translateY(10px);
    transition: transform 0.3s ease, opacity 0.3s ease;
    opacity: 0;
}
.modal.active .modal-content {
    transform: scale(1) translateY(0);
    opacity: 1;
}

.modal-header h3 {
    font-size: 1.5rem;
    margin-bottom: 15px;
}

.modal-body {
    margin-bottom: 25px;
    line-height: 1.6;
}

.modal-footer {
    display: flex;
    justify-content: flex-end;
    gap: 10px;
}

/* Responsive Styles */
@media (max-width: 1024px) {
    .progress-charts {
        grid-template-columns: 1fr;
    }
}

@media (max-width: 768px) {
    .side-nav {
        transform: translateX(-100%);
        box-shadow: 5px 0 15px rgba(0,0,0,0.2);
    }
    
    .side-nav.active {
        transform: translateX(0);
    }
    
    .main-content {
        margin-left: 0;
        padding: 20px;
    }
    
    .ham {
        display: block;
    }
    
    .quiz-grid, .video-grid {
        grid-template-columns: 1fr;
    }
    
    .profile-header {
        flex-direction: column;
        text-align: center;
    }
    
    .profile-actions {
        justify-content: center;
    }
    
    /* Improved video modal for mobile */
    .video-modal-content {
        width: 98%;
        height: auto;
        max-height: 80vh;
        aspect-ratio: unset;
    }
    
    .video-modal-content iframe {
        position: relative;
        height: 50vh;
        min-height: 250px;
    }
}

@media (max-width: 480px) {
    .login {
        width: 90%;
        padding: 25px;
    }
    
    .subject-filters {
        gap: 10px;
    }
    .subject-filter {
        padding: 8px 18px;
    }
    
    .quiz-controls, .results-actions {
        flex-direction: column;
        gap: 10px;
    }
    
    .share-options {
        gap: 10px;
    }
    .main-content {
        padding: 15px;
    }
    .bigs h2 {
        font-size: 2em;
    }
    .chat-container {
        height: calc(100vh - 90px);
    }
    
    /* Further mobile improvements for video modal */
    .video-modal-content {
        width: 95%;
        border-radius: 10px;
    }
    
    .video-modal-content iframe {
        height: 40vh;
        min-height: 200px;
    }
    
    .close-modal {
        top: 10px;
        right: 10px;
        width: 30px;
        height: 30px;
    }
    
    /* Loading screen text adjustments for mobile */
    .text-4xl {
        font-size: 1.875rem;
    }
    
    .md\:text-6xl {
        font-size: 2.25rem;
    }
    
    .text-2xl {
        font-size: 1.25rem;
    }
    
    .md\:text-4xl {
        font-size: 1.5rem;
    }
}

/* Add this to hide content until login */
.content-hidden {
    display: none !important;
}

/* ADD THESE NEW STYLES FOR THE CHALLENGE FEATURE */
#challenge-start-page {
    display: none; /* Hidden by default */
    position: fixed;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    background: rgba(0, 0, 0, 0.7);
    backdrop-filter: blur(10px);
    z-index: 20000;
    justify-content: center;
    align-items: center;
}
#challenge-start-page.active {
    display: flex; /* Shown when active */
}

.challenge-card {
    background: var(--card-bg);
    padding: 40px;
    border-radius: 20px;
    text-align: center;
    max-width: 400px;
    width: 90%;
    box-shadow: 0 10px 40px rgba(0,0,0,0.3);
    animation: fadeIn 0.5s ease-out;
}

.challenger-info {
    margin-bottom: 25px;
}

.challenger-pfp {
    width: 100px;
    height: 100px;
    border-radius: 50%;
    overflow: hidden;
    margin: 0 auto 15px;
    border: 4px solid var(--secondary-color);
}
.challenger-pfp img {
    width: 100%;
    height: 100%;
    object-fit: cover;
}

.challenger-info h2 {
    font-size: 1.8rem;
    color: var(--primary-color);
    margin: 0;
}
.challenger-info p {
    font-size: 1.1rem;
    color: #666;
}

.challenge-details h3 {
    font-size: 1.5rem;
    margin-bottom: 10px;
}
.challenge-details p {
    margin-bottom: 30px;
    font-size: 1rem;
}

#start-challenge-btn {
    width: 100%;
    font-size: 1.2rem;
}

#challenge-result-message {
    padding: 15px;
    border-radius: 10px;
    margin: 0 auto 20px;
    font-size: 1.2rem;
    font-weight: 600;
    display: none; /* Hidden by default */
}
#challenge-result-message.win {
    background-color: var(--success);
    color: var(--light-text);
}
#challenge-result-message.loss {
    background-color: var(--warning);
    color: var(--text-color);
}
/* END OF NEW STYLES */



   </style>
</head>

 <!-- <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 256 256" width="256" height="256">
  <style>
    .cap-fill { fill: #05359c; }
    .tassel-fill { fill: #125dff; }
  </style>
  <path class="cap-fill" d="M128 172.8l-112-56v44.8l112 56 112-56v-44.8l-112 56z"/>
  <path class="cap-fill" d="M240 72.8L128 16l-112 56.8 112 56 112-56.8zM32 172.8h192v16H32v-16z"/>
  <path class="tassel-fill" d="M208 88.8v56h16v-56h-16z"/>
</svg> -->
    <div id="app">
        <!-- Enhanced Loading Screen -->
        <div id="loading-screen">
            <canvas id="tunnel-canvas"></canvas>
            
            <!-- Text Overlay 1 -->
            <div id="text-1" class="text-container absolute">
                <h1 class="text-4xl md:text-6xl font-black tracking-wider uppercase">Exam Study Assistant</h1>
                <p class="text-lg md:text-xl font-light mt-2 text-gray-300">Powered by Lumora Educations</p>
            </div>
            
            <!-- Text Overlay 2 -->
            <div id="text-2" class="text-container absolute">
                <h2 class="men text-2xl md:text-4xl font-bold text-cyan-300 tracking-wide">Special Edition for DTI Learners</h2>
            </div>
        </div>

        <!-- Navigation -->
        <nav class="side-nav" id="side-nav">
            <ul>
                <li class="logo">
                    <div class="image-container" id="nav-profile-image">
                        <p>No image</p>
                    </div>
                </li>
                <div class="stat">
                    <p id="nav-username">Name</p>
                </div>
                <li>
                    <a href="#" data-page="home"><i class="fa-solid fa-pen-to-square"></i> Quiz</a>
                </li>
                <li>
                    <a href="#" data-page="study"><i class="fa-solid fa-book"></i> Study</a>
                </li>
                <li>
                    <a href="#" data-page="chat"><i class="fa-brands fa-rocketchat"></i> Chat</a>
                </li>
                <li>
                    <a href="#" data-page="dashboard"><i class="fa fa-users"></i> Dashboard</a>
                </li>
            </ul>
        </nav>

        <!-- Hamburger Menu -->
        <div class="ham">
            <div class="ham-m" id="ham-menu"><i class="fa-solid fa-bars"></i></div>
        </div>

        <!-- Main Content -->
        <div class="main-content" id="main-content">
          <!-- Login Page -->
<div id="login-page" class="page">
    <canvas id="kaleidoscope-bg"></canvas>
    <div class="login-container">
        <div class="login">
            <img src="/logo-white-1.png" alt="Lumora Educations">
            <form id="login-form">
                <div class="input-box">
                    <input type="text" id="username" placeholder="Enter Your Full Name" required>
                </div>
                <div class="input-box">
                    <select id="educationLevel" name="educationLevel" required>
                        <option value="">Select your course</option>
                        <option value="Multimedia">Multimedia</option>
                        <option value="Welding">Welding</option>
                        <option value="CAD/CAM">CAD/CAM</option>
                        <option value="Entrepreneurship">Entrepreneurship</option>
                    </select>
                </div>
                <div class="rembar">
                    <input type="checkbox" id="rememberMe">
                    <label for="rememberMe">Remember Me</label>
                </div>
                <button type="submit">GET STARTED</button>
            </form>
        </div>
    </div>
</div>

            <!-- Home Page -->
            <div id="home-page" class="page">
                <div class="bigs">
                    <h2>Subjects</h2>
                    <p>Hello <span id="welcome-username">Name</span>, Boost your focus with bite-sized study sessions, interactive quizzes, and progress tracking all designed to make exam prep less boring and more rewarding.</p>
                </div>
                
                <div class="subject-filters">
                    <div class="subject-filter active" data-subject="all">All</div>
                    <div class="subject-filter" data-subject="english">English</div>
                    <div class="subject-filter" data-subject="pr">Product Realisation</div>
                    <div class="subject-filter" data-subject="challenge">Challenge</div>
                    <div class="subject-filter" data-subject="entrepreneurship">Entrepreneurship</div>
                </div>
                
                <div class="quiz-grid">
                    <!-- Quiz cards will be dynamically generated -->
                </div>
            </div>

<!-- 1. Replace the existing HTML for your quiz page with this -->
<!-- This version removes the 'Next' and 'Previous' buttons -->

<div id="quiz-page" class="page">
    <div class="quiz-header">
        <div class="flex-container">
            <div class="question-count">Question <span id="current-question">1</span>/<span id="total-questions">10</span></div>
            <div class="timer-text">Time: <span id="time-left">35</span>s</div>
        </div>
        <div id="timer-container">
            <div id="timer-bar" style="width: 100%;"></div>
        </div>
    </div>
    
    <div class="question-card">
        <div class="question-text-wrapper">
            <div class="question-text" id="question-text">What is the capital of France?</div>
        </div>
        <div class="options-container" id="options-container">
            <!-- Options will be dynamically inserted here -->
        </div>
    </div>
    
    <!-- The quiz-controls div has been removed -->
</div>

            <!-- Results Page -->
            <div id="results-page" class="page">
                <div class="score-container">
                    <div class="score" id="final-score">8/10</div>
                    <div class="score-message" id="score-message">Great job!</div>
                </div>
                
                <div class="performance-stats">
                    <div class="stat-item">
                        <span class="stat-label">Average Speed:</span>
                        <span class="stat-value" id="average-speed">5.2s</span>
                    </div>
                    <div class="stat-item">
                        <span class="stat-label">Accuracy:</span>
                        <span class="stat-value" id="accuracy">80%</span>
                    </div>
                    <div class="stat-item">
                        <span class="stat-label">Performance Note:</span>
                        <span class="stat-note" id="performance-note">You did well!</span>
                    </div>
                </div>
                
                <div class="share-options">
                    <div class="share-btn" data-platform="whatsapp">
                        <i class="fab fa-whatsapp"></i> WhatsApp
                    </div>
                    <div class="share-btn" data-platform="telegram">
                        <i class="fab fa-telegram"></i> Telegram
                    </div>
                    <div class="share-btn" data-platform="facebook">
                        <i class="fab fa-facebook"></i> Facebook
                    </div>
                    <div class="share-btn" data-platform="twitter">
                        <i class="fab fa-twitter"></i> Twitter
                    </div>
                    <div class="share-btn" id="copy-link">
                        <i class="fas fa-link"></i> Copy Link
                    </div>
                </div>
                
                <div class="answers-review" id="answers-review">
                    <!-- Answers review will be dynamically generated -->
                </div>
                
                <div class="results-actions">
                    <button class="btn" id="retry-quiz">Retry Quiz</button>
                    <button class="btn btn-secondary" id="study-more">Study More</button>
                    <button class="btn" id="back-to-home">Back to Home</button>
                </div>
            </div>

            <!-- Study Page -->
            <div id="study-page" class="page">
                <div class="study-header">
                    <h3>Get Some Bonus Study Videos</h3>
                </div>
                
                <div class="video-grid">
                    <!-- Video cards will be dynamically generated -->
                </div>
            </div>

            <!-- Video Modal -->
            <div class="video-modal" id="video-modal">
                <div class="video-modal-content">
                    <div class="close-modal" id="close-modal">
                        <i class="fas fa-times"></i>
                    </div>
                    <div id="video-player"></div>
                </div>
            </div>

            <!-- Chat Page -->
            <div id="chat-page" class="page">
                <div class="chat-container">
                    <div class="chat-header">
                        <div class="chat-avatar">LA</div>
                        <div>
                            <div class="contact">Lumora AI</div>
                            <div class="status">online</div>
                        </div>
                    </div>
                    
                    <div class="chat-messages" id="chat-messages">
                        <div class="message incoming">
                            Hey! This is Lumora AI. How can I help you with your studies today?
                            <div class="message-meta">12:02</div>
                        </div>
                    </div>
                    
                    <div class="chat-input">
                        <input type="text" id="chat-input" placeholder="Type your message...">
                        <button class="send-btn" id="send-message">
                            <i class="fas fa-paper-plane"></i>
                        </button>
                    </div>
                </div>
            </div>

            <!-- Dashboard Page -->
            <div id="dashboard-page" class="page">
                <div class="profile-header">
                    <div class="profile-image" id="dashboard-profile-image">
                        <p>No image</p>
                    </div>
                    <div class="profile-info">
                        <h3 id="dashboard-username">Name</h3>
                        <h4 id="dashboard-course">Course</h4>
                    </div>
                    <div class="profile-actions">
                        <button class="btn" id="logout-btn">Logout</button>
                        <label for="profile-upload" class="btn btn-secondary">
                            <i class="fas fa-edit"></i> Edit Profile
                        </label>
                        <input type="file" id="profile-upload" accept="image/*" hidden>
                    </div>
                </div>
                
                <div class="stats-grid">
                    <div class="stat-card">
                        <div class="stat-value" id="quizzes-taken">0</div>
                        <div class="stat-label">Quizzes Taken</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-value" id="average-score">0%</div>
                        <div class="stat-label">Average Score</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-value" id="challenges-won">0</div>
                        <div class="stat-label">Challenges Won</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-value" id="total-questions-answered">0</div>
                        <div class="stat-label">Questions Answered</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-value" id="total-visits">0</div>
                        <div class="stat-label">Total Visits</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-value" id="today-visits">0</div>
                        <div class="stat-label">Today's Visits</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-value" id="challenges-shared">0</div>
                        <div class="stat-label">Challenges Shared</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-value" id="videos-watched">0</div>
                        <div class="stat-label">Videos Watched</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-value" id="videos-completed">0</div>
                        <div class="stat-label">Videos Completed</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-value" id="speed-category">Snail</div>
                        <div class="stat-label">Your Speed</div>
                    </div>
                </div>
                
                <div class="progress-charts">
                    <div class="chart-container">
                        <div class="chart-title">Subject Performance</div>
                        <div class="chart-wrapper">
                            <canvas id="subject-chart"></canvas>
                        </div>
                    </div>
                    <div class="chart-container">
                        <div class="chart-title">Progress Over Time</div>
                        <div class="chart-wrapper">
                            <canvas id="progress-chart"></canvas>
                        </div>
                    </div>
                </div>
                
                <div class="recent-activity">
                    <h3>Recent Activity</h3>
                    <div id="activity-list">
                        <!-- Activity items will be dynamically generated -->
                    </div>
                </div>
            </div>
        </div>

        <!-- Modal for data consent -->
        <div class="modal" id="consent-modal">
            <div class="modal-content">
                <div class="modal-header">
                    <h3>Data Storage Consent</h3>
                </div>
                <div class="modal-body">
                    <p>You've chosen to be remembered. This means your progress, scores, and profile information will be stored locally on this device. Your data will not be sent to any server.</p>
                    <p>Do you consent to storing your data locally?</p>
                </div>
                <div class="modal-footer">
                    <button class="btn btn-secondary" id="consent-deny">No, don't remember me</button>
                    <button class="btn" id="consent-agree">Yes, I agree</button>
                </div>
            </div>
        </div>

        <!-- Modal for no data storage warning -->
        <div class="modal" id="no-storage-modal">
            <div class="modal-content">
                <div class="modal-header">
                    <h3>Data Not Saved</h3>
                </div>
                <div class="modal-body">
                    <p>You've chosen not to be remembered. Your progress and scores will not be saved after you close the browser.</p>
                    <p>You can change this setting anytime from your profile.</p>
                </div>
                <div class="modal-footer">
                    <button class="btn" id="no-storage-ok">OK</button>
                </div>
            </div>
        </div>

        <!-- Logout Confirmation Modal -->
        <div class="modal" id="logout-modal">
            <div class="modal-content">
                <div class="modal-header">
                    <h3>Logout Confirmation</h3>
                </div>
                <div class="modal-body">
                    <p>How would you like to logout?</p>
                </div>
                <div class="modal-footer">
                    <button class="btn btn-secondary" id="logout-clear">Logout & Clear Data</button>
                    <button class="btn" id="logout-keep">Logout & Keep Data</button>
                    <button class="btn btn-outline" id="logout-cancel">Cancel</button>
                </div>
            </div>
        </div>
    </div>

            <!-- ADD THIS NEW PAGE FOR THE CHALLENGE PROMPT -->
        <div id="challenge-start-page" class="page">
            <div class="challenge-card">
                <div class="challenger-info">
                    <div class="challenger-pfp">
                        <img id="challenger-image" src="" alt="Challenger">
                    </div>
                    <h2 id="challenger-name">User</h2>
                    <p>has challenged you!</p>
                </div>
                <div class="challenge-details">
                    <h3>Score to Beat: <span id="challenge-score">0/0</span></h3>
                    <p>Their Average Speed: <span id="challenge-speed">0s</span></p>
                </div>
                <button id="start-challenge-btn" class="btn btn-primary">Start Challenge</button>
            </div>
        </div>

        <!-- ADD THIS DIV FOR CHALLENGE RESULTS -->
<div id="challenge-result-message"></div>
<!-- END OF ADDED DIV -->
        <!-- END OF NEW PAGE -->
     <!-- <script src="ai-assistant.js"></script> -->
 

    <script>

// App State Management
const appState = {
    currentPage: 'login',
    currentUser: null,
    currentQuiz: null,
     // ADDED THESE NEW STATE PROPERTIES
    challengeInfo: null,
    isChallengeMode: false,
    questionOrder: [], 
    // END OF ADDITIONS
    currentQuestion: 0,
    userAnswers: [],
    questionStartTime: [],
    timer: null,
    timeLeft: 60,
    quizzes: {
        'english': [
            {
               id: 'cv-cover',
    title: 'CV/Cover Letter',
    description: 'Learn how to create professional CVs and cover letters.',
    subject: 'english',
    questions: [
        {
            question: 'What is the ideal length for a cover letter?',
            options: ['Two A4 pages', 'One A4 page', 'Half an A4 page', 'As long as needed to include all information'],
            correctAnswer: 1
        },
        {
            question: 'According to the document, what should you do before you start writing a cover letter?',
            options: ['Write down a list of questions to ask the contact person.', 'Send the letter immediately to show initiative.', 'Use a generic template to save time.', 'Call the company and ask for a salary estimate.'],
            correctAnswer: 0
        },
        {
            question: 'The main "selling" paragraphs of a cover letter should focus on:',
            options: ['Summarizing the resume.', 'Listing all past job duties.', 'Explaining why your skills and experience match the job.', 'Describing your hobbies and interests.'],
            correctAnswer: 2
        },
        {
            question: 'What should the opening paragraph of a cover letter indicate?',
            options: ['Your full salary history.', 'Your desire to apply for the advertised vacancy.', 'A detailed summary of your education.', 'A list of your personal references.'],
            correctAnswer: 1
        },
        {
            question: 'What is the primary purpose of a cover letter?',
            options: ['To provide a detailed list of all your work experiences.', 'To serve as a legal document of your application.', 'To introduce yourself and persuade the employer you are a good fit for the job.', 'To provide a list of your social media profiles.'],
            correctAnswer: 2
        },
        {
            question: 'The font size recommended for a cover letter is:',
            options: ['8-point', '10-12 point', '14-16 point', '18-20 point'],
            correctAnswer: 1
        },
        {
            question: 'A cover letter should be personally addressed if possible. What should you do if the company name is not disclosed?',
            options: ['Do not send a cover letter.', 'Address it to "Dear Sir/Madam".', 'Find out the name and contact details of a person and call them.', 'Send the application to a general email address.'],
            correctAnswer: 2
        },
        {
            question: 'What information should NOT be included in a CV, as per the document?',
            options: ['Professional skills', 'Work experience', 'Education history', 'Irrelevant personal details like religious beliefs'],
            correctAnswer: 3
        },
        {
            question: 'What is the most important purpose of a CV?',
            options: ['To prove you are a hard worker.', 'To serve as a record of your life.', 'To market your skills and experience to potential employers.', 'To list all your previous job titles.'],
            correctAnswer: 2
        },
        {
            question: 'Which of the following is an example of a "duty" rather than an "achievement"?',
            options: ['Grew sales by 15% in Q3.', 'Managed a team of 10 employees.', 'Successfully led a project to completion.', 'Answered customer service phone calls.'],
            correctAnswer: 3
        },
        {
            question: 'According to the document, what is the best way to describe your work experience?',
            options: ['By providing a detailed list of all your duties.', 'By copying and pasting the job description.', 'By using powerful action words to highlight achievements.', 'By listing only your job titles and dates.'],
            correctAnswer: 2
        },
        {
            question: 'What is a "hard skill"?',
            options: ['A personal characteristic like communication.', 'A technical skill like proficiency in a software program.', 'A non-quantifiable skill.', 'A skill you learned in childhood.'],
            correctAnswer: 1
        },
        {
            question: 'What is the most common reason for a CV to be rejected?',
            options: ['No work experience.', 'Poor spelling and grammar.', 'Lack of a photo.', 'Including too many skills.'],
            correctAnswer: 1
        },
        {
            question: 'How should you handle an unexplained gap in your work history on a CV?',
            options: ['Do not mention it and hope they’re not notice.', 'Lie about what you were doing during that time.', 'Provide a brief, honest explanation for the gap.', 'Remove the dates and only list your job titles.'],
            correctAnswer: 2
        },
        {
            question: 'What is the recommended approach to listing skills on a CV?',
            options: ['List only the skills you think are most important.', 'List all your skills in one long paragraph.', 'List technical skills first, followed by personal skills.', 'Group skills by category, such as computer skills and personal skills.'],
            correctAnswer: 3
        },
        {
            question: 'According to the document, which of the following is a key component of a CV?',
            options: ['Your favorite color.', 'Your height and weight.', 'A summary or objective statement.', 'Your entire family history.'],
            correctAnswer: 2
        },
        {
            question: 'What is the recommended action regarding a CV\'s length?',
            options: ['It must be two pages for everyone.', 'It should not exceed three pages.', 'It should be one page for new graduates and a maximum of two pages for experienced people.', 'The length is not important as long as it contains all information.'],
            correctAnswer: 2
        },
        {
            question: 'How many different fonts should be used on a CV?',
            options: ['Only one or two.', 'As many as needed to make it look unique.', 'At least three to add visual interest.', 'No more than five.'],
            correctAnswer: 0
        },
        {
            question: 'Which of the following is a characteristic of a "good" CV?',
            options: ['A plain text document.', 'A CV filled with multiple fonts and colors.', 'A well-formatted, easy-to-read document.', 'A CV that is at least 3 pages long.'],
            correctAnswer: 2
        },
        {
            question: 'Why should you avoid using an unprofessional email address like "cutiepie@email.com"?',
            options: ['It may be flagged as spam.', 'It lacks the appropriate formatting for a CV.', 'It reflects badly on your professionalism.', 'It is not a valid email address.'],
            correctAnswer: 2
        },
        {
            question: 'What is a "chronological CV"?',
            options: ['A CV that lists work experience in a random order.', 'A CV that lists work experience in reverse chronological order.', 'A CV that groups jobs by type of work.', 'A CV that has no dates.'],
            correctAnswer: 1
        },
        {
            question: 'Why is it a mistake to copy and paste job responsibilities into your CV?',
            options: ['It makes you seem unoriginal.', 'It is considered plagiarism.', 'It doesn\'t demonstrate your achievements and impact.', 'It makes the CV too long.'],
            correctAnswer: 2
        },
        {
            question: 'What should the "Education" section of your CV include?',
            options: ['Only your highest degree.', 'The last five schools you attended.', 'The name of the institution, qualification, and date of completion.', 'A list of every course you have ever taken.'],
            correctAnswer: 2
        },
        {
            question: 'When a recruiter asks for your salary history, you should:',
            options: ['Provide it immediately in the CV.', 'Never provide it.', 'Avoid mentioning it in your CV and discuss it in an interview.', 'Only provide it if the job advertisement specifically asks for it.'],
            correctAnswer: 2
        },
        {
            question: 'Which of the following should you use when describing your hobbies and interests?',
            options: ['A very long list of every hobby you have.', 'Hobbies that demonstrate skills relevant to the job, such as teamwork or leadership.', 'Hobbies that are completely unrelated to the job.', 'Only professional hobbies.'],
            correctAnswer: 1
        },
        {
            question: 'What is a "functional" or "skills-based" CV?',
            options: ['A CV that lists jobs in chronological order.', 'A CV that highlights skills and abilities over work history.', 'A CV used by people with no work experience.', 'A CV that only focuses on education.'],
            correctAnswer: 1
        },
        {
            question: 'What is the role of the "contact information" section of a CV?',
            options: ['To provide a photograph of yourself.', 'To list your name, phone number, and professional email.', 'To provide your full address and date of birth.', 'To list your social media accounts.'],
            correctAnswer: 1
        },
        {
            question: 'How should you handle the use of "I" in a cover letter?',
            options: ['It should be used as much as possible.', 'Avoid using it altogether.', 'Use it to start every sentence.', 'Limit the use of "I" to avoid sounding self-centered.'],
            correctAnswer: 3
        },
        {
            question: 'What is a key difference between a CV and a Resume?',
            options: ['A CV is typically longer and more detailed than a resume.', 'A CV is used in the USA, and a resume is used in Europe.', 'A resume is used for academic positions, and a CV is used for business.', 'A resume must be one page, and a CV has no length limit.'],
            correctAnswer: 0
        },
        {
            question: 'When should you include a photo on your CV?',
            options: ['Always.', 'Never.', 'Only if required by the job advertisement or industry standards.', 'Only if you are a model.'],
            correctAnswer: 2
        },
        {
            question: 'Which of the following is a mistake that can get a CV rejected?',
            options: ['Using black font on a white background.', 'Having a clean, simple layout.', 'Using jargon that the recruiter may not understand.', 'Using bullet points to list achievements.'],
            correctAnswer: 2
        },
        {
            question: 'What is a reason to avoid using personal information like marital status on a CV?',
            options: ['It is illegal to include it.', 'It is irrelevant to the job and can lead to discrimination.', 'It is too common.', 'It takes up too much space.'],
            correctAnswer: 1
        },
        {
            question: 'If you have a long work history, how can you reduce your CV to two pages?',
            options: ['Use a smaller font size.', 'Focus on relevant work experience from the last 10-15 years.', 'Exclude your skills section.', 'Delete all of your education history.'],
            correctAnswer: 1
        },
        {
            question: 'What is the purpose of the "Objective" or "Summary" section of a CV?',
            options: ['To list your career goals in the next 10 years.', 'To provide a snapshot of your skills and experience.', 'To state the salary you are looking for.', 'To give a summary of your personal life.'],
            correctAnswer: 1
        },
        {
            question: 'What is a "soft skill"?',
            options: ['A skill that is easy to learn.', 'A technical skill like data analysis.', 'An interpersonal skill like communication or teamwork.', 'A skill you only use at home.'],
            correctAnswer: 2
        },
        {
            question: 'What is a major difference between a "duty" and an "achievement"?',
            options: ['A duty is a task, while an achievement is a quantifiable result.', 'A duty is a soft skill, while an achievement is a hard skill.', 'A duty is an unpaid task, while an achievement is a paid task.', 'There is no difference.'],
            correctAnswer: 0
        },
        {
            question: 'According to the document, why should you use a clean, simple layout for your CV?',
            options: ['To make it easy for recruiters to scan and read.', 'To make it look boring.', 'To make it look like everyone else\'s.', 'To save money on ink.'],
            correctAnswer: 0
        },
        {
            question: 'When is it appropriate to include a photograph on your CV?',
            options: ['Only if the job is for a modeling or acting position.', 'Never, it is unprofessional.', 'Always, to make the CV more personal.', 'Only for jobs in Europe.'],
            correctAnswer: 0
        },
        {
            question: 'Why should you avoid having spelling and grammatical errors on your CV?',
            options: ['It shows that you are not a native speaker.', 'It is a sign of laziness and a lack of attention to detail.', 'It will not be read by a recruiter.', 'It is against company policy.'],
            correctAnswer: 1
        },
        {
            question: 'Which of the following is a sign of a "poorly formatted" CV?',
            options: ['Using a single font like Times New Roman.', 'Using bold and italics to highlight important information.', 'Using different font sizes for headings and text.', 'Using a one-inch margin all around.'],
            correctAnswer: 2
        },
        {
            question: 'What should be the order of your educational background on a CV?',
            options: ['Oldest to newest.', 'Newest to oldest.', 'Alphabetical order by institution name.', 'Random order.'],
            correctAnswer: 1
        },
        {
            question: 'When should you provide references on a CV?',
            options: ['Always include them in the CV.', 'Never include them.', 'Only when asked for during the interview stage.', 'Only if you have more than three.'],
            correctAnswer: 2
        },
        {
            question: 'What is the purpose of a "covering email" or "covering letter"?',
            options: ['To provide a brief overview of your application.', 'To send your references.', 'To demand a specific salary.', 'To prove you can send an email.'],
            correctAnswer: 0
        },
        {
            question: 'Which of the following is an example of a "powerful action word"?',
            options: ['Was', 'Helped', 'Managed', 'Did'],
            correctAnswer: 2
        },
        {
            question: 'How should you describe your skills on a CV?',
            options: ['By listing every skill you have ever used.', 'By grouping them and using bullet points.', 'By writing them in a long paragraph.', 'By only listing your hard skills.'],
            correctAnswer: 1
        },
        {
            question: 'What is a "functional CV"?',
            options: ['A CV that is organized by work history.', 'A CV that highlights skills and abilities over chronological work history.', 'A CV that is used only for IT jobs.', 'A CV that has no dates on it.'],
            correctAnswer: 1
        },
        {
            question: 'According to the document, what is the purpose of "hobbies and interests" on a CV?',
            options: ['To show you are a well-rounded person.', 'To demonstrate skills like teamwork, communication, and leadership.', 'To fill up space on the CV.', 'To list all the things you do in your free time.'],
            correctAnswer: 1
        },
        {
            question: 'Why is it a mistake to have an unprofessional voicemail message?',
            options: ['It does not have a professional ringtone.', 'It is difficult to understand.', 'It can make you seem unprofessional to a potential employer.', 'It takes too long to get to.'],
            correctAnswer: 2
        },
        {
            question: 'When should you use a "professional summary" on a CV?',
            options: ['When you are a recent graduate.', 'When you have more than 10 years of experience.', 'When you want to give an overview of your career.', 'Never, it is not needed.'],
            correctAnswer: 2
        },
        {
            question: 'What is the primary difference between a cover letter and a CV?',
            options: ['A cover letter is for introduction, while a CV is a detailed record of your qualifications.', 'A cover letter is for new graduates, and a CV is for experienced professionals.', 'A cover letter is always longer than a CV.', 'A cover letter is sent to a recruiter, while a CV is sent to a hiring manager.'],
            correctAnswer: 0
        },
        {
            question: 'Why is it important to use a professional email address for job applications?',
            options: ['It is required by law.', 'It is easier for recruiters to remember.', 'It gives a positive and professional first impression.', 'It is a security requirement.'],
            correctAnswer: 2
        },
        {
            question: 'Which of the following can lead to a CV being rejected?',
            options: ['Using a photo that is a selfie.', 'Using a professional, recent photo.', 'Using a photo in which you are professionally dressed.', 'None of the above.'],
            correctAnswer: 0
        },
        {
            question: 'What is the main reason to avoid including your date of birth on a CV?',
            options: ['It can lead to age discrimination.', 'It is too personal.', 'It is not a required field.', 'It takes up valuable space.'],
            correctAnswer: 0
        },
        {
            question: 'When should you mention your hobbies and interests on a CV?',
            options: ['Only if they are directly related to the job.', 'Only if you have more than two.', 'If they help demonstrate skills relevant to the job.', 'Never, they are unprofessional.'],
            correctAnswer: 2
        },
        {
            question: 'What is the purpose of a "key skills" section on a CV?',
            options: ['To provide a quick summary of your most relevant abilities.', 'To list every skill you have.', 'To list only your hard skills.', 'To list your soft skills.'],
            correctAnswer: 0
        },
        {
            question: 'Why is it a bad idea to use too many colors and borders on a CV?',
            options: ['It makes the CV look messy and unprofessional.', 'It is more expensive to print.', 'It is a form of plagiarism.', 'It is difficult to read.'],
            correctAnswer: 0
        },
        {
            question: 'How should you describe your responsibilities in a work experience section?',
            options: ['In a detailed paragraph.', 'Using a list of every task you performed.', 'Using powerful action words and bullet points.', 'By stating your job title and dates only.'],
            correctAnswer: 2
        },
        {
            question: 'When a recruiter has to make a hiring decision, how long do they typically spend on a CV?',
            options: ['More than five minutes.', 'A couple of minutes.', 'Less than one minute.', 'They do not read the CVs at all.'],
            correctAnswer: 2
        },
        {
            question: 'What is an "executive summary" in a CV?',
            options: ['A summary of your academic achievements.', 'A brief overview of your most significant career accomplishments.', 'A summary of your personal life.', 'A summary of your hobbies.'],
            correctAnswer: 1
        },
        {
            question: 'What is a common mistake related to the layout of a CV?',
            options: ['Using a single-column layout.', 'Using a clean, crisp font.', 'Having uneven spacing and margins.', 'Using black text on a white background.'],
            correctAnswer: 2
        },
        {
            question: 'What is the significance of the phrase "You need to write a new cover letter for every position"?',
            options: ['It is a waste of time.', 'It means that one generic cover letter is not effective.', 'It is a legal requirement.', 'It means you can copy and paste the same letter.'],
            correctAnswer: 1
        },
        {
            question: 'What should be the tone of your cover letter?',
            options: ['Informal and conversational.', 'Formal and professional.', 'Aggressive and demanding.', 'Friendly and casual.'],
            correctAnswer: 1
        },
        {
            question: 'What is the most effective way to address a cover letter?',
            options: ['To "The Hiring Manager".', 'To a specific, named contact person.', 'To "The HR Department".', 'To "Whom it May Concern".'],
            correctAnswer: 1
        },
        {
            question: 'Why should a candidate avoid including salary history on their CV?',
            options: ['It is irrelevant to the job.', 'It is too personal.', 'It can limit negotiation opportunities.', 'It is not a requirement.'],
            correctAnswer: 2
        },
        {
            question: 'What should you do if your CV has more than two pages?',
            options: ['Keep it as is.', 'Reduce it by focusing on the most relevant information.', 'Add more details.', 'Change the font size to fit it all on two pages.'],
            correctAnswer: 1
        },
        {
            question: 'The phrase "Curriculum Vitae" means what in Latin?',
            options: ['Circle of life.', 'Course of life.', 'Career path.', 'Book of life.'],
            correctAnswer: 1
        },
        {
            question: 'What is the benefit of a "summary" section on a CV for an experienced professional?',
            options: ['It gives a brief overview of their career without needing to read the entire CV.', 'It makes the CV shorter.', 'It is required by all companies.', 'It is not useful.'],
            correctAnswer: 0
        },
        {
            question: 'What is a common mistake when listing education history?',
            options: ['Not including the dates of attendance.', 'Not listing all qualifications.', 'Listing them in reverse chronological order.', 'Listing them in chronological order.'],
            correctAnswer: 0
        },
        {
            question: 'Which of the following is a key element of a successful cover letter?',
            options: ['A summary of your resume.', 'A personal and compelling narrative about why you are a good fit.', 'A list of your references.', 'A list of all your past jobs.'],
            correctAnswer: 1
        },
        {
            question: 'The most important part of a CV is:',
            options: ['The font and layout.', 'The contact information.', 'The work experience section.', 'The hobbies section.'],
            correctAnswer: 2
        },
        {
            question: 'What is the key to making your CV stand out?',
            options: ['Using colorful and creative fonts.', 'Highlighting your unique skills and achievements.', 'Having a very long CV.', 'Including a photo of yourself.'],
            correctAnswer: 1
        },
        {
            question: 'Why is it important to use consistent formatting and design in your CV?',
            options: ['To make it look like everyone else\'s.', 'To demonstrate attention to detail and professionalism.', 'To save time in creating the document.', 'To make it look modern.'],
            correctAnswer: 1
        },
        {
            question: 'What is a major difference between a "CV" and a "Resume"?',
            options: ['A CV is typically one page, a resume is longer.', 'A CV is used in the USA, a resume is used in Europe.', 'A resume is typically more concise than a CV.', 'A resume is only for entry-level positions.'],
            correctAnswer: 2
        },
        {
            question: 'Why should you avoid using jargon on your CV?',
            options: ['It can make you sound unprofessional.', 'The recruiter may not understand it.', 'It is against company policy.', 'It takes up too much space.'],
            correctAnswer: 1
        },
        {
            question: 'What is the best way to handle your personal information on a CV?',
            options: ['Include your full address, date of birth, and marital status.', 'Include a professional email and phone number.', 'Do not include any personal information.', 'Include links to all your social media profiles.'],
            correctAnswer: 1
        },
        {
            question: 'What is the purpose of an "objective" or "summary" on a CV?',
            options: ['To list all your personal interests.', 'To briefly introduce yourself and your career goals.', 'To list all your past jobs.', 'To list all the skills you have.'],
            correctAnswer: 1
        },
        {
            question: 'What should be the focus of your "Work Experience" section?',
            options: ['A list of all your duties at each job.', 'A list of all the software you used.', 'A list of your key accomplishments and achievements.', 'A list of your job titles and dates only.'],
            correctAnswer: 2
        },
        {
            question: 'What should you do if your CV is rejected?',
            options: ['Give up.', 'Send an angry email to the recruiter.', 'Review your CV for any of the common mistakes listed in the document.', 'Apply for the same job again.'],
            correctAnswer: 2
        },
        {
            question: 'What is the primary role of a cover letter?',
            options: ['To supplement your CV and provide a personal introduction.', 'To replace your CV.', 'To serve as a reference letter.', 'To provide a list of your hobbies.'],
            correctAnswer: 0
        },
        {
            question: 'What is a mistake related to the "contact" section of a CV?',
            options: ['Including a professional phone number.', 'Including a professional email address.', 'Using a vague email address like "mail@gmail.com".', 'Not including your phone number.'],
            correctAnswer: 2
        },
        {
            question: 'What does it mean to have a "well-structured" CV?',
            options: ['It is a single paragraph.', 'It has clear sections with headings and bullet points.', 'It is only one page long.', 'It is printed on high-quality paper.'],
            correctAnswer: 1
        },
        {
            question: 'What is the purpose of the "skills" section in a CV?',
            options: ['To show what you are good at and how it can benefit the company.', 'To list every skill you have ever had.', 'To list only your technical skills.', 'To list only your soft skills.'],
            correctAnswer: 0
        },
        {
            question: 'Which of these is a mistake to avoid in a CV?',
            options: ['Sending it in a PDF format.', 'Including a photo of yourself.', 'Using a clean and simple layout.', 'Using bullet points to list achievements.'],
            correctAnswer: 1
        },
        {
            question: 'Why should you use a professional font like Times New Roman or Arial for your CV?',
            options: ['They are easy for recruiters to read and scan.', 'They are the only fonts that are allowed.', 'They are more expensive.', 'They are more creative.'],
            correctAnswer: 0
        },
        {
            question: 'What should you do if your CV is "just a list of duties"?',
            options: ['Add more duties.', 'Re-write it to focus on achievements and results.', 'Make it longer.', 'Make it shorter.'],
            correctAnswer: 1
        },
        {
            question: 'Why is it important to have a clean CV layout?',
            options: ['To make it look more creative.', 'To make it easy for a recruiter to quickly scan for information.', 'To make it longer.', 'To save space on the document.'],
            correctAnswer: 1
        },
        {
            question: 'Which section of a CV should use powerful action words?',
            options: ['Education', 'Contact Information', 'Work Experience', 'Hobbies and Interests'],
            correctAnswer: 2
        },
        {
            question: 'What is the main difference between a CV and a resume?',
            options: ['A CV is typically shorter than a resume.', 'A CV is a more comprehensive document used for academic or international jobs.', 'A resume is always used for senior positions.', 'There is no difference.'],
            correctAnswer: 1
        },
        {
            question: 'Why should you avoid using an unprofessional email address?',
            options: ['It shows a lack of attention to detail and professionalism.', 'It is difficult to type.', 'It is a waste of space.', 'It is not a valid email address.'],
            correctAnswer: 0
        },
        {
            question: 'Which of the following is a "hard skill"?',
            options: ['Communication', 'Teamwork', 'Proficiency in Microsoft Excel', 'Patience'],
            correctAnswer: 2
        },
        {
            question: 'What should you do if you have a significant gap in your work history?',
            options: ['Lie about it.', 'Provide a brief, honest explanation.', 'Leave the dates off your CV.', 'Do not include any work experience.'],
            correctAnswer: 1
        },
        {
            question: 'What is the purpose of a "professional summary" in a CV?',
            options: ['To give a personal introduction and a brief overview of your career.', 'To list every job you have ever had.', 'To list all your personal interests.', 'To state your salary expectations.'],
            correctAnswer: 0
        },
        {
            question: 'The cover letter\'s "selling" paragraphs should be used to:',
            options: ['List your personal details.', 'Explain how your skills and experience align with the job requirements.', 'Summarize your educational history.', 'Discuss your hobbies.'],
            correctAnswer: 1
        },
        {
            question: 'What is the purpose of the "contact information" section of a CV?',
            options: ['To provide a photograph of yourself.', 'To list your name, phone number, and a professional email address.', 'To provide your full home address and date of birth.', 'To list all your social media accounts.'],
            correctAnswer: 1
        },
        {
            question: 'What is a common reason for a CV to be rejected?',
            options: ['A clean, easy-to-read font.', 'Inconsistent formatting, such as different font sizes.', 'Using bullet points.', 'Having a professional summary.'],
            correctAnswer: 1
        },
        {
            question: 'What is the key to writing a great CV?',
            options: ['Making it as long as possible.', 'Tailoring it to each job and highlighting achievements.', 'Including all your personal details.', 'Using a generic template.'],
            correctAnswer: 1
        },
        {
            question: 'What is a major difference between an "achievement" and a "duty"?',
            options: ['A duty is a task, an achievement is a result.', 'A duty is a result, an achievement is a task.', 'A duty is an unpaid task, an achievement is a paid task.', 'There is no difference.'],
            correctAnswer: 0
        },
        {
            question: 'Why should you avoid including an image on your CV?',
            options: ['It can lead to unconscious bias.', 'It takes up too much space.', 'It is considered unprofessional.', 'All of the above.'],
            correctAnswer: 0
        },
        {
            question: 'When should a job seeker mention their hobbies on a CV?',
            options: ['Always.', 'Never.', 'Only if they are relevant to the job.', 'Only if they have a long list of hobbies.'],
            correctAnswer: 2
        },
        {
            question: 'What is the purpose of a "key skills" section on a CV?',
            options: ['To list every skill you have ever had.', 'To provide a quick summary of your most relevant abilities for the job.', 'To list only your hard skills.', 'To list only your soft skills.'],
            correctAnswer: 1
        },
        {
            question: 'What is the most effective way to start a cover letter?',
            options: ['To "Whom it May Concern"', 'With "Dear Sir/Madam"', 'By addressing it to a specific, named person.', 'With "To the Hiring Manager"'],
            correctAnswer: 2
        },
        {
            question: 'Why is it a bad idea to use too many colors and borders on a CV?',
            options: ['It makes the CV look unprofessional and difficult to read.', 'It is more expensive to print.', 'It is not legally compliant.', 'It is a form of plagiarism.'],
            correctAnswer: 0
        },
        {
            question: 'What should the focus of your "Work Experience" section be?',
            options: ['A list of all your duties.', 'A list of your key accomplishments and achievements.', 'A list of every project you worked on.', 'A list of all the software you used.'],
            correctAnswer: 1
        },
        {
            question: 'What is a common mistake related to the "contact" section of a CV?',
            options: ['Including a professional email address.', 'Using a professional font.', 'Using an unprofessional email address like "gamerking@email.com".', 'Including a professional phone number.'],
            correctAnswer: 2
        },
        {
            question: 'What is a "well-structured" CV?',
            options: ['A single paragraph with all information.', 'A document with clear sections, headings, and bullet points.', 'A document that is only one page long.', 'A document with no formatting.'],
            correctAnswer: 1
        },
        {
            question: 'What is the purpose of the "skills" section in a CV?',
            options: ['To list every skill you have ever had.', 'To show the employer what you are good at and how it can benefit them.', 'To list only your soft skills.', 'To list only your technical skills.'],
            correctAnswer: 1
        },
        {
            question: 'Why should you use a professional font like Times New Roman or Arial?',
            options: ['They are easy for recruiters to read.', 'They are the only fonts that are allowed.', 'They are more creative.', 'They are more expensive.'],
            correctAnswer: 0
        },
        {
            question: 'What should you do if your CV is "just a list of duties"?',
            options: ['Add more duties to make it longer.', 'Re-write it to focus on achievements and results.', 'Change the font to make it more visually appealing.', 'Delete the work experience section.'],
            correctAnswer: 1
        },
        {
            question: 'What is the purpose of a "cover letter"?',
            options: ['To summarize your resume.', 'To introduce yourself and persuade the employer that you are a good fit for the job.', 'To provide a list of your references.', 'To demand a specific salary.'],
            correctAnswer: 1
        },
        {
            question: 'What is the ideal length for a CV?',
            options: ['One A4 page for new graduates, two for experienced professionals.', 'Always one page.', 'Always two pages.', 'As long as needed to include everything.'],
            correctAnswer: 0
        },
        {
            question: 'What is a common mistake on a cover letter?',
            options: ['Addressing it personally.', 'Using a professional font.', 'Not indicating which position you are applying for.', 'Limiting it to one page.'],
            correctAnswer: 2
        },
        {
            question: 'Why should you call the company\'s contact person before sending your application?',
            options: ['To get a better understanding of the vacancy and show initiative.', 'To demand an interview.', 'To ask for a salary estimate.', 'To inform them that you are applying.'],
            correctAnswer: 0
        },
        {
            question: 'What is a "soft skill"?',
            options: ['A skill that is easy to learn.', 'A technical skill like coding.', 'An interpersonal skill like communication or leadership.', 'A skill you only use at home.'],
            correctAnswer: 2
        },
        {
            question: 'What is a reason to avoid using a template that everyone else is using?',
            options: ['It is too difficult to edit.', 'It does not make your CV stand out.', 'It is not a professional template.', 'It is too long.'],
            correctAnswer: 1
        },
        {
            question: 'What should be the tone of your cover letter?',
            options: ['Casual and informal.', 'Formal and professional.', 'Demanding and aggressive.', 'Overly friendly.'],
            correctAnswer: 1
        },
        {
            question: 'Why should you avoid using jargon on your CV?',
            options: ['It can confuse a recruiter who is not in your field.', 'It makes you sound too professional.', 'It is unprofessional.', 'It takes up too much space.'],
            correctAnswer: 0
        },
        {
            question: 'What is the main purpose of a "professional summary"?',
            options: ['To list all your personal interests.', 'To provide a brief overview of your skills and experience.', 'To list all your past jobs.', 'To state your salary expectations.'],
            correctAnswer: 1
        },
        {
            question: 'Which of the following is a common mistake on a CV?',
            options: ['Using a simple, clean layout.', 'Using bullet points to list achievements.', 'Having inconsistent formatting and different font sizes.', 'Sending the CV in a PDF format.'],
            correctAnswer: 2
        },
        {
            question: 'Why is it important to use a professional email address?',
            options: ['It is a legal requirement.', 'It gives a positive and professional first impression.', 'It is easier to remember.', 'It is a security requirement.'],
            correctAnswer: 1
        },
        {
            question: 'What is the key to making a CV effective?',
            options: ['Making it as long as possible.', 'Highlighting achievements and skills relevant to the job.', 'Including a personal photo.', 'Using a generic template.'],
            correctAnswer: 1
        },
        {
            question: 'What is the purpose of the concluding paragraph in a cover letter?',
            options: ['To summarize your work experience.', 'To express your enthusiasm for the position and your desire for an interview.', 'To ask about the company\'s benefits.', 'To list your references.'],
            correctAnswer: 1
        },
        {
            question: 'What is a major reason for a CV to be rejected?',
            options: ['Spelling and grammatical errors.', 'Having an online portfolio.', 'Using a clean layout.', 'Listing your education in reverse chronological order.'],
            correctAnswer: 0
        },
        {
            question: 'Why should you avoid including salary history on your CV?',
            options: ['It is irrelevant.', 'It is too personal.', 'It can limit your negotiation power.', 'It is not a requirement.'],
            correctAnswer: 2
        },
        {
            question: 'Which of the following is an example of a "powerful action word"?',
            options: ['Helped', 'Was', 'Assisted', 'Managed'],
            correctAnswer: 3
        },
        {
            question: 'What is the primary role of a cover letter?',
            options: ['To serve as a reference letter.', 'To provide a personal introduction to your application.', 'To replace your CV.', 'To list all your previous jobs.'],
            correctAnswer: 1
        },
        {
            question: 'What should you do if your CV has a long work history?',
            options: ['Make it as long as needed to include everything.', 'Focus on the most relevant experience from the last 10-15 years.', 'Use a smaller font to fit it all on two pages.', 'Delete all non-essential information.'],
            correctAnswer: 1
        },
        {
            question: 'The phrase "Curriculum Vitae" means what?',
            options: ['Course of Life.', 'List of Accomplishments.', 'Career Path.', 'Book of Life.'],
            correctAnswer: 0
        },
        {
            question: 'What is a "soft skill"?',
            options: ['A skill that is easy to learn.', 'An interpersonal skill like communication or teamwork.', 'A technical skill like data analysis.', 'A skill you only use at home.'],
            correctAnswer: 1
        },
        {
            question: 'What is the benefit of a "summary" section for an experienced professional?',
            options: ['It gives a brief overview of their career without needing to read the entire CV.', 'It makes the CV shorter.', 'It is required by all companies.', 'It is not useful.'],
            correctAnswer: 0
        },
        {
            question: 'Which of the following is a common mistake when listing education history?',
            options: ['Listing in reverse chronological order.', 'Not including the dates of attendance.', 'Listing the name of the institution.', 'Listing the qualification.'],
            correctAnswer: 1
        },
        {
            question: 'What is a key element of a successful cover letter?',
            options: ['A summary of your resume.', 'A personal narrative about why you are a good fit for the job.', 'A list of your references.', 'A list of all your past jobs.'],
            correctAnswer: 1
        },
        {
            question: 'The most important part of a CV is:',
            options: ['The font and layout.', 'The contact information.', 'The work experience section.', 'The hobbies section.'],
            correctAnswer: 2
        },
        {
            question: 'What is the key to making your CV stand out?',
            options: ['Using colorful and creative fonts.', 'Highlighting your unique skills and achievements.', 'Having a very long CV.', 'Including a photo of yourself.'],
            correctAnswer: 1
        },
        {
            question: 'Why is it important to use consistent formatting and design in your CV?',
            options: ['To make it look like everyone else\'s.', 'To demonstrate attention to detail and professionalism.', 'To save time in creating the document.', 'To make it look modern.'],
            correctAnswer: 1
        },
        {
            question: 'What is a major difference between a "CV" and a "Resume"?',
            options: ['A CV is typically one page, a resume is longer.', 'A CV is used in the USA, a resume is used in Europe.', 'A resume is typically more concise than a CV.', 'A resume is only for entry-level positions.'],
            correctAnswer: 2
        },
        {
            question: 'Why should you avoid using jargon on your CV?',
            options: ['It can make you sound unprofessional.', 'The recruiter may not understand it.', 'It is against company policy.', 'It takes up too much space.'],
            correctAnswer: 1
        },
        {
            question: 'What is the best way to handle your personal information on a CV?',
            options: ['Include your full address, date of birth, and marital status.', 'Include a professional email and phone number.', 'Do not include any personal information.', 'Include links to all your social media profiles.'],
            correctAnswer: 1
        },
        {
            question: 'What is the purpose of an "objective" or "summary" on a CV?',
            options: ['To list all your personal interests.', 'To briefly introduce yourself and your career goals.', 'To list all your past jobs.', 'To list all the skills you have.'],
            correctAnswer: 1
        },
        {
            question: 'What should be the focus of your "Work Experience" section?',
            options: ['A list of all your duties at each job.', 'A list of all the software you used.', 'A list of your key accomplishments and achievements.', 'A list of your job titles and dates only.'],
            correctAnswer: 2
        },
        {
            question: 'What should you do if your CV is rejected?',
            options: ['Give up.', 'Send an angry email to the recruiter.', 'Review your CV for any of the common mistakes listed in the document.', 'Apply for the same job again.'],
            correctAnswer: 2
        },
        {
            question: 'What is the primary role of a cover letter?',
            options: ['To supplement your CV and provide a personal introduction.', 'To replace your CV.', 'To serve as a reference letter.', 'To provide a list of your hobbies.'],
            correctAnswer: 0
        },
        {
            question: 'What is a mistake related to the "contact" section of a CV?',
            options: ['Including a professional phone number.', 'Including a professional email address.', 'Using a vague email address like "mail@gmail.com".', 'Not including your phone number.'],
            correctAnswer: 2
        },
        {
            question: 'What does it mean to have a "well-structured" CV?',
            options: ['It is a single paragraph.', 'It has clear sections with headings and bullet points.', 'It is only one page long.', 'It is printed on high-quality paper.'],
            correctAnswer: 1
        },
        {
            question: 'What is the purpose of the "skills" section in a CV?',
            options: ['To show what you are good at and how it can benefit the company.', 'To list every skill you have ever had.', 'To list only your technical skills.', 'To list only your soft skills.'],
            correctAnswer: 0
        },
        {
            question: 'Which of these is a mistake to avoid in a CV?',
            options: ['Sending it in a PDF format.', 'Including a photo of yourself.', 'Using a clean and simple layout.', 'Using bullet points to list achievements.'],
            correctAnswer: 1
        },
        {
            question: 'Why should you use a professional font like Times New Roman or Arial for your CV?',
            options: ['They are easy for recruiters to read and scan.', 'They are the only fonts that are allowed.', 'They are more expensive.', 'They are more creative.'],
            correctAnswer: 0
        },
        {
            question: 'What should you do if your CV is "just a list of duties"?',
            options: ['Add more duties.', 'Re-write it to focus on achievements and results.', 'Make it longer.', 'Make it shorter.'],
            correctAnswer: 1
        }
    ]
            },

            {

                id: 'memo-100',
    title: 'Comprehensive Memorandum Quiz',
    description: 'A 100-question quiz on the features, purpose, and formatting of memos.',
    subject: 'english',
    questions: [
        {
            question: 'What is a memo primarily used for?',
            options: [
                'External client communications.',
                'A detailed legal document.',
                'Internal communication within an organization.',
                'Personal notes for an individual.'
            ],
            correctAnswer: 2
        },
        {
            question: 'What is a key characteristic of a memo\'s length and purpose?',
            options: [
                'It is always a lengthy report.',
                'It is a detailed and highly formal letter.',
                'It is short and designed to convey information efficiently.',
                'It is a casual, informal message.'
            ],
            correctAnswer: 2
        },
        {
            question: 'The heading of a memo should include:',
            options: [
                'The date, the subject, and the recipient\'s age.',
                'The date, the sender\'s home address, and the recipient\'s full name.',
                'The sender\'s name, the subject, and a personal note.',
                'The date, the recipient\'s name, and the purpose of the memo.'
            ],
            correctAnswer: 3
        },
        {
            question: 'The introduction of a memo should serve what purpose?',
            options: [
                'Providing a personal opinion on the topic.',
                'Outlining the purpose and providing background information.',
                'Introducing a new topic entirely.',
                'Giving a full summary of the body.'
            ],
            correctAnswer: 1
        },
        {
            question: 'Which of the following can be used to structure the main body of a memo?',
            options: [
                'Complex, nested charts.',
                'A single, long sentence.',
                'Bullet points, numbered lists, or paragraphs.',
                'Only long, unbroken prose.'
            ],
            correctAnswer: 2
        },
        {
            question: 'What is the role of the conclusion in a memo?',
            options: [
                'To summarize the memo\'s purpose and outline necessary actions.',
                'To introduce a new topic that will be covered in a future memo.',
                'To provide a detailed biography of the sender.',
                'To list the names of everyone who read the memo.'
            ],
            correctAnswer: 0
        },
        {
            question: 'Which of these is highlighted as an "importance" of a memo in the notes?',
            options: [
                'It is a substitute for all face-to-face meetings.',
                'It is an effective way to have informal conversations.',
                'It serves as a written record for accountability.',
                'It is only used for casual topics.'
            ],
            correctAnswer: 2
        },
        {
            question: 'Compared to verbal communication or email, memos are considered:',
            options: [
                'More informal and less serious.',
                'Less formal and less serious.',
                'More formal and appropriate for sensitive topics.',
                'The exact same level of formality.'
            ],
            correctAnswer: 2
        },
        {
            question: 'The business memo heading includes the recipient\'s name, sender\'s name, subject line, and:',
            options: [
                'Classification.',
                'Personal address.',
                'Company history.',
                'Favorite quote.'
            ],
            correctAnswer: 0
        },
        {
            question: 'The body of the memo should provide:',
            options: [
                'A single, summary sentence.',
                'A list of the sender\'s hobbies.',
                'A detailed discussion of the topic.',
                'An informal greeting.'
            ],
            correctAnswer: 2
        },
        {
            question: 'The introduction of a memo provides an overview of what?',
            options: [
                'The sender\'s personal life.',
                'The memo\'s purpose.',
                'The company\'s mission statement.',
                'A detailed conclusion.'
            ],
            correctAnswer: 1
        },
        {
            question: 'A courteous closing for a memo would be:',
            options: [
                '"Later,"',
                '"Best regards,"',
                '"See ya,"',
                '"Ciao,"'
            ],
            correctAnswer: 1
        },
        {
            question: 'What action should you take before circulating a memo?',
            options: [
                'Proofread it for errors and typos.',
                'Share it on social media.',
                'Send it without review for efficiency.',
                'Get an external party\'s approval.'
            ],
            correctAnswer: 0
        },
        {
            question: 'Attachments to a memo should be listed:',
            options: [
                'They should not be listed.',
                'In the introduction of the memo.',
                'At the end of the memo.',
                'In the main body.'
            ],
            correctAnswer: 2
        },
        {
            question: 'What is a key difference between a memo and a formal letter?',
            options: [
                'A memo is used for internal communication, a letter for external.',
                'A memo is always longer.',
                'A memo is more formal.',
                'A letter is used for internal communication.'
            ],
            correctAnswer: 0
        },
        {
            question: 'Why are memos effective for "clear communication"?',
            options: [
                'They use complex and vague language.',
                'They rely on assumptions and context.',
                'They are always very long and detailed.',
                'They convey information in a concise manner.'
            ],
            correctAnswer: 3
        },
        {
            question: 'What does "record keeping" refer to in the context of a memo?',
            options: [
                'A memo that can be used for future reference.',
                'A memo that must be deleted after reading.',
                'A memo that is only temporary.',
                'A memo that is only for informal use.'
            ],
            correctAnswer: 0
        },
        {
            question: 'According to the example, a memo subject line should be:',
            options: [
                '"New Marketing Plan"',
                '"Read This"',
                '"Hey there"',
                '"Random Thoughts"'
            ],
            correctAnswer: 0
        },
        {
            question: 'Memos are a quick way to communicate because they are:',
            options: [
                'Always verbal.',
                'Informal.',
                'Designed for efficiency.',
                'Always sent as a group message.'
            ],
            correctAnswer: 2
        },
        {
            question: 'The memo notes state that memos are appropriate for:',
            options: [
                'Personal, casual conversations.',
                'Serious or sensitive topics.',
                'Unimportant, day-to-day announcements.',
                'Public, external statements.'
            ],
            correctAnswer: 1
        },
        {
            question: 'What is a core component of a business memo heading?',
            options: [
                'The recipient\'s age.',
                'The sender\'s personal opinion.',
                'The classification of the memo.',
                'The sender\'s phone number.'
            ],
            correctAnswer: 2
        },
        {
            question: 'What information should the body of a memo contain?',
            options: [
                'A comprehensive list of every employee.',
                'A detailed discussion of the topic.',
                'A summary of the memo.',
                'A personal biography of the sender.'
            ],
            correctAnswer: 1
        },
        {
            question: 'The conclusion of a memo should:',
            options: [
                'Summarize the memo and provide recommendations.',
                'Introduce a new discussion topic.',
                'Provide a full list of all staff members.',
                'Be the longest part of the memo.'
            ],
            correctAnswer: 0
        },
        {
            question: 'What is a mistake to avoid when writing a memo?',
            options: [
                'Proofreading it.',
                'Using bullet points.',
                'Including a courteous closing.',
                'Having errors or typos.'
            ],
            correctAnswer: 3
        },
        {
            question: 'A memo helps in "accountability" by providing a written record of:',
            options: [
                'The company\'s financial records.',
                'The sender\'s personal details.',
                'Who received the information and when.',
                'All external communications.'
            ],
            correctAnswer: 2
        },
        {
            question: 'What is the purpose of the "classification" in a memo heading?',
            options: [
                'To indicate the type of font used.',
                'To state the length of the memo.',
                'To mark the level of confidentiality.',
                'To list the names of all recipients.'
            ],
            correctAnswer: 2
        },
        {
            question: 'The introduction provides an overview of the purpose of the memo and also:',
            options: [
                'A detailed list of attachments.',
                'The sender\'s contact information.',
                'A summary of the conclusion.',
                'Relevant background information.'
            ],
            correctAnswer: 3
        },
        {
            question: 'If a memo has attachments, they should be listed at the end of the memo, as stated in the notes under:',
            options: [
                'Closing.',
                'Body.',
                'Introduction.',
                'Attachments.'
            ],
            correctAnswer: 3
        },
        {
            question: 'A memo is considered a form of:',
            options: [
                'Short and to the point communication.',
                'An informal conversation.',
                'A long, detailed report.',
                'An external business letter.'
            ],
            correctAnswer: 0
        },
        {
            question: 'Which of the following is a component of a business memo heading?',
            options: [
                'Sender\'s home phone number.',
                'Recipient\'s name and title.',
                'The company\'s history.',
                'The date of next week\'s meeting.'
            ],
            correctAnswer: 1
        },
        {
            question: 'A memo is a written document used for communication:',
            options: [
                'With clients and vendors.',
                'Within an organization.',
                'With government agencies.',
                'Only with the CEO.'
            ],
            correctAnswer: 1
        },
        {
            question: 'The notes describe memos as being short and to the point to convey information:',
            options: [
                'Slowly and carefully.',
                'Quickly and efficiently.',
                'In a casual way.',
                'In a very detailed manner.'
            ],
            correctAnswer: 1
        },
        {
            question: 'The heading of a memo includes the date and the name of the person or department it is sent to, as well as:',
            options: [
                'The sender\'s personal feelings.',
                'The memo\'s purpose.',
                'A personal photograph.',
                'The recipient\'s job title.'
            ],
            correctAnswer: 1
        },
        {
            question: 'The main body of a memo contains:',
            options: [
                'The most important information.',
                'An informal greeting.',
                'The conclusion of the memo.',
                'The sender\'s personal details.'
            ],
            correctAnswer: 0
        },
        {
            question: 'What should a memo\'s conclusion do?',
            options: [
                'Give a personal opinion.',
                'Summarize information and outline actions.',
                'Introduce a completely new topic.',
                'Provide a long list of facts.'
            ],
            correctAnswer: 1
        },
        {
            question: 'The notes identify "record keeping" as a benefit of memos. What does this refer to?',
            options: [
                'Making a copy of the memo for every department.',
                'Serving as a written record for future reference.',
                'Storing the memo in a physical folder.',
                'Keeping track of the sender\'s personal finances.'
            ],
            correctAnswer: 1
        },
        {
            question: 'How do memos contribute to "accountability"?',
            options: [
                'They provide a clear written record of communication.',
                'They are a form of punishment.',
                'They are a form of informal conversation.',
                'They are used to track an employee\'s attendance.'
            ],
            correctAnswer: 0
        },
        {
            question: 'The notes state that memos are a quick and efficient way to:',
            options: [
                'Have a lengthy discussion.',
                'Send and receive information within an organization.',
                'Communicate with clients.',
                'Share personal opinions.'
            ],
            correctAnswer: 1
        },
        {
            question: 'Which of the following is a suggested courteous closing for a memo?',
            options: [
                'Bye!',
                'Thanks,',
                'Best regards,',
                'So long,'
            ],
            correctAnswer: 2
        },
        {
            question: 'Why is it important to proofread a memo?',
            options: [
                'To make it longer and more formal.',
                'To ensure it is entertaining to read.',
                'To avoid errors and typos.',
                'To add personal touches.'
            ],
            correctAnswer: 2
        },
        {
            question: 'According to the notes, a memo\'s body can be structured in:',
            options: [
                'A single, long paragraph only.',
                'Bullet points, numbered lists, or paragraphs.',
                'A combination of only charts and graphs.',
                'A single, detailed sentence.'
            ],
            correctAnswer: 1
        },
        {
            question: 'What part of a memo provides an overview of its purpose?',
            options: [
                'The closing.',
                'The introduction.',
                'The body.',
                'The attachments.'
            ],
            correctAnswer: 1
        },
        {
            question: 'What is the most important information usually contained within a memo?',
            options: [
                'The introduction.',
                'The main body.',
                'The heading.',
                'The conclusion.'
            ],
            correctAnswer: 1
        },
        {
            question: 'A memo concludes with a summary and:',
            options: [
                'A new introduction.',
                'A list of everyone involved.',
                'Recommendations or follow-up steps.',
                'A detailed biography of the sender.'
            ],
            correctAnswer: 2
        },
        {
            question: 'A key benefit of a memo is its formality, which makes it suitable for:',
            options: [
                'Informal, quick chats.',
                'Serious or sensitive topics.',
                'Casual group messages.',
                'Personal thoughts.'
            ],
            correctAnswer: 1
        },
        {
            question: 'Which of the following is an example of an appropriate subject line?',
            options: [
                'SUBJECT: New Marketing Plan',
                'SUBJECT: Hi',
                'SUBJECT: Read this',
                'SUBJECT: What\'s up?'
            ],
            correctAnswer: 0
        },
        {
            question: 'The notes describe a memo as a document for communication:',
            options: [
                'With clients only.',
                'Within an organization.',
                'Between two different companies.',
                'With external stakeholders.'
            ],
            correctAnswer: 1
        },
        {
            question: 'What is a feature of a memo\'s heading?',
            options: [
                'It lists all of the attachments.',
                'It should only contain the recipient\'s name.',
                'It includes the date, recipient, sender, and subject.',
                'It is an informal greeting.'
            ],
            correctAnswer: 2
        },
        {
            question: 'What kind of information is contained in the body of a memo?',
            options: [
                'A brief overview.',
                'A detailed discussion.',
                'A personal greeting.',
                'A list of attachments.'
            ],
            correctAnswer: 1
        },
        {
            question: 'What is a function of a memo\'s conclusion?',
            options: [
                'To introduce the topic.',
                'To summarize the memo.',
                'To provide a personal opinion.',
                'To list all the employees.'
            ],
            correctAnswer: 1
        },
        {
            question: 'Memos are a form of "clear communication" because they:',
            options: [
                'Use complex, formal language.',
                'Are short and concise.',
                'Are informal and casual.',
                'Are always very long.'
            ],
            correctAnswer: 1
        },
        {
            question: 'A memo can provide evidence of communication between parties for:',
            options: [
                'Casual chat.',
                'Record keeping.',
                'Verbal agreements.',
                'Personal feelings.'
            ],
            correctAnswer: 1
        },
        {
            question: 'Why are memos more efficient than other forms of communication?',
            options: [
                'They are always shorter.',
                'They are always sent via email.',
                'They are a quick way to send and receive information.',
                'They are less formal.'
            ],
            correctAnswer: 2
        },
        {
            question: 'The notes describe memos as being more formal than:',
            options: [
                'Legal contracts.',
                'Verbal or email communication.',
                'Formal letters.',
                'Official reports.'
            ],
            correctAnswer: 1
        },
        {
            question: 'Which of the following is a key element of a business memo heading?',
            options: [
                'Sender\'s personal history.',
                'Recipient\'s name and title.',
                'Sender\'s home address.',
                'Recipient\'s favorite movie.'
            ],
            correctAnswer: 1
        },
        {
            question: 'What should be done to a memo before it is circulated?',
            options: [
                'It should be sent immediately.',
                'It should be proofread for errors.',
                'It should be read aloud to all employees.',
                'It should be signed by the CEO.'
            ],
            correctAnswer: 1
        },
        {
            question: 'What is the purpose of the "TO" and "FROM" fields in a memo heading?',
            options: [
                'To list the memo\'s topic.',
                'To identify the recipient and sender.',
                'To state the memo\'s purpose.',
                'To give a list of all attachments.'
            ],
            correctAnswer: 1
        },
        {
            question: 'What kind of language should be used in a memo\'s body?',
            options: [
                'Casual and informal.',
                'Highly technical.',
                'Clear and concise.',
                'Poetic and dramatic.'
            ],
            correctAnswer: 2
        },
        {
            question: 'What is the primary function of a memo?',
            options: [
                'To serve as a long-term contract.',
                'To facilitate internal communication.',
                'To send information to clients.',
                'To replace all meetings.'
            ],
            correctAnswer: 1
        },
        {
            question: 'The notes state a memo is usually:',
            options: [
                'Short and to the point.',
                'Long and highly detailed.',
                'A multi-page document.',
                'A verbal conversation.'
            ],
            correctAnswer: 0
        },
        {
            question: 'The "heading" of a memo contains information about:',
            options: [
                'The body and conclusion.',
                'The sender, recipient, date, and subject.',
                'The memo\'s attachments.',
                'The company\'s history.'
            ],
            correctAnswer: 1
        },
        {
            question: 'What is included in the introduction of a memo?',
            options: [
                'A detailed discussion of the topic.',
                'A brief overview of the purpose.',
                'A list of the sender\'s hobbies.',
                'The final conclusion.'
            ],
            correctAnswer: 1
        },
        {
            question: 'What part of a memo can be structured with bullet points?',
            options: [
                'The introduction.',
                'The main body.',
                'The conclusion.',
                'The heading.'
            ],
            correctAnswer: 1
        },
        {
            question: 'The conclusion of a memo provides:',
            options: [
                'A new, unrelated topic.',
                'A summary of the memo\'s purpose.',
                'A list of external contacts.',
                'A personal biography.'
            ],
            correctAnswer: 1
        },
        {
            question: 'What is the purpose of the "Record keeping" feature of a memo?',
            options: [
                'To create a fun story for colleagues.',
                'To store a written record of decisions and instructions.',
                'To track an employee\'s performance.',
                'To document every single conversation.'
            ],
            correctAnswer: 1
        },
        {
            question: 'The memo notes state that memos are a form of communication that is more formal than:',
            options: [
                'A verbal agreement.',
                'A legal contract.',
                'A formal letter.',
                'An official report.'
            ],
            correctAnswer: 0
        },
        {
            question: 'What is a key component of a business memo heading?',
            options: [
                'The sender\'s personal details.',
                'The recipient\'s title.',
                'The recipient\'s home address.',
                'The sender\'s favorite color.'
            ],
            correctAnswer: 1
        },
        {
            question: 'The body of a memo should contain:',
            options: [
                'A detailed discussion of the topic.',
                'A single, brief sentence.',
                'A list of the sender\'s personal contacts.',
                'A summary of the memo.'
            ],
            correctAnswer: 0
        },
        {
            question: 'What should the conclusion of a memo do?',
            options: [
                'Introduce new information.',
                'Summarize the memo and provide recommendations.',
                'Give a personal opinion.',
                'Ask a question.'
            ],
            correctAnswer: 1
        },
        {
            question: 'A memo is an effective way to:',
            options: [
                'Send confidential information to external parties.',
                'Convey important information within an organization.',
                'Have a casual conversation.',
                'Share personal opinions.'
            ],
            correctAnswer: 1
        },
        {
            question: 'What is the main purpose of a memo\'s heading?',
            options: [
                'To make the memo look professional.',
                'To provide key details like who the memo is for and about.',
                'To take up space on the page.',
                'To introduce the topic in a detailed way.'
            ],
            correctAnswer: 1
        },
        {
            question: 'The body of a memo should be organized into:',
            options: [
                'One long paragraph.',
                'Meaningful paragraphs with a clear message.',
                'Bullet points only.',
                'Short, fragmented sentences.'
            ],
            correctAnswer: 1
        },
        {
            question: 'According to the document, memos can help hold individuals accountable by:',
            options: [
                'Providing a clear written record of who received information and when.',
                'Being a legal document.',
                'Replacing all verbal communication.',
                'Serving as a long-term contract.'
            ],
            correctAnswer: 0
        },
        {
            question: 'What is a courteous closing suggested for a memo?',
            options: [
                'Catch you later!',
                'Thanks for reading.',
                'Sincerely,',
                'Good job!'
            ],
            correctAnswer: 2
        },
        {
            question: 'What is a "record keeping" function of a memo?',
            options: [
                'Storing it in a physical binder.',
                'Serving as a written record for future reference.',
                'Saving it to a computer hard drive.',
                'Creating a copy for everyone in the company.'
            ],
            correctAnswer: 1
        },
        {
            question: 'What is the purpose of the "classification" in a memo heading?',
            options: [
                'To indicate the level of confidentiality or importance.',
                'To state the length of the memo.',
                'To list the names of everyone who read it.',
                'To describe the topic in detail.'
            ],
            correctAnswer: 0
        },
        {
            question: 'The introduction of a memo provides:',
            options: [
                'A detailed discussion of the topic.',
                'An overview of the memo\'s purpose.',
                'The sender\'s personal details.',
                'A list of everyone who was involved.'
            ],
            correctAnswer: 1
        },
        {
            question: 'What should you do if your memo has attachments?',
            options: [
                'List them at the end.',
                'Do not list them to save space.',
                'Mention them in the introduction.',
                'Attach them to an email without a memo.'
            ],
            correctAnswer: 0
        },
        {
            question: 'What is the main benefit of a memo being "short and to the point"?',
            options: [
                'It is less formal.',
                'It is more efficient for conveying information.',
                'It is harder to understand.',
                'It is more complicated to write.'
            ],
            correctAnswer: 1
        },
        {
            question: 'Which of the following is a component of a business memo heading?',
            options: [
                'Sender\'s home address.',
                'Recipient\'s name.',
                'The company\'s history.',
                'The day of the week.'
            ],
            correctAnswer: 1
        },
        {
            question: 'The memo notes state that memos are a way to convey information in a clear and concise manner for:',
            options: [
                'Record keeping.',
                'External communication.',
                'Internal communication.',
                'Personal use.'
            ],
            correctAnswer: 2
        },
        {
            question: 'What is the difference between a memo body and a memo introduction?',
            options: [
                'The introduction is a detailed discussion, while the body is brief.',
                'The introduction outlines the purpose, while the body provides a detailed discussion.',
                'The introduction is only for a formal memo, while the body is for an informal one.',
                'There is no difference.'
            ],
            correctAnswer: 1
        },
        {
            question: 'What does the term "accountability" refer to in the context of memos?',
            options: [
                'The process of tracking expenses.',
                'Holding individuals responsible for actions based on a written record.',
                'The ability to count the number of memos sent.',
                'A legal agreement between two parties.'
            ],
            correctAnswer: 1
        },
        {
            question: 'What is a mistake to avoid when writing a memo?',
            options: [
                'Proofreading it.',
                'Using bullet points in the body.',
                'Including a courteous closing.',
                'Having spelling or grammatical errors.'
            ],
            correctAnswer: 3
        },
        {
            question: 'According to the document, a memo is typically used for:',
            options: [
                'Short and to the point communication.',
                'Long and detailed discussions.',
                'Personal letters.',
                'Social media posts.'
            ],
            correctAnswer: 0
        },
        {
            question: 'Which part of a memo summarizes its purpose and provides recommendations?',
            options: [
                'Heading',
                'Introduction',
                'Body',
                'Conclusion'
            ],
            correctAnswer: 3
        },
        {
            question: 'What is a key feature of a memo\'s body?',
            options: [
                'It should only be one paragraph.',
                'It must be in a numbered list.',
                'It should be organized into meaningful paragraphs.',
                'It must be a single, detailed sentence.'
            ],
            correctAnswer: 2
        },
        {
            question: 'Why are memos considered more "formal" than email or verbal communication?',
            options: [
                'Because they are always sent with a signature.',
                'Because they are appropriate for more serious or sensitive topics.',
                'Because they are always longer.',
                'Because they are only used for legal purposes.'
            ],
            correctAnswer: 1
        },
        {
            question: 'What should be listed at the end of a memo?',
            options: [
                'A list of the sender\'s hobbies.',
                'Any attachments to the memo.',
                'The memo\'s classification.',
                'The sender\'s full home address.'
            ],
            correctAnswer: 1
        },
        {
            question: 'A memo is an effective tool for communication because it is:',
            options: [
                'Always very long.',
                'Short and to the point.',
                'Informal and personal.',
                'A replacement for formal letters.'
            ],
            correctAnswer: 1
        },
        {
            question: 'The memo notes state that memos are a way to communicate within:',
            options: [
                'A specific team.',
                'An entire organization.',
                'External clients.',
                'Government agencies.'
            ],
            correctAnswer: 1
        },
        {
            question: 'The "heading" of a memo includes the date and the name of the person it is being sent to, as well as:',
            options: [
                'The purpose of the memo.',
                'A personal photograph.',
                'The sender\'s home address.',
                'The recipient\'s job title.'
            ],
            correctAnswer: 0
        },
        {
            question: 'The main body of a memo contains:',
            options: [
                'The most important information.',
                'The conclusion of the memo.',
                'The sender\'s personal details.',
                'An informal greeting.'
            ],
            correctAnswer: 0
        },
        {
            question: 'What is the purpose of the conclusion in a memo?',
            options: [
                'To give a personal opinion.',
                'To summarize information and outline necessary actions.',
                'To introduce a completely new topic.',
                'To provide a long list of facts.'
            ],
            correctAnswer: 1
        },
        {
            question: 'Memos are considered more formal than email or verbal communication, making them suitable for:',
            options: [
                'Casual chats.',
                'More serious or sensitive topics.',
                'Informal group messages.',
                'Daily updates.'
            ],
            correctAnswer: 1
        },
        {
            question: 'What is the purpose of the "Attachments" section in a memo?',
            options: [
                'To list any additional documents that accompany the memo.',
                'To provide a summary of the memo.',
                'To give a list of everyone involved.',
                'To provide a personal note.'
            ],
            correctAnswer: 0
        },
        {
            question: 'What is the main benefit of a memo being "short and to the point"?',
            options: [
                'It is less formal.',
                'It is more efficient for conveying information.',
                'It is harder to understand.',
                'It is more complicated to write.'
            ],
            correctAnswer: 1
        },
        {
            question: 'Which of the following is a component of a business memo heading?',
            options: [
                'Sender\'s home address.',
                'Recipient\'s name and title.',
                'The company\'s history.',
                'The day of the week.'
            ],
            correctAnswer: 1
        },
        {
            question: 'The memo notes state that memos are a way to convey information in a clear and concise manner for:',
            options: [
                'Record keeping.',
                'External communication.',
                'Internal communication.',
                'Personal use.'
            ],
            correctAnswer: 2
        },
        {
            question: 'What is the difference between a memo body and a memo introduction?',
            options: [
                'The introduction is a detailed discussion, while the body is brief.',
                'The introduction outlines the purpose, while the body provides a detailed discussion.',
                'The introduction is only for a formal memo, while the body is for an informal one.',
                'There is no difference.'
            ],
            correctAnswer: 1
        },
        {
            question: 'What does the term "accountability" refer to in the context of memos?',
            options: [
                'The process of tracking expenses.',
                'Holding individuals responsible for actions based on a written record.',
                'The ability to count the number of memos sent.',
                'A legal agreement between two parties.'
            ],
            correctAnswer: 1
        },
        {
            question: 'What is a mistake to avoid when writing a memo?',
            options: [
                'Proofreading it.',
                'Using bullet points in the body.',
                'Including a courteous closing.',
                'Having spelling or grammatical errors.'
            ],
            correctAnswer: 3
        },
        {
            question: 'According to the document, a memo is typically used for:',
            options: [
                'Short and to the point communication.',
                'Long and detailed discussions.',
                'Personal letters.',
                'Social media posts.'
            ],
            correctAnswer: 0
        },
        {
            question: 'Which part of a memo summarizes its purpose and provides recommendations?',
            options: [
                'Heading',
                'Introduction',
                'Body',
                'Conclusion'
            ],
            correctAnswer: 3
        },
        {
            question: 'What is a key feature of a memo\'s body?',
            options: [
                'It should only be one paragraph.',
                'It must be in a numbered list.',
                'It should be organized into meaningful paragraphs.',
                'It must be a single, detailed sentence.'
            ],
            correctAnswer: 2
        },
        {
            question: 'Why are memos considered more "formal" than email or verbal communication?',
            options: [
                'Because they are always sent with a signature.',
                'Because they are appropriate for more serious or sensitive topics.',
                'Because they are always longer.',
                'Because they are only used for legal purposes.'
            ],
            correctAnswer: 1
        },
        {
            question: 'What should be listed at the end of a memo?',
            options: [
                'A list of the sender\'s hobbies.',
                'Any attachments to the memo.',
                'The memo\'s classification.',
                'The sender\'s full home address.'
            ],
            correctAnswer: 1
        },
        {
            question: 'A memo is an effective tool for communication because it is:',
            options: [
                'Always very long.',
                'Short and to the point.',
                'Informal and personal.',
                'A replacement for formal letters.'
            ],
            correctAnswer: 1
        },
        {
            question: 'The memo notes state that memos are a way to communicate within:',
            options: [
                'A specific team.',
                'An entire organization.',
                'External clients.',
                'Government agencies.'
            ],
            correctAnswer: 1
        },
        {
            question: 'The "heading" of a memo includes the date and the name of the person it is being sent to, as well as:',
            options: [
                'The purpose of the memo.',
                'A personal photograph.',
                'The sender\'s home address.',
                'The recipient\'s job title.'
            ],
            correctAnswer: 0
        },
        {
            question: 'The main body of a memo contains:',
            options: [
                'The most important information.',
                'The conclusion of the memo.',
                'The sender\'s personal details.',
                'An informal greeting.'
            ],
            correctAnswer: 0
        },
        {
            question: 'What is the purpose of the conclusion in a memo?',
            options: [
                'To give a personal opinion.',
                'To summarize information and outline necessary actions.',
                'To introduce a completely new topic.',
                'To provide a long list of facts.'
            ],
            correctAnswer: 1
        },
        {
            question: 'Memos are considered more formal than email or verbal communication, making them suitable for:',
            options: [
                'Casual chats.',
                'More serious or sensitive topics.',
                'Informal group messages.',
                'Daily updates.'
            ],
            correctAnswer: 1
        },
        {
            question: 'What is the purpose of the "Attachments" section in a memo?',
            options: [
                'To list any additional documents that accompany the memo.',
                'To provide a summary of the memo.',
                'To give a list of everyone involved.',
                'To provide a personal note.'
            ],
            correctAnswer: 0
        },
        {
            question: 'What is the main benefit of a memo being "short and to the point"?',
            options: [
                'It is less formal.',
                'It is more efficient for conveying information.',
                'It is harder to understand.',
                'It is more complicated to write.'
            ],
            correctAnswer: 1
        },
        {
            question: 'Which of the following is a component of a business memo heading?',
            options: [
                'Sender\'s home address.',
                'Recipient\'s name and title.',
                'The company\'s history.',
                'The day of the week.'
            ],
            correctAnswer: 1
        },
        {
            question: 'The memo notes state that memos are a way to convey information in a clear and concise manner for:',
            options: [
                'Record keeping.',
                'External communication.',
                'Internal communication.',
                'Personal use.'
            ],
            correctAnswer: 2
        },
        {
            question: 'What is the difference between a memo body and a memo introduction?',
            options: [
                'The introduction is a detailed discussion, while the body is brief.',
                'The introduction outlines the purpose, while the body provides a detailed discussion.',
                'The introduction is only for a formal memo, while the body is for an informal one.',
                'There is no difference.'
            ],
            correctAnswer: 1
        },
        {
            question: 'What does the term "accountability" refer to in the context of memos?',
            options: [
                'The process of tracking expenses.',
                'Holding individuals responsible for actions based on a written record.',
                'The ability to count the number of memos sent.',
                'A legal agreement between two parties.'
            ],
            correctAnswer: 1
        },
        {
            question: 'What is a mistake to avoid when writing a memo?',
            options: [
                'Proofreading it.',
                'Using bullet points in the body.',
                'Including a courteous closing.',
                'Having spelling or grammatical errors.'
            ],
            correctAnswer: 3
        },
        {
            question: 'According to the document, a memo is typically used for:',
            options: [
                'Short and to the point communication.',
                'Long and detailed discussions.',
                'Personal letters.',
                'Social media posts.'
            ],
            correctAnswer: 0
        },
        {
            question: 'Which part of a memo summarizes its purpose and provides recommendations?',
            options: [
                'Heading',
                'Introduction',
                'Body',
                'Conclusion'
            ],
            correctAnswer: 3
        },
        {
            question: 'What is a key feature of a memo\'s body?',
            options: [
                'It should only be one paragraph.',
                'It must be in a numbered list.',
                'It should be organized into meaningful paragraphs.',
                'It must be a single, detailed sentence.'
            ],
            correctAnswer: 2
        },
        {
            question: 'Why are memos considered more "formal" than email or verbal communication?',
            options: [
                'Because they are always sent with a signature.',
                'Because they are appropriate for more serious or sensitive topics.',
                'Because they are always longer.',
                'Because they are only used for legal purposes.'
            ],
            correctAnswer: 1
        },
        {
            question: 'What should be listed at the end of a memo?',
            options: [
                'A list of the sender\'s hobbies.',
                'Any attachments to the memo.',
                'The memo\'s classification.',
                'The sender\'s full home address.'
            ],
            correctAnswer: 1
        }
    ]

            },
             
            
            {
    id: 'Electronic Mail',
    title: ' Electronic Mail Quiz',
    description: 'A 75-question quiz on the features, importance, and composition of emails, based exclusively on your document.',
    subject: 'english',
    questions: [
        {
            "question": "What is electronic mail also known as?",
            "options": [
                "A paper message",
                "A digital message",
                "A telephonic message",
                "A verbal message"
            ],
            "correctAnswer": 1
        },
        {
            "question": "How is an email sent and received?",
            "options": [
                "Through postal service",
                "Through a computer network",
                "Through a radio broadcast",
                "Through a fax machine"
            ],
            "correctAnswer": 1
        },
        {
            "question": "Which of the following is a key feature of an email?",
            "options": [
                "A physical address of the sender",
                "A personal joke",
                "Sender and recipient information",
                "A verbal greeting"
            ],
            "correctAnswer": 2
        },
        {
            "question": "What is the purpose of the subject line?",
            "options": [
                "To confuse the recipient",
                "To provide a long, detailed summary",
                "To act as a greeting",
                "To provide a clear and concise summary of the email's purpose"
            ],
            "correctAnswer": 3
        },
        {
            "question": "Where is the main content of the email located?",
            "options": [
                "In the signature",
                "In the subject line",
                "In the email body",
                "In the attachments"
            ],
            "correctAnswer": 2
        },
        {
            "question": "What can the body of an email include?",
            "options": [
                "Only text",
                "Only images",
                "Text, images, documents, and links",
                "Only documents"
            ],
            "correctAnswer": 2
        },
        {
            "question": "What should be included in a signature?",
            "options": [
                "Only a signature drawing",
                "The sender's name and contact information",
                "The recipient's name",
                "The company's mission statement"
            ],
            "correctAnswer": 1
        },
        {
            "question": "Why is proper formatting important in emails?",
            "options": [
                "To make them look colorful",
                "To make them longer",
                "To make them easy to read and understand",
                "To make them harder to read"
            ],
            "correctAnswer": 2
        },
        {
            "question": "What do the timestamps on an email indicate?",
            "options": [
                "When the email was read",
                "When the email was sent and received",
                "When the email was deleted",
                "The time of the day the email was sent"
            ],
            "correctAnswer": 1
        },
        {
            "question": "What is the purpose of the 'Reply' and 'Forward' options?",
            "options": [
                "To delete the email",
                "To save the email",
                "To reply or forward the email to other recipients",
                "To print the email"
            ],
            "correctAnswer": 2
        },
        {
            "question": "What can an email contain as attachments?",
            "options": [
                "Documents and photos",
                "Only photos",
                "Only documents",
                "Only links"
            ],
            "correctAnswer": 0
        },
        {
            "question": "What does BCC stand for?",
            "options": [
                "Blind Carbon Copy",
                "Business Carbon Copy",
                "Blank Contact Copy",
                "Back Carbon Copy"
            ],
            "correctAnswer": 0
        },
        {
            "question": "What does CC stand for?",
            "options": [
                "Carbon Copy",
                "Client Copy",
                "Company Copy",
                "Central Copy"
            ],
            "correctAnswer": 0
        },
        {
            "question": "What is the first step in composing an email?",
            "options": [
                "Writing a subject line",
                "Adding a signature",
                "Determining the purpose and audience",
                "Attaching files"
            ],
            "correctAnswer": 2
        },
        {
            "question": "What kind of tone should an email have?",
            "options": [
                "Informal and casual",
                "Humorous and sarcastic",
                "Professional and courteous",
                "Angry and demanding"
            ],
            "correctAnswer": 2
        },
        {
            "question": "In the first paragraph, what should you do?",
            "options": [
                "Provide a detailed summary of your career",
                "State the purpose and context of the email",
                "Ask a personal question",
                "Start with a personal anecdote"
            ],
            "correctAnswer": 1
        },
        {
            "question": "What kind of language should be used in an email?",
            "options": [
                "Complex and technical",
                "Jargon-filled",
                "Clear and concise",
                "Figurative and metaphorical"
            ],
            "correctAnswer": 2
        },
        {
            "question": "What should the last paragraph of an email include?",
            "options": [
                "A call to action or a closing",
                "A new topic to discuss",
                "An open-ended question",
                "A list of hobbies"
            ],
            "correctAnswer": 0
        },
        {
            "question": "What is the final step before sending an email?",
            "options": [
                "Adding more text",
                "Changing the font",
                "Proofreading and editing",
                "Deleting the subject line"
            ],
            "correctAnswer": 2
        },
        {
            "question": "What does it mean to be 'courteous' in an email?",
            "options": [
                "To be rude",
                "To be respectful and polite",
                "To be sarcastic",
                "To be humorous"
            ],
            "correctAnswer": 1
        },
        {
            "question": "An email allows users to communicate with one another through:",
            "options": [
                "Physical letters",
                "Digital text, images, and attachments",
                "Verbal messages",
                "Telepathic signals"
            ],
            "correctAnswer": 1
        },
        {
            "question": "Which of these is NOT a key feature mentioned in the document?",
            "options": [
                "Subject line",
                "Signature",
                "Spam filter",
                "Attachments"
            ],
            "correctAnswer": 2
        },
        {
            "question": "A short summary of the email's purpose is called the:",
            "options": [
                "Body",
                "Signature",
                "Subject line",
                "Timestamp"
            ],
            "correctAnswer": 2
        },
        {
            "question": "What should the signature at the end of an email contain?",
            "options": [
                "The recipient's name",
                "A detailed summary of the email",
                "The sender's name and contact information",
                "A list of personal interests"
            ],
            "correctAnswer": 2
        },
        {
            "question": "Using paragraphs and font styles appropriately is part of:",
            "options": [
                "The subject line",
                "Proofreading",
                "Formatting",
                "The signature"
            ],
            "correctAnswer": 2
        },
        {
            "question": "Emails can be sent to:",
            "options": [
                "Only one recipient at a time",
                "Multiple recipients at once",
                "Only people you know",
                "Only within your organization"
            ],
            "correctAnswer": 1
        },
        {
            "question": "The document states that email is one of the most common forms of communication in the:",
            "options": [
                "Ancient world",
                "Medieval world",
                "Modern world",
                "Future"
            ],
            "correctAnswer": 2
        },
        {
            "question": "The sender and recipient information in an email includes:",
            "options": [
                "Their physical address",
                "Their full name and email address",
                "Their phone number",
                "Their date of birth"
            ],
            "correctAnswer": 1
        },
        {
            "question": "What should be avoided in the tone of a professional email?",
            "options": [
                "Professionalism",
                "Sarcasm or humor that might be misinterpreted",
                "Courteousness",
                "Clarity"
            ],
            "correctAnswer": 1
        },
        {
            "question": "What should the first paragraph of an email provide?",
            "options": [
                "The purpose and context of the email",
                "A summary of your resume",
                "A long list of your achievements",
                "A fictional story"
            ],
            "correctAnswer": 0
        },
        {
            "question": "What kind of language should you avoid in a professional email?",
            "options": [
                "Clear language",
                "Concise language",
                "Complex sentences or jargon",
                "Simple sentences"
            ],
            "correctAnswer": 2
        },
        {
            "question": "What is a 'call to action'?",
            "options": [
                "A request for the recipient to do something",
                "A personal greeting",
                "A summary of the email",
                "A request for a meeting"
            ],
            "correctAnswer": 0
        },
        {
            "question": "What should you re-read the email for before sending it?",
            "options": [
                "To make it longer",
                "To add more images",
                "To edit any mistakes",
                "To delete the subject line"
            ],
            "correctAnswer": 2
        },
        {
            "question": "What does it mean to 'proofread' an email?",
            "options": [
                "To forward it to someone else",
                "To check it for errors or typos",
                "To print a copy",
                "To save it as a draft"
            ],
            "correctAnswer": 1
        },
        {
            "question": "What is the purpose of the 'Body' of an email?",
            "options": [
                "To contain a short summary",
                "To include a signature",
                "To hold the main content of the email",
                "To list the recipients"
            ],
            "correctAnswer": 2
        },
        {
            "question": "The signature at the end of an email is optional.",
            "options": [
                "True",
                "False"
            ],
            "correctAnswer": 1
        },
        {
            "question": "The subject line should always be long and detailed.",
            "options": [
                "True",
                "False"
            ],
            "correctAnswer": 1
        },
        {
            "question": "The document states that emails are used for both personal and professional purposes.",
            "options": [
                "True",
                "False"
            ],
            "correctAnswer": 0
        },
        {
            "question": "You should use complex sentences to show intelligence.",
            "options": [
                "True",
                "False"
            ],
            "correctAnswer": 1
        },
        {
            "question": "A call to action should be included in the first paragraph.",
            "options": [
                "True",
                "False"
            ],
            "correctAnswer": 1
        },
        {
            "question": "Proofreading should be the very last step before sending.",
            "options": [
                "True",
                "False"
            ],
            "correctAnswer": 0
        },
        {
            "question": "It is acceptable to use sarcasm in a professional email.",
            "options": [
                "True",
                "False"
            ],
            "correctAnswer": 1
        },
        {
            "question": "Formatting makes an email easy to read.",
            "options": [
                "True",
                "False"
            ],
            "correctAnswer": 0
        },
        {
            "question": "You should use clear and concise language in an email.",
            "options": [
                "True",
                "False"
            ],
            "correctAnswer": 0
        },
        {
            "question": "Email is a digital message sent through the internet.",
            "options": [
                "True",
                "False"
            ],
            "correctAnswer": 0
        },
        {
            "question": "The body of an email can only contain text.",
            "options": [
                "True",
                "False"
            ],
            "correctAnswer": 1
        },
        {
            "question": "The subject line is a short summary of the email's purpose.",
            "options": [
                "True",
                "False"
            ],
            "correctAnswer": 0
        },
        {
            "question": "The signature is at the beginning of an email.",
            "options": [
                "True",
                "False"
            ],
            "correctAnswer": 1
        },
        {
            "question": "Email has become one of the most common forms of communication.",
            "options": [
                "True",
                "False"
            ],
            "correctAnswer": 0
        },
        {
            "question": "The first step in composing an email is writing a greeting.",
            "options": [
                "True",
                "False"
            ],
            "correctAnswer": 1
        },
        {
            "question": "What is the main content of an email called?",
            "options": [
                "Signature",
                "Body",
                "Subject line",
                "Timestamp"
            ],
            "correctAnswer": 1
        },
        {
            "question": "Which of these is a key feature of an email?",
            "options": [
                "Voice memo",
                "Hand-drawn map",
                "Attachments",
                "Physical address"
            ],
            "correctAnswer": 2
        },
        {
            "question": "The purpose of a signature is to provide:",
            "options": [
                "A picture of the sender",
                "The sender's contact information",
                "The recipient's contact information",
                "A list of personal hobbies"
            ],
            "correctAnswer": 1
        },
        {
            "question": "What does proper formatting include?",
            "options": [
                "Using complex sentences",
                "Using paragraphs and bullet points",
                "Using only one font size",
                "Making the email longer"
            ],
            "correctAnswer": 1
        },
        {
            "question": "Which option allows you to send an email to a group without the recipients knowing who else received it?",
            "options": [
                "CC",
                "To",
                "BCC",
                "Reply All"
            ],
            "correctAnswer": 2
        },
        {
            "question": "What do sent and received timestamps indicate?",
            "options": [
                "The duration of the email",
                "The time of day it was created",
                "When the email was sent and received",
                "The time it was read"
            ],
            "correctAnswer": 2
        },
        {
            "question": "What should be avoided in an email to prevent misinterpretation?",
            "options": [
                "Professional tone",
                "Sarcasm or humor",
                "Clear language",
                "Call to action"
            ],
            "correctAnswer": 1
        },
        {
            "question": "Where should the purpose and context of the email be stated?",
            "options": [
                "In the subject line",
                "In the signature",
                "In the first paragraph",
                "In the last paragraph"
            ],
            "correctAnswer": 2
        },
        {
            "question": "Why is it important to use clear language?",
            "options": [
                "To make the email shorter",
                "To make the message easy to understand",
                "To sound more formal",
                "To hide information"
            ],
            "correctAnswer": 1
        },
        {
            "question": "What is the final step before clicking 'send'?",
            "options": [
                "Proofreading and editing",
                "Changing the recipient's name",
                "Deleting the subject line",
                "Adding more text"
            ],
            "correctAnswer": 0
        },
        {
            "question": "An email can be sent to one or multiple recipients at once.",
            "options": [
                "True",
                "False"
            ],
            "correctAnswer": 0
        },
        {
            "question": "The subject line should be a short summary.",
            "options": [
                "True",
                "False"
            ],
            "correctAnswer": 0
        },
        {
            "question": "The body is the main content of the email.",
            "options": [
                "True",
                "False"
            ],
            "correctAnswer": 0
        },
        {
            "question": "A signature can contain a list of personal hobbies.",
            "options": [
                "True",
                "False"
            ],
            "correctAnswer": 1
        },
        {
            "question": "Formatting an email makes it harder to read.",
            "options": [
                "True",
                "False"
            ],
            "correctAnswer": 1
        },
        {
            "question": "Timestamps are not a key feature of an email.",
            "options": [
                "True",
                "False"
            ],
            "correctAnswer": 1
        },
        {
            "question": "CC and BCC allow you to send the email to other recipients.",
            "options": [
                "True",
                "False"
            ],
            "correctAnswer": 0
        },
        {
            "question": "The first step in composing an email is to determine the purpose and audience.",
            "options": [
                "True",
                "False"
            ],
            "correctAnswer": 0
        },
        {
            "question": "The tone of an email should be professional and courteous.",
            "options": [
                "True",
                "False"
            ],
            "correctAnswer": 0
        },
        {
            "question": "The last paragraph of an email should include a call to action.",
            "options": [
                "True",
                "False"
            ],
            "correctAnswer": 0
        },
        {
            "question": "What should you provide in the email body to help the recipient?",
            "options": [
                "Relevant information",
                "A detailed life story",
                "A personal joke",
                "A list of your friends"
            ],
            "correctAnswer": 0
        },
        {
            "question": "What should be avoided to prevent jargon?",
            "options": [
                "Clear language",
                "Concise language",
                "Complex sentences",
                "Simple sentences"
            ],
            "correctAnswer": 2
        },
        {
            "question": "What does it mean to 'end with a closing'?",
            "options": [
                "To leave the email open",
                "To use a phrase like 'Sincerely' or 'Best regards'",
                "To write a long ending paragraph",
                "To write a short ending paragraph"
            ],
            "correctAnswer": 1
        },
        {
            "question": "What can you do to fix typos and mistakes before sending?",
            "options": [
                "Forward the email",
                "Proofread and edit",
                "Delete the email",
                "Send a new email"
            ],
            "correctAnswer": 1
        },
        {
            "question": "What kind of emails is the document's advice most applicable to?",
            "options": [
                "Emails to friends",
                "Personal emails",
                "Professional and formal emails",
                "All emails"
            ],
            "correctAnswer": 2
        },
        {
            "question": "The document suggests a simple and quick process for composing an email if you keep in mind the:",
            "options": [
                "Length and color of the email",
                "Number of attachments",
                "Purpose and audience",
                "Time of day"
            ],
            "correctAnswer": 2
        },
        {
            "question": "Who is the 'sender' of an email?",
            "options": [
                "The person who receives it",
                "The person who reads it",
                "The person who sends it",
                "The person who forwards it"
            ],
            "correctAnswer": 2
        },
        {
            "question": "Which of these is a key feature of an email?",
            "options": [
                "Subject line",
                "Hand-written note",
                "Fax number",
                "Phone number"
            ],
            "correctAnswer": 0
        },
        {
            "question": "What is the purpose of the 'body' of an email?",
            "options": [
                "To provide a detailed summary",
                "To provide the main content",
                "To list the recipients",
                "To provide a personal note"
            ],
            "correctAnswer": 1
        },
        {
            "question": "What does an email allow users to do?",
            "options": [
                "Communicate through digital messages",
                "Communicate through physical letters",
                "Communicate through verbal messages",
                "Communicate through phone calls"
            ],
            "correctAnswer": 0
        },
        {
            "question": "What should be avoided to make the message easy to understand?",
            "options": [
                "Jargon",
                "Simple language",
                "Short sentences",
                "Concise words"
            ],
            "correctAnswer": 0
        },
        {
            "question": "How should you start a formal email?",
            "options": [
                "With a joke",
                "By stating the purpose and context",
                "With a personal story",
                "By asking a question"
            ],
            "correctAnswer": 1
        },
        {
            "question": "What is an important part of a professional tone?",
            "options": [
                "Sarcasm",
                "Humor",
                "Courteousness",
                "Rudeness"
            ],
            "correctAnswer": 2
        },
        {
            "question": "What is a 'call to action' in an email?",
            "options": [
                "A request for the recipient to do something",
                "A summary of a previous email",
                "A personal greeting",
                "A list of hobbies"
            ],
            "correctAnswer": 0
        },
        {
            "question": "What is a signature in an email?",
            "options": [
                "A section at the beginning",
                "A digital drawing",
                "A section at the end with sender's details",
                "A personal note"
            ],
            "correctAnswer": 2
        },
        {
            "question": "What is the main purpose of an email?",
            "options": [
                "To send physical letters",
                "To communicate digitally",
                "To make phone calls",
                "To send faxes"
            ],
            "correctAnswer": 1
        },
        {
            "question": "What is a key feature of an email that allows a short summary?",
            "options": [
                "Body",
                "Signature",
                "Subject line",
                "Attachment"
            ],
            "correctAnswer": 2
        },
        {
            "question": "How does an email assist with communication?",
            "options": [
                "It makes it slower",
                "It makes it more efficient",
                "It makes it less concise",
                "It makes it more complex"
            ],
            "correctAnswer": 1
        }
    ]
},



            {
                id: 'letter-writing',
                title: 'Letter Writing',
                description: 'Master the art of formal and informal letter writing',
                subject: 'english',
                questions: [
                    {
                        question: 'Which of these is a formal letter closing?',
                        options: ['Yours sincerely', 'See you soon', 'Take care', 'Cheers'],
                        correctAnswer: 0
                    },
                    {
                        question: 'What is the standard structure of a formal letter?',
                        options: [
                            'Sender address, date, recipient address, salutation, body, closing, signature',
                            'Salutation, body, closing, signature, date',
                            'Recipient address, sender address, body, closing',
                            'Date, salutation, body, signature, sender address'
                        ],
                        correctAnswer: 0
                    }
                ]
            },
            {
                id: 'punctuation',
                title: 'Punctuation',
                description: 'Test your knowledge of proper punctuation usage',
                subject: 'english',
                questions: [
                    {
                        question: 'Which sentence uses apostrophes correctly?',
                        options: [
                            "The dog's bowl is empty.",
                            "The dogs' bowl is empty.",
                            "The dogs bowl is empty.",
                            "The dogs's bowl is empty."
                        ],
                        correctAnswer: 0
                    },
                    {
                        question: 'What is the purpose of a semicolon?',
                        options: [
                            'To connect closely related independent clauses',
                            'To introduce a list',
                            'To indicate possession',
                            'To end a sentence'
                        ],
                        correctAnswer: 0
                    }
                ]
            }
        ],
        'pr': [
            {
                id: 'swot',
                title: 'SWOT Analysis',
                description: 'Understand and apply SWOT analysis techniques',
                subject: 'pr',
                questions: [
                    {
                        question: 'What does SWOT stand for?',
                        options: [
                            'Strengths, Weaknesses, Opportunities, Threats',
                            'Skills, Work, Objectives, Time',
                            'Strategy, Wisdom, Organization, Tactics',
                            'Sales, Wealth, Operations, Training'
                        ],
                        correctAnswer: 0
                    },
                    {
                        question: 'Which of these is an example of an opportunity in SWOT analysis?',
                        options: [
                            'Emerging markets',
                            'Lack of skilled staff',
                            'Strong brand reputation',
                            'Outdated technology'
                        ],
                        correctAnswer: 0
                    }
                ]
            },
            {
                id: 'pearson',
                title: 'Pearson',
                description: 'Pearson product realization concepts and methodologies',
                subject: 'pr',
                questions: [
                    {
                        question: 'What is the main focus of product realization?',
                        options: [
                            'Turning concepts into marketable products',
                            'Financial planning for products',
                            'Marketing strategies',
                            'Customer service'
                        ],
                        correctAnswer: 0
                    }
                ]
            }
        ],
        'challenge': [
            {
                id: 'fixed-mindset',
                title: 'Fixed Mindset',
                description: 'Understanding fixed vs growth mindset concepts',
                subject: 'challenge',
                questions: [
                    {
                        question: 'Which statement reflects a fixed mindset?',
                        options: [
                            '"I\'m just not good at this"',
                            '"I can learn to do this with practice"',
                            '"This challenge will help me grow"',
                            '"Mistakes help me improve"'
                        ],
                        correctAnswer: 0
                    },
                    {
                        question: 'What is a characteristic of a growth mindset?',
                        options: [
                            'Believing abilities can be developed',
                            'Avoiding challenges',
                            'Ignoring feedback',
                            'Feeling threatened by others\' success'
                        ],
                        correctAnswer: 0
                    }
                ]
            },
            {
                id: 'growth-mindset',
                title: 'Growth Mindset',
                description: 'Developing a growth mindset for personal development',
                subject: 'challenge',
                questions: [
                    {
                        question: 'How can someone develop a growth mindset?',
                        options: [
                            'Embrace challenges and learn from criticism',
                            'Stick to what they already know',
                            'Avoid situations where they might fail',
                            'Compare themselves to others who are less skilled'
                        ],
                        correctAnswer: 0
                    }
                ]
            }
        ],
        'entrepreneurship': [
            {
                id: 'enterprise',
                title: 'Enterprise',
                description: 'Fundamentals of starting and running an enterprise',
                subject: 'entrepreneurship',
                questions: [
                    {
                        question: 'What is the first step in starting a business?',
                        options: [
                            'Identifying a business idea',
                            'Securing funding',
                            'Hiring employees',
                            'Finding office space'
                        ],
                        correctAnswer: 0
                    },
                    {
                        question: 'What is a unique selling proposition (USP)?',
                        options: [
                            'The factor that makes a business different from competitors',
                            'The total value of company sales',
                            'The business location',
                            'The number of employees'
                        ],
                        correctAnswer: 0
                    }
                ]
            }
        ]
    },
    videos: [
        {
            id: 'cv-tips',
            title: 'How to Write a CV',
            description: 'Learn professional CV writing techniques',
            subject: 'english',
            youtubeId: 'VoiO353U10Q'
        },
        {
            id: 'swot-analysis',
            title: 'SWOT Analysis Explained',
            description: 'Understanding SWOT analysis for business',
            subject: 'pr',
            youtubeId: 'KUWn_TJTrnU'
        },
        {
            id: 'mindset',
            title: 'Growth vs Fixed Mindset',
            description: 'Developing a growth mindset',
            subject: 'challenge',
            youtubeId: 'bEusrD8g-dM'
        },
        {
            id: 'business-plan',
            title: 'Creating a Business Plan',
            description: 'Steps to create an effective business plan',
            subject: 'entrepreneurship',
            youtubeId: 'Tt08KmFfIYQ'
        },
        {
            id: 'formal-writing',
            title: 'Formal Writing Skills',
            description: 'Improving formal business writing',
            subject: 'english',
            youtubeId: 's2gYq6KbhfA'
        },
        {
            id: 'creative-thinking',
            title: 'Creative Thinking Techniques',
            description: 'Developing creative problem-solving skills',
            subject: 'challenge',
            youtubeId: '-RwkZxGPQb8'
        },
        {
            id: 'team-development',
            title: 'Team Development Stages',
            description: 'Understanding Tuckman\'s model of team development',
            subject: 'pr',
            youtubeId: 'i5mYphUoOCs'
        }
    ],
       motivationMessages: [
        "Lumora Educations has got your back!",
        "Knowledge is power. Keep learning!",
        "Every expert was once a beginner.",
        "Your potential is limitless. Keep going!",
        "Education is the passport to the future.",
        "The harder you work, the luckier you get.",
        "Success doesn't come to you, you go to it.",
        "Dream it. Believe it. Achieve it.",
        "Are you ready to pass the quiz today?",
        "Challenge yourself to grow every day."
    ],
    activeAnimation: null // To keep track of the current animation frame
};

// DOM Elements
const elements = {
    loadingScreen: document.getElementById('loading-screen'),
    sideNav: document.getElementById('side-nav'),
    hamMenu: document.getElementById('ham-menu'),
    mainContent: document.getElementById('main-content'),
        // ADD THESE NEW ELEMENTS
    challengeResultMessage: document.getElementById('challenge-result-message'),
    challengerImage: document.getElementById('challenger-image'),
    challengerName: document.getElementById('challenger-name'),
    challengeScore: document.getElementById('challenge-score'),
    challengeSpeed: document.getElementById('challenge-speed'),
    startChallengeBtn: document.getElementById('start-challenge-btn'),
    // END OF ADDITIONS
    pages: {
        login: document.getElementById('login-page'),
        home: document.getElementById('home-page'),
        quiz: document.getElementById('quiz-page'),
        results: document.getElementById('results-page'),
        study: document.getElementById('study-page'),
        chat: document.getElementById('chat-page'),
        dashboard: document.getElementById('dashboard-page'),
          // ADD THIS NEW PAGE ELEMENT
        challenge: document.getElementById('challenge-start-page') 
    },
    loginForm: document.getElementById('login-form'),
    usernameInput: document.getElementById('username'),
    educationSelect: document.getElementById('educationLevel'),
    rememberMe: document.getElementById('rememberMe'),
    welcomeUsername: document.getElementById('welcome-username'),
    navUsername: document.getElementById('nav-username'),
    navProfileImage: document.getElementById('nav-profile-image'),
    dashboardUsername: document.getElementById('dashboard-username'),
    dashboardCourse: document.getElementById('dashboard-course'),
    dashboardProfileImage: document.getElementById('dashboard-profile-image'),
    profileUpload: document.getElementById('profile-upload'),
    logoutBtn: document.getElementById('logout-btn'),
    subjectFilters: document.querySelectorAll('.subject-filter'),
    quizGrid: document.querySelector('.quiz-grid'),
    currentQuestion: document.getElementById('current-question'),
    totalQuestions: document.getElementById('total-questions'),
    timeLeft: document.getElementById('time-left'),
    questionText: document.getElementById('question-text'),
    optionsContainer: document.getElementById('options-container'),
    finalScore: document.getElementById('final-score'),
    scoreMessage: document.getElementById('score-message'),
    averageSpeed: document.getElementById('average-speed'),
    accuracy: document.getElementById('accuracy'),
    performanceNote: document.getElementById('performance-note'),
    answersReview: document.getElementById('answers-review'),
    retryQuiz: document.getElementById('retry-quiz'),
    studyMore: document.getElementById('study-more'),
    backToHome: document.getElementById('back-to-home'),
    shareOptions: document.querySelectorAll('.share-btn'),
    copyLink: document.getElementById('copy-link'),
    videoGrid: document.querySelector('.video-grid'),
    videoModal: document.getElementById('video-modal'),
    closeModal: document.getElementById('close-modal'),
    videoPlayer: document.getElementById('video-player'),
    chatMessages: document.getElementById('chat-messages'),
    chatInput: document.getElementById('chat-input'),
    sendMessage: document.getElementById('send-message'),
    quizzesTaken: document.getElementById('quizzes-taken'),
    averageScore: document.getElementById('average-score'),
    challengesWon: document.getElementById('challenges-won'),
    totalQuestionsAnswered: document.getElementById('total-questions-answered'),
    totalVisits: document.getElementById('total-visits'),
    todayVisits: document.getElementById('today-visits'),
    challengesShared: document.getElementById('challenges-shared'),
    videosWatched: document.getElementById('videos-watched'),
    videosCompleted: document.getElementById('videos-completed'),
    speedCategory: document.getElementById('speed-category'),
    activityList: document.getElementById('activity-list'),
    consentModal: document.getElementById('consent-modal'),
    consentDeny: document.getElementById('consent-deny'),
    consentAgree: document.getElementById('consent-agree'),
    noStorageModal: document.getElementById('no-storage-modal'),
    noStorageOk: document.getElementById('no-storage-ok')
};

// --- NEW ANIMATION & LOGIN LOGIC STARTS HERE ---

/**
 * REPLACED: Creates the new educational-themed loading animation from your reference code.
 */
const initEducationAnimation = () => {
    if (appState.activeAnimation) cancelAnimationFrame(appState.activeAnimation);
    const canvas = document.createElement('canvas');
    canvas.id = 'education-canvas';
    elements.loadingScreen.prepend(canvas);

    const scene = new THREE.Scene();
    scene.fog = new THREE.Fog(0x000000, 1, 35);
    const camera = new THREE.PerspectiveCamera(75, window.innerWidth / window.innerHeight, 0.1, 1000);
    const renderer = new THREE.WebGLRenderer({ canvas: canvas, antialias: true, alpha: true });
    renderer.setSize(window.innerWidth, window.innerHeight);
    renderer.setPixelRatio(window.devicePixelRatio);
    camera.position.z = 20;

    const ambientLight = new THREE.AmbientLight(0xffffff, 0.3);
    scene.add(ambientLight);
    const pointLight = new THREE.PointLight(0x00ffff, 1.2);
    pointLight.position.set(0, 0, 15);
    scene.add(pointLight);

    const objects = [];
    const createBook = () => {
        const book = new THREE.Group();
        const cover = new THREE.Mesh(new THREE.BoxGeometry(1, 1.4, 0.1), new THREE.MeshStandardMaterial({ color: 0x0077b6 }));
        const pages = new THREE.Mesh(new THREE.BoxGeometry(0.95, 1.3, 0.08), new THREE.MeshStandardMaterial({ color: 0xffffff }));
        pages.position.x = 0.05;
        book.add(cover, pages);
        return book;
    };
    const createPencil = () => {
        const pencil = new THREE.Group();
        const body = new THREE.Mesh(new THREE.CylinderGeometry(0.1, 0.1, 1.5, 8), new THREE.MeshStandardMaterial({ color: 0xffd700 }));
        const tip = new THREE.Mesh(new THREE.ConeGeometry(0.1, 0.3, 8), new THREE.MeshStandardMaterial({ color: 0x2f2f2f }));
        tip.position.y = 0.9;
        pencil.add(body, tip);
        return pencil;
    };
    const createGradCap = () => {
        const cap = new THREE.Group();
        const board = new THREE.Mesh(new THREE.BoxGeometry(1.5, 0.1, 1.5), new THREE.MeshStandardMaterial({ color: 0x1a1a1a }));
        const base = new THREE.Mesh(new THREE.CylinderGeometry(0.5, 0.4, 0.5, 16), new THREE.MeshStandardMaterial({ color: 0x1a1a1a }));
        board.position.y = 0.25;
        cap.add(board, base);
        return cap;
    };
    const createLightbulb = () => {
        const bulb = new THREE.Group();
        const glass = new THREE.Mesh(new THREE.SphereGeometry(0.5, 32, 32), new THREE.MeshStandardMaterial({ color: 0xffff00, emissive: 0xffff00, transparent: true, opacity: 0.6 }));
        const base = new THREE.Mesh(new THREE.CylinderGeometry(0.2, 0.2, 0.3, 16), new THREE.MeshStandardMaterial({ color: 0x808080 }));
        base.position.y = -0.5;
        bulb.add(glass, base);
        return bulb;
    };

    const objectTypes = [createBook, createPencil, createGradCap, createLightbulb];

    for (let i = 0; i < 150; i++) {
        const obj = objectTypes[Math.floor(Math.random() * objectTypes.length)]();
        obj.position.set((Math.random() - 0.5) * 40, (Math.random() - 0.5) * 40, (Math.random() - 0.5) * 40);
        obj.rotation.set(Math.random() * 2 * Math.PI, Math.random() * 2 * Math.PI, Math.random() * 2 * Math.PI);
        const scale = Math.random() * 0.5 + 0.5;
        obj.scale.set(scale, scale, scale);
        scene.add(obj);
        objects.push(obj);
    }

    const animate = () => {
        appState.activeAnimation = requestAnimationFrame(animate);
        objects.forEach(obj => {
            obj.rotation.x += 0.005;
            obj.rotation.y += 0.005;
        });
        renderer.render(scene, camera);
    };
    animate();
    
    return { camera, objects, renderer };
};


/**
 * CORRECTED: Creates an immersive, digital grid loading screen for returning users with improved visibility.
 */
function initMotivationalScreen() {
    // 1. Set up the HTML structure with new styles for visibility
    elements.loadingScreen.innerHTML = `
        <canvas id="motivational-canvas"></canvas>
        <div id="quote-container" class="text-container absolute" style="opacity: 1; display: flex; justify-content: center; align-items: center; padding: 20px;">
            <p id="quote-text" class="text-2xl md:text-4xl font-light text-center" 
               style="color: #ffffff; text-shadow: 0 0 15px rgba(255, 255, 255, 0.7), 0 0 8px rgba(0, 255, 255, 0.7); max-width: 800px;"></p>
        </div>
    `;
    elements.loadingScreen.style.backgroundColor = '#000';
    elements.loadingScreen.style.display = 'flex';


    // 2. Set up the Canvas animation
    const canvas = document.getElementById('motivational-canvas');
    if (!canvas) return;
    const ctx = canvas.getContext('2d');
    canvas.width = window.innerWidth;
    canvas.height = window.innerHeight;

    const cols = Math.floor(canvas.width / 20) + 1;
    const ypos = Array(cols).fill(0);

    ctx.fillStyle = '#000';
    ctx.fillRect(0, 0, canvas.width, canvas.height);

    function matrixAnimation() {
        // Dim the background by making the fade effect stronger
        ctx.fillStyle = 'rgba(0,0,0,.1)';
        ctx.fillRect(0, 0, canvas.width, canvas.height);
        
        // Use a dimmer color for the falling characters
        ctx.fillStyle = 'rgba(0, 255, 255, 0.4)'; // Dimmer cyan
        ctx.font = '15pt monospace';

        ypos.forEach((y, ind) => {
            const text = String.fromCharCode(Math.random() * 128);
            const x = ind * 20;
            ctx.fillText(text, x, y);
            if (y > 100 + Math.random() * 10000) {
                ypos[ind] = 0;
            } else {
                ypos[ind] = y + 20;
            }
        });
    }
    
    // Store the interval ID in the appState to be cleared later
    appState.activeAnimation = setInterval(matrixAnimation, 50);

    // 3. Animate the quote text
    const quoteElement = document.getElementById('quote-text');
    const randomMessage = appState.motivationMessages[Math.floor(Math.random() * appState.motivationMessages.length)];
    let i = 0;
    
    function typeQuote() {
        if (i < randomMessage.length) {
            quoteElement.innerHTML += randomMessage.charAt(i);
            i++;
            setTimeout(typeQuote, 50); // Adjust typing speed here (in ms)
        }
    }
    
    typeQuote();
}


/**
 * FIXED: Shows default loading screen for new users and integrates the new animation.
 */
const showDefaultLoadingScreen = () => {
    elements.loadingScreen.innerHTML = `
        <div id="text-1" class="text-container absolute">
            <h1 class="text-4xl md:text-6xl font-black tracking-wider uppercase">Exam Study Assistant</h1>
            <p class="text-lg md:text-xl font-light mt-2 text-gray-300">Powered by Lumora Educations</p>
        </div>
        <div id="text-2" class="text-container absolute">
            <h2 class="men text-2xl md:text-4xl font-bold text-cyan-300 tracking-wide">Special Edition for DTI Learners</h2>
        </div>
    `;
    const { camera, objects } = initEducationAnimation();

    const tl = gsap.timeline();
    const totalDuration = 5.5;

    tl.to(camera.position, { z: -10, duration: totalDuration, ease: "power1.inOut" });
    tl.fromTo("#text-1", { opacity: 0, y: 20 }, { opacity: 1, y: 0, duration: 1, ease: "power2.out" }, 0.5)
      .to("#text-1", { opacity: 0, y: -20, duration: 0.8, ease: "power2.in" }, 2.3)
      .fromTo("#text-2", { opacity: 0, y: 20 }, { opacity: 1, y: 0, duration: 1, ease: "power2.out" }, 2.9)
      .to("#text-2", { opacity: 0, y: -20, duration: 0.8, ease: "power2.in" }, 4.7);

    objects.forEach(obj => {
        tl.to(obj.position, { x: 0, y: 0, z: camera.position.z + 5, duration: 0.8, ease: "power2.in" }, totalDuration - 1);
        tl.to(obj.scale, { x: 0.01, y: 0.01, z: 0.01, duration: 0.8, ease: "power2.in" }, totalDuration - 1);
    });
};

 

/**
 * UPDATED: Initializes the application, calling the new motivational screen.
 */
const initApp = () => {
    
    console.log("Initializing app with updated logic...");

     // ADD THIS FUNCTION CALL AT THE START
    updateMetaTags();
    // END OF ADDITION

    const lastLogin = localStorage.getItem('lastLogin');
    if (lastLogin) {
        const daysSinceLastLogin = (new Date() - new Date(lastLogin)) / (1000 * 60 * 60 * 24);
        if (daysSinceLastLogin >= 14) {
            console.log("User data expired. Clearing localStorage.");
            localStorage.clear();
        }
    }

    const userData = localStorage.getItem('userData');
    const rememberMe = localStorage.getItem('rememberMe');

    if (userData && rememberMe === 'true') {
        initMotivationalScreen(); // <-- Use the new function
    } else {
        showDefaultLoadingScreen();
    }
    
    setupEventListeners();
    initKaleidoscopeBackground();
    
    // Set timeout to 2.5 seconds for both loading screens
    const loadingDuration = (userData && rememberMe === 'true') ? 2500 : 5500;

    setTimeout(() => {
        gsap.to(elements.loadingScreen, {
            opacity: 0,
            duration: 0.5,
            onComplete: () => {
                elements.loadingScreen.style.display = 'none';
                if (appState.activeAnimation) clearInterval(appState.activeAnimation); // Clear the new interval
               
                // ADD THIS LOGIC BLOCK
                const urlParams = new URLSearchParams(window.location.search);
                if (urlParams.has('challenge')) {
                    appState.challengeInfo = {
                        name: urlParams.get('challenge'),
                        quizId: urlParams.get('quiz'),
                        score: urlParams.get('score'),
                        speed: urlParams.get('speed'),
                        pfp: urlParams.get('pfp'),
                        qOrder: urlParams.get('qOrder')?.split(',').map(Number)
                    };
                }
                // END OF LOGIC BLOCK

                if (userData && rememberMe === 'true') {
                    try {
                        appState.currentUser = JSON.parse(userData);
                        updateUserStats('visit');
                        updateUserInterface();
                        // MODIFY THIS LINE
                        if (appState.challengeInfo) {
                            showChallengePrompt();
                        } else {
                            showPage('home');
                        }
                    } catch (e) {
                        showPage('login');
                    }
                } else {
                    showPage('login');
                }
            }
        });
    }, loadingDuration);
};

// --- ADD THE FOLLOWING NEW FUNCTIONS AFTER initApp() ---

/**
 * NEW: Updates meta tags for link previews based on URL parameters.
 */
function updateMetaTags() {
    const urlParams = new URLSearchParams(window.location.search);
    const titleTag = document.querySelector('meta[property="og:title"]');
    const descTag = document.querySelector('meta[property="og:description"]');
    const imageTag = document.querySelector('meta[property="og:image"]');

    if (urlParams.has('challenge')) {
        const name = urlParams.get('challenge');
        const score = urlParams.get('score');
        const speed = urlParams.get('speed');
        const pfp = urlParams.get('pfp');
        
        titleTag.content = `${name} has challenged you!`;
        descTag.content = `I scored ${score} with an average speed of ${speed}s. Can you beat my score?`;
        if (pfp) imageTag.content = pfp;

    } else {
        // Default tags are already in the HTML, but you can set them here too if needed.
        titleTag.content = "Exam Study Assistant for DTI";
        descTag.content = "An interactive quiz and study platform designed to help DTI students excel in their exams.";
    }
}


// Set up all event listeners
function setupEventListeners() {
    console.log("Setting up event listeners...");
    
    // Navigation
     if (elements.hamMenu) {
        elements.hamMenu.addEventListener('click', toggleNav);
    }
    
    // Side navigation links
    const navLinks = document.querySelectorAll('.side-nav a[data-page]');
    if (navLinks.length > 0) {
        navLinks.forEach(link => {
            link.addEventListener('click', (e) => {
                e.preventDefault();
                const page = link.getAttribute('data-page');
                showPage(page);
                if (window.innerWidth < 768) {
                    elements.sideNav.classList.remove('active');
                }
            });
        });
    }
    
    // Login form
    if (elements.loginForm) {
        elements.loginForm.addEventListener('submit', handleLogin);
    }
    
    // Subject filters
    if (elements.subjectFilters && elements.subjectFilters.length > 0) {
        elements.subjectFilters.forEach(filter => {
            filter.addEventListener('click', () => {
                elements.subjectFilters.forEach(f => f.classList.remove('active'));
                filter.classList.add('active');
                filterQuizzes(filter.getAttribute('data-subject'));
            });
        });
    }
    
    // Quiz controls
    /*if (elements.prevQuestion) elements.prevQuestion.addEventListener('click', goToPreviousQuestion);
    if (elements.nextQuestion) elements.nextQuestion.addEventListener('click', goToNextQuestion);
    */
    // Results actions
    if (elements.retryQuiz) elements.retryQuiz.addEventListener('click', retryQuiz);
    if (elements.studyMore) elements.studyMore.addEventListener('click', () => showPage('study'));
    if (elements.backToHome) elements.backToHome.addEventListener('click', () => showPage('home'));
    
    // Share options
    if (elements.shareOptions && elements.shareOptions.length > 0) {
        elements.shareOptions.forEach(option => {
            option.addEventListener('click', () => {
                shareScore(option.getAttribute('data-platform'));
            });
        });
    }
    if (elements.copyLink) elements.copyLink.addEventListener('click', copyScoreLink);
    
    // Video modal
    if (elements.closeModal) elements.closeModal.addEventListener('click', closeVideoModal);
    
    // Chat
    if (elements.sendMessage) elements.sendMessage.addEventListener('click', sendChatMessage);
    if (elements.chatInput) {
        elements.chatInput.addEventListener('keypress', (e) => {
            if (e.key === 'Enter') {
                sendChatMessage();
            }
        });
    }
    
    // Dashboard
    if (elements.profileUpload) elements.profileUpload.addEventListener('change', handleProfileUpload);
    if (elements.logoutBtn) elements.logoutBtn.addEventListener('click', handleLogout);
    
    // Modals
    if (elements.consentDeny) elements.consentDeny.addEventListener('click', denyConsent);
    if (elements.consentAgree) elements.consentAgree.addEventListener('click', agreeConsent);
    if (elements.noStorageOk) {
        elements.noStorageOk.addEventListener('click', () => {
            elements.noStorageModal.classList.remove('active');
        });
    }
    
    // Window resize event
    window.addEventListener('resize', handleResize);
}

// Show a specific page
function showPage(pageId) {
    console.log("Showing page:", pageId);
    
    // Hide all pages
    Object.values(elements.pages).forEach(page => {
        if (page) page.classList.remove('active');
    });
    
    // Show the requested page
    if (elements.pages[pageId]) {
        elements.pages[pageId].classList.add('active');
        appState.currentPage = pageId;
        
        // Page-specific initialization
        switch (pageId) {
            case 'home':
                initHomePage();
                break;
            case 'study':
                initStudyPage();
                break;
            case 'dashboard':
                initDashboardPage();
                break;
        }
    } else {
        console.error("Page not found:", pageId);
    }
}

/**
 * Handles clicks outside the navigation menu to close it.
 * This function is added as an event listener to the document when the menu opens.
 * @param {MouseEvent} event - The click event object.
 */
function handleClickOutside(event) {
    // We only proceed if the click was NOT on the side navigation itself (or one of its children)
    // AND it was NOT on the hamburger menu button that opens it.
    if (!elements.sideNav.contains(event.target) && !elements.hamMenu.contains(event.target)) {
        // If the side nav has the 'active' class (meaning it's open),
        // we call toggleNav() to trigger the closing animation.
        if (elements.sideNav.classList.contains('active')) {
            toggleNav();
        }
    }
}

/**
 * Toggles the mobile navigation menu with GSAP animations.
 * Handles both opening and closing states.
 */
function toggleNav() {
    const sideNav = elements.sideNav;
    const isActive = sideNav.classList.contains('active');

    if (isActive) {
        // --- CLOSE ANIMATION ---
        // The menu is currently open, so we need to close it.

        // First, we immediately remove the event listener that checks for clicks outside.
        document.removeEventListener('click', handleClickOutside);

        // Animate the navigation menu off-screen to the left.
        gsap.to(sideNav, {
            xPercent: -100, // Move it -100% of its own width on the X-axis.
            duration: 0.5,
            ease: "power2.in",
            onComplete: () => {
                // After the animation is complete, remove the 'active' class.
                sideNav.classList.remove('active');
                
                // **THE FIX for not opening again**:
                // We must clear the inline 'transform' style set by GSAP.
                // This allows our CSS classes to correctly control the menu's position next time.
                gsap.set(sideNav, { clearProps: "transform" });
            }
        });
    } else {
        // --- OPEN ANIMATION ---
        // The menu is closed, so we need to open it.

        // Add the 'active' class to manage the state.
        sideNav.classList.add('active');

        // Animate the menu in from the left with a bouncy, elastic effect.
        gsap.from(sideNav, {
            xPercent: -100, // Animate FROM off-screen left...
            duration: 0.6,   // ...to its default position (defined in CSS).
            ease: "elastic.out(1, 0.75)",
            onComplete: () => {
                // **THE FIX for clicking outside**:
                // After the menu has finished opening, we add the event listener to the document
                // to detect any clicks that happen outside of the menu.
                document.addEventListener('click', handleClickOutside);
            }
        });
    }
}



// --- INSTRUCTIONS ---
// In your `setupEventListeners` function, find the code for the navigation links
// and REPLACE it with the following block. This ensures the menu closes correctly
// when a link is clicked on mobile.

const navLinks = document.querySelectorAll('.side-nav a[data-page]');
if (navLinks.length > 0) {
    navLinks.forEach(link => {
        link.addEventListener('click', (e) => {
            e.preventDefault();
            const page = link.getAttribute('data-page');
            showPage(page);
            
            // If the nav menu is currently open, call toggleNav() to close it.
            // This triggers the proper slide-out animation.
            if (elements.sideNav.classList.contains('active')) {
                toggleNav();
            }
        });
    });
}



// Handle login form submission
/**
 * UPDATED: Handles login, checks for existing data, or creates a new user.
 */
const handleLogin = (e) => {
    e.preventDefault();
    
    const username = elements.usernameInput.value.trim();
    const course = elements.educationSelect.value;
    const rememberMe = elements.rememberMe.checked;
    
    if (!username || !course) return alert('Please enter your name and select a course.');
    
    const storedUserData = localStorage.getItem('userData');
    if (rememberMe && storedUserData) {
        const parsedData = JSON.parse(storedUserData);
        if (parsedData.fullName.toLowerCase() === username.toLowerCase()) {
            console.log("Returning user found. Loading data.");
            appState.currentUser = parsedData;
            localStorage.setItem('lastLogin', new Date().toISOString());
            return proceedAfterLogin();
        }
    }

    console.log("Creating a new user profile.");
    const nameParts = username.split(' ');
    appState.currentUser = {
        username: nameParts.slice(0, 2).join(' '),
        fullName: username,
        course: course,
        joined: new Date().toISOString(),
        stats: {
            quizzesTaken: 0, averageScore: 0, challengesWon: 0, totalQuestions: 0,
            totalVisits: 1, todayVisits: 1, lastVisit: new Date().toISOString(), challengesShared: 0,
            videosWatched: 0, videosCompleted: 0, questionTimes: [],
            subjectPerformance: {}, recentActivities: []
        }
    };
    
    if (rememberMe) {
        elements.consentModal.classList.add('active');
    } else {
        localStorage.clear();
        elements.noStorageModal.classList.add('active');
        proceedAfterLogin();
    }
};

/**
 * UPDATED: Handles user agreement to store data.
 */
const agreeConsent = () => {
    localStorage.setItem('rememberMe', 'true');
    localStorage.setItem('userData', JSON.stringify(appState.currentUser));
    localStorage.setItem('lastLogin', new Date().toISOString());
    elements.consentModal.classList.remove('active');
    proceedAfterLogin();
};

/**
 * UPDATED: Handles user denial to store data.
 */
const denyConsent = () => {
    localStorage.clear();
    elements.consentModal.classList.remove('active');
    elements.noStorageModal.classList.add('active');
};

const proceedAfterLogin = () => {
    updateUserInterface();
    showPage('home');
};

// Update UI with user data
function updateUserInterface() {
    if (!appState.currentUser) return;
    
    // Update username displays
    elements.welcomeUsername.textContent = appState.currentUser.username;
    elements.navUsername.textContent = appState.currentUser.username;
    elements.dashboardUsername.textContent = appState.currentUser.username;
    elements.dashboardCourse.textContent = appState.currentUser.course;
    
    // Update profile image if exists
    const profileImage = localStorage.getItem('profileImage');
    if (profileImage) {
        elements.navProfileImage.innerHTML = `<img src="${profileImage}" alt="Profile">`;
        elements.dashboardProfileImage.innerHTML = `<img src="${profileImage}" alt="Profile">`;
    }
    
    // Update stats if exists
    if (appState.currentUser.stats) {
        elements.quizzesTaken.textContent = appState.currentUser.stats.quizzesTaken || 0;
        elements.averageScore.textContent = `${appState.currentUser.stats.averageScore || 0}%`;
        elements.challengesWon.textContent = appState.currentUser.stats.challengesWon || 0;
        elements.totalQuestionsAnswered.textContent = appState.currentUser.stats.totalQuestions || 0;
        elements.totalVisits.textContent = appState.currentUser.stats.totalVisits || 0;
        elements.todayVisits.textContent = appState.currentUser.stats.todayVisits || 0;
        elements.challengesShared.textContent = appState.currentUser.stats.challengesShared || 0;
        elements.videosWatched.textContent = appState.currentUser.stats.videosWatched || 0;
        elements.videosCompleted.textContent = appState.currentUser.stats.videosCompleted || 0;
    }
}

// Initialize home page
function initHomePage() {
    console.log("Initializing home page...");
    
    // Clear quiz grid
    if (elements.quizGrid) {
        elements.quizGrid.innerHTML = '';
    } else {
        console.error("Quiz grid element not found");
        return;
    }
    
    // Add all quizzes to the grid
    Object.values(appState.quizzes).flat().forEach(quiz => {
        const quizCard = document.createElement('div');
        quizCard.className = 'quiz-card';
        quizCard.dataset.id = quiz.id;
        quizCard.dataset.subject = quiz.subject;
        
        quizCard.innerHTML = `
            <div class="quiz-image"><img src="https://images.pexels.com/photos/1266808/pexels-photo-1266808.jpeg?auto=compress&cs=tinysrgb&h=650&w=940"></img></div>
            <div class="quiz-content">
                <div class="quiz-title">${quiz.title}</div>
                <div class="quiz-description">${quiz.description}</div>
            </div>
        `;
        
        quizCard.addEventListener('click', () => {
            startQuiz(quiz.id);
        });
        
        elements.quizGrid.appendChild(quizCard);
    });
}

// Filter quizzes by subject
function filterQuizzes(subject) {
    const quizCards = elements.quizGrid.querySelectorAll('.quiz-card');
    
    quizCards.forEach(card => {
        if (subject === 'all' || card.dataset.subject === subject) {
            card.style.display = 'block';
        } else {
            card.style.display = 'none';
        }
    });
}

// Helper function to shuffle arrays (Fisher-Yates algorithm)
function shuffleArray(array) {
    const newArray = [...array];
    for (let i = newArray.length - 1; i > 0; i--) {
        const j = Math.floor(Math.random() * (i + 1));
        [newArray[i], newArray[j]] = [newArray[j], newArray[i]];
    }
    return newArray;
}

/**
 * Starts a quiz with a given ID.
 * It shuffles questions and their options, limits the quiz to 25 questions,
 * and initializes the quiz state.
 * @param {string} quizId - The ID of the quiz to start.
 */
function startQuiz(quizId) {
    // Find the quiz from the app state
    let selectedQuiz = null;
    for (const subject in appState.quizzes) {
        selectedQuiz = appState.quizzes[subject].find(q => q.id === quizId);
        if (selectedQuiz) break;
    }
    
    if (!selectedQuiz) {
        console.error("Quiz not found:", quizId);
        return;
    }

    // Animate navigation menu out of view
    if (window.innerWidth <= 768) {
        gsap.to(".ham", { x: "150%", duration: 0.5, ease: "sine.out" });
    } else {
        gsap.to(".side-nav", { x: "-100%", duration: 0.5, ease: "sine.out" });
    }
    
    // Create a deep copy to avoid modifying the original quiz data
    const quizCopy = JSON.parse(JSON.stringify(selectedQuiz));
    
   // --- REPLACE THE QUESTION SHUFFLING LOGIC WITH THIS ---
    if (appState.isChallengeMode && appState.challengeInfo.qOrder) {
        // For challenges, use the specific question order from the URL
        const orderedQuestions = appState.challengeInfo.qOrder.map(index => quizCopy.questions[index]);
        quizCopy.questions = orderedQuestions.slice(0, 25); // Still cap at 25
        console.log("Challenge mode: Using pre-defined question order.");
    } else {
        // For regular quizzes, shuffle the questions
        if (quizCopy.questions.length > 25) {
            const shuffledQuestions = shuffleArray([...quizCopy.questions]);
            quizCopy.questions = shuffledQuestions.slice(0, 25);
        }
        quizCopy.questions = shuffleArray(quizCopy.questions);
    }
    
    // Store the final question order to be used for sharing
    appState.questionOrder = selectedQuiz.questions.map(q => {
        return quizCopy.questions.findIndex(shuffledQ => shuffledQ.question === q.question);
    }).filter(index => index !== -1);
    // --- END OF REPLACEMENT ---

    
    // Randomize the order of questions
    quizCopy.questions = shuffleArray(quizCopy.questions);
    
    // Randomize the order of options for each question and update the correct answer index
    quizCopy.questions.forEach(question => {
        const originalCorrectIndex = question.correctAnswer;
        const optionIndices = question.options.map((_, index) => index);
        const shuffledIndices = shuffleArray(optionIndices);
        const newOptions = shuffledIndices.map(index => question.options[index]);
        const newCorrectIndex = shuffledIndices.indexOf(originalCorrectIndex);
        question.options = newOptions;
        question.correctAnswer = newCorrectIndex;
    });
    
    // Initialize the state for the current quiz
    appState.currentQuiz = quizCopy;
    appState.currentQuestion = 0;
    appState.userAnswers = new Array(quizCopy.questions.length).fill(null);
    appState.questionStartTime = new Array(quizCopy.questions.length);
    
    elements.totalQuestions.textContent = quizCopy.questions.length;
    showPage('quiz');
    showQuestion(0);
    
    // Start the timer for the first question
    appState.timeLeft = 60;
    elements.timeLeft.textContent = appState.timeLeft;
    if (appState.timer) clearInterval(appState.timer);
    appState.timer = setInterval(updateTimer, 1000);
    appState.questionStartTime[0] = Date.now();
}

/**
 * Updates the timer every second and handles time-out.
 */
function updateTimer() {
    appState.timeLeft--;
    elements.timeLeft.textContent = appState.timeLeft;

    const timerBar = document.getElementById('timer-bar');
    if (timerBar) {
        const percentage = (appState.timeLeft / 60) * 100;
        timerBar.style.width = `${percentage}%`;

        // Add a pulsing effect when time is low
        if (appState.timeLeft <= 10) {
            timerBar.classList.add('time-low-pulse');
        } else {
            timerBar.classList.remove('time-low-pulse');
        }
    }

    // If time runs out, treat it as an incorrect answer and move to the next question
    if (appState.timeLeft <= 0) {
        clearInterval(appState.timer);
        appState.userAnswers[appState.currentQuestion] = { answer: -1, timeTaken: 60 }; // Mark as unanswered
        goToNextQuestion();
    }
}

/**
 * Displays the current question and its options.
 * @param {number} index - The index of the question to show.
 */
function showQuestion(index) {
    // Reset the timer bar for the new question
    const timerBar = document.getElementById('timer-bar');
    if (timerBar) {
        timerBar.style.width = '100%';
        timerBar.classList.remove('time-low-pulse');
    }

    const question = appState.currentQuiz.questions[index];
    
    elements.currentQuestion.textContent = index + 1;
    elements.questionText.textContent = question.question;
    elements.optionsContainer.innerHTML = '';
    
    // Create and display the option buttons
    question.options.forEach((option, i) => {
        const optionElement = document.createElement('div');
        optionElement.className = 'option';
        optionElement.dataset.index = i;
        optionElement.textContent = option;
        optionElement.addEventListener('click', () => selectOption(i));
        elements.optionsContainer.appendChild(optionElement);
    });
    
    // **FIX:** The lines that referenced the deleted "next" and "previous" buttons have been removed
    // to prevent the script from breaking here.
}

/**
 * Handles the user selecting an answer option.
 * @param {number} optionIndex - The index of the selected option.
 */
function selectOption(optionIndex) {
    // Stop the timer as soon as an answer is selected
    clearInterval(appState.timer);

    const options = elements.optionsContainer.querySelectorAll('.option');
    // Disable all options to prevent multiple clicks
    options.forEach(option => option.classList.add('disabled'));

    // Record the answer and time
    const timeTaken = (Date.now() - appState.questionStartTime[appState.currentQuestion]) / 1000;
    appState.userAnswers[appState.currentQuestion] = {
        answer: optionIndex,
        timeTaken: timeTaken
    };

    // Provide immediate visual feedback
    const question = appState.currentQuiz.questions[appState.currentQuestion];
    const selectedOption = options[optionIndex];

    if (optionIndex === question.correctAnswer) {
        selectedOption.classList.add('correct');
    } else {
        selectedOption.classList.add('incorrect');
        options[question.correctAnswer].classList.add('correct'); // Show the correct one
    }

    // Wait for feedback, then animate to the next question
    setTimeout(() => {
        const questionCard = document.querySelector('.question-card');
        gsap.to(questionCard, {
            opacity: 0,
            y: -20,
            duration: 0.3,
            ease: "power2.in",
            onComplete: () => {
                goToNextQuestion();
                // Fade the new question in
                gsap.fromTo(questionCard,
                    { opacity: 0, y: 20 },
                    { opacity: 1, y: 0, duration: 0.4, ease: "power2.out" }
                );
            }
        });
    }, 1200); // 1.2-second delay
}

/**
 * Navigates to the next question or finishes the quiz if it's the last one.
 */
function goToNextQuestion() {
    if (appState.currentQuestion >= appState.currentQuiz.questions.length - 1) {
        finishQuiz();
    } else {
        appState.currentQuestion++;
        showQuestion(appState.currentQuestion);
        
        // Reset and restart the timer for the new question
        appState.timeLeft = 60;
        elements.timeLeft.textContent = appState.timeLeft;
        if (appState.timer) clearInterval(appState.timer);
        appState.timer = setInterval(updateTimer, 1000);
        appState.questionStartTime[appState.currentQuestion] = Date.now();
    }
}


// Corrected: Finishes the quiz, shows the score, and animates the navigation back in.
function finishQuiz() {
    if (appState.timer) clearInterval(appState.timer);

    // FIX: This code now correctly animates the navigation back into view.
    if (window.innerWidth <= 768) {
        // Mobile: Bounce in hamburger menu
        gsap.to(".ham", { x: "0%", duration: 1, ease: "bounce.out", delay: 0.2 });
    } else {
        // Desktop: Slide in side navigation
        gsap.to(".side-nav", { x: "0%", duration: 0.5, ease: "sine4.in", delay: 0.2 });
    }
    
    const quiz = appState.currentQuiz;
    let score = 0;
    let totalTime = 0;
    let answeredQuestions = 0;
    
    // Calculate score and performance metrics
    appState.userAnswers.forEach((answer, index) => {
        if (answer && answer.answer === quiz.questions[index].correctAnswer) {
            score++;
        }
        if (answer && answer.timeTaken) {
            totalTime += answer.timeTaken;
            answeredQuestions++;
        }
    });

     const averageTime = answeredQuestions > 0 ? (totalTime / answeredQuestions).toFixed(1) : 0;
    const accuracy = (score / quiz.questions.length) * 100;

    // Update results page
    elements.finalScore.textContent = `${score}/${quiz.questions.length}`;
    elements.averageSpeed.textContent = `${averageTime}s`;
    elements.accuracy.textContent = `${accuracy.toFixed(0)}%`;

    // Set performance note based on score and speed
    let performanceNote = '';
    if (accuracy >= 80) {
        if (averageTime < 5) {
            performanceNote = "Wooaa! How did you answer the questions this fast? I knew you were a shark!";
        } else if (averageTime < 10) {
            performanceNote = "You did well, I knew you were a shark!";
        } else if (averageTime < 20) {
            performanceNote = "Good job! You balanced speed and accuracy perfectly.";
        } else {
            performanceNote = "Great accuracy! With a bit more practice, you'll be faster too!";
        }
    } else if (accuracy >= 60) {
        if (averageTime < 5) {
            performanceNote = "You're fast but accuracy matters too. Try to read questions more carefully.";
        } else if (averageTime < 10) {
            performanceNote = "Good effort! With a bit more study, you'll master this!";
        } else if (averageTime < 20) {
            performanceNote = "You're taking your time to think, which is good. Now focus on improving accuracy.";
        } else {
            performanceNote = "I can see the quiz was quite challenging for you but you tried your best.";
        }
    } else {
        if (averageTime < 5) {
            performanceNote = "You rushed through the questions. Slow down and read carefully next time.";
        } else if (averageTime < 10) {
            performanceNote = "Keep practicing! Review the material and try again with more focus.";
        } else if (averageTime < 20) {
            performanceNote = "You're putting in the time, now focus on understanding the concepts better.";
        } else {
            performanceNote = "I wish you could be faster than this but you did your best. Keep studying!";
        }
    }
    elements.performanceNote.textContent = performanceNote;

    // Set score message based on performance
    const percentage = (score / quiz.questions.length) * 100;
    if (percentage >= 80) {
        elements.scoreMessage.textContent = 'Excellent job! You really know your stuff!';
    } else if (percentage >= 60) {
        elements.scoreMessage.textContent = 'Good effort! With a bit more study, you\'ll master this!';
    } else {
        elements.scoreMessage.textContent = 'Keep practicing! Review the material and try again.';
    }

    // Generate answer review
    elements.answersReview.innerHTML = '';
    quiz.questions.forEach((question, index) => {
        const userAnswer = appState.userAnswers[index];
        const isCorrect = userAnswer && userAnswer.answer === question.correctAnswer;
        const reviewItem = document.createElement('div');
        reviewItem.className = `review-item ${isCorrect ? 'correct' : 'incorrect'}`;
        let timeInfo = '';
        if (userAnswer && userAnswer.timeTaken) {
            timeInfo = `<div class="time-taken">Time: ${userAnswer.timeTaken.toFixed(1)}s</div>`;
        }
        reviewItem.innerHTML = `
            <h4>Question ${index + 1}: ${question.question}</h4>
            <p>Your answer: ${userAnswer ? question.options[userAnswer.answer] : 'Not answered'}</p>
            <p>Correct answer: ${question.options[question.correctAnswer]}</p>
            ${timeInfo}
            ${!isCorrect ? '<p class="explanation">Review this topic to improve your understanding.</p>' : ''}
        `;
        elements.answersReview.appendChild(reviewItem);
    });
    
    // Update user stats if remembered
    if (appState.currentUser && localStorage.getItem('rememberMe') === 'true') {
        updateUserStats('quiz', {
            quiz: quiz,
            score: score,
            totalQuestions: quiz.questions.length,
            averageTime: averageTime
        });
    }

    // --- ADD THIS CHALLENGE LOGIC BLOCK ---
    elements.challengeResultMessage.style.display = 'none'; // Reset display
    if (appState.isChallengeMode) {
        const challengerScore = parseInt(appState.challengeInfo.score.split('/')[0]);
        let resultMessage = '';
        let challengeWon = false;

        if (score > challengerScore) {
            challengeWon = true;
            resultMessage = `Congratulations! You beat ${appState.challengeInfo.name}'s score of ${challengerScore}!`;
            elements.challengeResultMessage.className = 'win';
        } else if (score === challengerScore) {
            resultMessage = `It's a tie! You matched ${appState.challengeInfo.name}'s score. Try again to win!`;
            elements.challengeResultMessage.className = 'loss';
        } else {
            resultMessage = `Good try! You didn't beat ${appState.challengeInfo.name}'s score this time. Keep practicing!`;
            elements.challengeResultMessage.className = 'loss';
        }
        
        elements.challengeResultMessage.textContent = resultMessage;
        elements.challengeResultMessage.style.display = 'block';

        if (localStorage.getItem('rememberMe') === 'true') {
            updateUserStats('challenge', { won: challengeWon });
        }

        // Reset challenge state
        appState.isChallengeMode = false;
        appState.challengeInfo = null;
    }
    // --- END OF CHALLENGE LOGIC BLOCK ---
    
    showPage('results');
}

// Update user statistics
function updateUserStats(type, data) {
    const userData = JSON.parse(localStorage.getItem('userData'));
    if (!userData) return;
    
    // Initialize stats if not present
    if (!userData.stats) {
        userData.stats = {
            quizzesTaken: 0,
            averageScore: 0,
            challengesWon: 0,
            totalQuestions: 0,
            totalVisits: 0,
            todayVisits: 0,
            lastVisit: null,
            challengesShared: 0,
            videosWatched: 0,
            videosCompleted: 0,
            questionTimes: [],
            subjectPerformance: {},
            recentActivities: []
        };
    }
    
    // Handle different types of stat updates
    switch (type) {
        case 'visit':
            const today = new Date().toDateString();
            const lastVisit = userData.stats.lastVisit ? new Date(userData.stats.lastVisit).toDateString() : null;
            
            userData.stats.totalVisits = (userData.stats.totalVisits || 0) + 1;
            
            if (lastVisit === today) {
                userData.stats.todayVisits = (userData.stats.todayVisits || 0) + 1;
            } else {
                userData.stats.todayVisits = 1;
            }
            
            userData.stats.lastVisit = new Date().toISOString();
            break;
            
        case 'quiz':
            const quiz = data.quiz;
            const score = data.score;
            const totalQuestions = data.totalQuestions;
            const averageTime = parseFloat(data.averageTime);
            
            // Update basic stats
            userData.stats.quizzesTaken = (userData.stats.quizzesTaken || 0) + 1;
            userData.stats.totalQuestions = (userData.stats.totalQuestions || 0) + totalQuestions;
            
            // Update average score
            const previousTotal = (userData.stats.averageScore || 0) * (userData.stats.quizzesTaken - 1 || 0);
            userData.stats.averageScore = Math.round((previousTotal + (score / totalQuestions * 100)) / userData.stats.quizzesTaken);
            
            // Store time data for speed calculation
            if (!userData.stats.questionTimes) {
                userData.stats.questionTimes = [];
            }
            userData.stats.questionTimes.push(averageTime);
            
            // Update subject performance
            if (!userData.stats.subjectPerformance) {
                userData.stats.subjectPerformance = {};
            }
            
            if (!userData.stats.subjectPerformance[quiz.subject]) {
                userData.stats.subjectPerformance[quiz.subject] = {
                    attempts: 0,
                    totalScore: 0,
                    averageScore: 0
                };
            }
            
            const subjectStats = userData.stats.subjectPerformance[quiz.subject];
            subjectStats.attempts++;
            subjectStats.totalScore += (score / totalQuestions * 100);
            subjectStats.averageScore = Math.round(subjectStats.totalScore / subjectStats.attempts);
            
            // Add to recent activity
            if (!userData.stats.recentActivities) {
                userData.stats.recentActivities = [];
            }
            
            userData.stats.recentActivities.unshift({
                type: 'quiz',
                subject: quiz.subject,
                quiz: quiz.title,
                score: score,
                total: totalQuestions,
                percentage: Math.round((score / totalQuestions) * 100),
                averageTime: averageTime,
                date: new Date().toISOString()
            });
            
            // Keep only last 10 activities
            if (userData.stats.recentActivities.length > 10) {
                userData.stats.recentActivities.pop();
            }
            break;
            
        case 'videoStarted':
            userData.stats.videosWatched = (userData.stats.videosWatched || 0) + 1;
            
            // Add to recent activity
            userData.stats.recentActivities.unshift({
                type: 'video',
                action: 'started',
                video: data.videoTitle,
                date: new Date().toISOString()
            });
            
            // Keep only last 10 activities
            if (userData.stats.recentActivities.length > 10) {
                userData.stats.recentActivities.pop();
            }
            break;
            
        case 'videoCompleted':
            userData.stats.videosCompleted = (userData.stats.videosCompleted || 0) + 1;
            
            // Add to recent activity
            userData.stats.recentActivities.unshift({
                type: 'video',
                action: 'completed',
                video: data.videoTitle,
                date: new Date().toISOString()
            });
            
            // Keep only last 10 activities
            if (userData.stats.recentActivities.length > 10) {
                userData.stats.recentActivities.pop();
            }
            break;
            
        case 'challengeShared':
            userData.stats.challengesShared = (userData.stats.challengesShared || 0) + 1;
            break;
            
         // --- ADD THIS NEW CASE FOR CHALLENGES ---
        case 'challenge':
            if (data.won) {
                userData.stats.challengesWon = (userData.stats.challengesWon || 0) + 1;
            }
            // Add to recent activity
            userData.stats.recentActivities.unshift({
                type: 'challenge',
                won: data.won,
                opponent: appState.challengeInfo?.name || 'a friend',
                date: new Date().toISOString()
            });
            if (userData.stats.recentActivities.length > 10) {
                userData.stats.recentActivities.pop();
            }
            break;
        // --- END OF NEW CASE ---
    }
    
    // Save updated data
    localStorage.setItem('userData', JSON.stringify(userData));
    appState.currentUser = userData;
    
    // Update UI if on dashboard
    if (appState.currentPage === 'dashboard') {
        updateUserInterface();
        loadRecentActivities();
        calculateSpeedCategory();
    }
}

// Retry the same quiz
function retryQuiz() {
    startQuiz(appState.currentQuiz.id);
}

// --- REPLACE THE ENTIRE shareScore FUNCTION WITH THIS ---
function shareScore(platform) {
    const scoreText = elements.finalScore.textContent;
    const speedText = elements.averageSpeed.textContent.replace('s', '');
    const pfp = localStorage.getItem('profileImage') || 'https://i.imgur.com/your-default-favicon.png'; // Use default if no pfp

    // Create a clean base URL
    const baseUrl = window.location.href.split('?')[0];

    const params = new URLSearchParams({
        challenge: appState.currentUser.username,
        quiz: appState.currentQuiz.id,
        score: scoreText,
        speed: speedText,
        pfp: pfp,
        qOrder: appState.questionOrder.join(',')
    });

    const url = `${baseUrl}?${params.toString()}`;
    const message = `I just scored ${scoreText} on the ${appState.currentQuiz.title} quiz! Can you beat my score?`;
    
    let shareUrl;
    switch (platform) {
        case 'whatsapp':
            shareUrl = `https://wa.me/?text=${encodeURIComponent(message + ' ' + url)}`;
            break;
        case 'telegram':
            shareUrl = `https://t.me/share/url?url=${encodeURIComponent(url)}&text=${encodeURIComponent(message)}`;
            break;
        case 'facebook':
            shareUrl = `https://www.facebook.com/sharer/sharer.php?u=${encodeURIComponent(url)}`;
            break;
        case 'twitter':
            shareUrl = `https://twitter.com/intent/tweet?text=${encodeURIComponent(message)}&url=${encodeURIComponent(url)}`;
            break;
        default:
            return;
    }
    
    if (appState.currentUser && localStorage.getItem('rememberMe') === 'true') {
        updateUserStats('challengeShared');
    }
    
    window.open(shareUrl, '_blank');
}
// --- END OF REPLACEMENT ---

// --- REPLACE THE ENTIRE copyScoreLink FUNCTION WITH THIS ---
function copyScoreLink() {
    const scoreText = elements.finalScore.textContent;
    const speedText = elements.averageSpeed.textContent.replace('s', '');
    const pfp = localStorage.getItem('profileImage') || 'https://i.imgur.com/your-default-favicon.png';

    const baseUrl = window.location.href.split('?')[0];
    const params = new URLSearchParams({
        challenge: appState.currentUser.username,
        quiz: appState.currentQuiz.id,
        score: scoreText,
        speed: speedText,
        pfp: pfp,
        qOrder: appState.questionOrder.join(',')
    });
    const url = `${baseUrl}?${params.toString()}`;
    
    navigator.clipboard.writeText(url).then(() => {
        alert('Challenge link copied to clipboard!');
        if (appState.currentUser && localStorage.getItem('rememberMe') === 'true') {
            updateUserStats('challengeShared');
        }
    }).catch(err => {
        console.error('Failed to copy link: ', err);
        alert('Could not copy link. Please try again.');
    });
}
// --- END OF REPLACEMENT ---


// Initialize study page
function initStudyPage() {
    // Clear video grid
    elements.videoGrid.innerHTML = '';
    
    // Add all videos to the grid
    appState.videos.forEach(video => {
        const videoCard = document.createElement('div');
        videoCard.className = 'video-card';
        videoCard.dataset.id = video.id;
        
        videoCard.innerHTML = `
            <div class="video-thumbnail">
                <img src="https://img.youtube.com/vi/${video.youtubeId}/hqdefault.jpg" alt="${video.title}">
                <div class="play-icon"><i class="fas fa-play-circle"></i></div>
            </div>
            <div class="video-info">
                <div class="video-title">${video.title}</div>
                <p>${video.description}</p>
            </div>
        `;
        
        videoCard.addEventListener('click', () => {
            openVideoModal(video.youtubeId, video.title);
        });
        
        elements.videoGrid.appendChild(videoCard);
    });
}

// Open video modal
function openVideoModal(youtubeId, videoTitle) {
    elements.videoPlayer.innerHTML = `
        <iframe width="100%" height="100%" src="https://www.youtube.com/embed/${youtubeId}" 
            frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture" 
            allowfullscreen></iframe>
    `;
    elements.videoModal.classList.add('active');
    
    // Record video started
    if (appState.currentUser && localStorage.getItem('rememberMe') === 'true') {
        updateUserStats('videoStarted', { videoTitle: videoTitle });
        
        // Set up a timer to check if video is completed (watched for at least 2 minutes)
        let videoTimer = setTimeout(() => {
            updateUserStats('videoCompleted', { videoTitle: videoTitle });
        }, 120000); // 2 minutes
        
        // Clear timer when modal is closed
        elements.closeModal.addEventListener('click', () => {
            clearTimeout(videoTimer);
        }, { once: true });
    }
}

// Close video modal
function closeVideoModal() {
    elements.videoModal.classList.remove('active');
    elements.videoPlayer.innerHTML = '';
}

// Send chat message
function sendChatMessage() {
    const message = elements.chatInput.value.trim();
    if (!message) return;
    
    // Add user message
    addChatMessage(message, 'outgoing');
    elements.chatInput.value = '';
    
    // Get AI response
    const aiResponse = getAIResponse(message, appState.quizzes);
    
    // Simulate AI response after a short delay
    setTimeout(() => {
        addChatMessage(aiResponse, 'incoming');
    }, 1000);
}

// Add chat message to the chat interface
function addChatMessage(text, type) {
    const messageElement = document.createElement('div');
    messageElement.className = `message ${type}`;
    
    const now = new Date();
    const time = `${now.getHours().toString().padStart(2, '0')}:${now.getMinutes().toString().padStart(2, '0')}`;
    
    messageElement.innerHTML = `
        ${text}
        <div class="message-meta">${time}</div>
    `;
    
    elements.chatMessages.appendChild(messageElement);
    elements.chatMessages.scrollTop = elements.chatMessages.scrollHeight;
}

// Initialize dashboard page
function initDashboardPage() {
    // Update stats
    updateUserInterface();
    
    // Load recent activities
    loadRecentActivities();
    
    // Calculate and display speed category
    calculateSpeedCategory();
    
    // Render charts
    renderSubjectPerformanceChart();
    renderProgressOverTimeChart();
}

// Render subject performance chart
// Render subject performance chart
function renderSubjectPerformanceChart() {
    const canvas = document.getElementById('subject-chart');
    if (!canvas) {
        console.error("Subject chart canvas not found");
        return;
    }
    
    // Get the parent element to show messages if needed
    const parent = canvas.parentElement;
    
    // Get subject performance data
    const subjectData = appState.currentUser?.stats?.subjectPerformance || {};
    
    // If no data, show message and hide canvas
    if (Object.keys(subjectData).length === 0) {
        canvas.style.display = 'none';
        const message = document.createElement('p');
        message.textContent = 'No subject data available yet. Take some quizzes to see your performance!';
        message.style.textAlign = 'center';
        message.style.padding = '20px';
        message.style.color = '#666';
        
        // Check if message already exists
        if (!parent.querySelector('p')) {
            parent.appendChild(message);
        }
        return;
    } else {
        canvas.style.display = 'block';
        // Remove any existing message
        const existingMessage = parent.querySelector('p');
        if (existingMessage) {
            parent.removeChild(existingMessage);
        }
    }
    
    // Destroy existing chart if it exists
    if (window.subjectChart) {
        window.subjectChart.destroy();
    }
    
    // Prepare chart data
    const labels = Object.keys(subjectData);
    const data = labels.map(subject => subjectData[subject].averageScore);
    
    try {
        // Create chart
        window.subjectChart = new Chart(canvas, {
            type: 'bar',
            data: {
                labels: labels,
                datasets: [{
                    label: 'Average Score (%)',
                    data: data,
                    backgroundColor: [
                        'rgba(78, 115, 223, 0.7)',
                        'rgba(28, 200, 138, 0.7)',
                        'rgba(246, 194, 62, 0.7)',
                        'rgba(231, 74, 59, 0.7)',
                        'rgba(133, 135, 150, 0.7)'
                    ],
                    borderColor: [
                        'rgba(78, 115, 223, 1)',
                        'rgba(28, 200, 138, 1)',
                        'rgba(246, 194, 62, 1)',
                        'rgba(231, 74, 59, 1)',
                        'rgba(133, 135, 150, 1)'
                    ],
                    borderWidth: 1
                }]
            },
            options: {
                responsive: true,
                maintainAspectRatio: false,
                scales: {
                    y: {
                        beginAtZero: true,
                        max: 100,
                        ticks: {
                            callback: function(value) {
                                return value + '%';
                            }
                        }
                    }
                },
                plugins: {
                    legend: {
                        display: false
                    },
                    tooltip: {
                        callbacks: {
                            label: function(context) {
                                return `Average Score: ${context.parsed.y}%`;
                            }
                        }
                    }
                }
            }
        });
    } catch (error) {
        console.error("Error rendering subject chart:", error);
        canvas.style.display = 'none';
        const errorMessage = document.createElement('p');
        errorMessage.textContent = 'Error loading performance chart.';
        errorMessage.style.textAlign = 'center';
        errorMessage.style.padding = '20px';
        errorMessage.style.color = '#dc3545';
        parent.appendChild(errorMessage);
    }
}

// Render progress over time chart
function renderProgressOverTimeChart() {
    const canvas = document.getElementById('progress-chart');
    if (!canvas) {
        console.error("Progress chart canvas not found");
        return;
    }
    
    // Get the parent element to show messages if needed
    const parent = canvas.parentElement;
    
    // Get recent activities
    const activities = appState.currentUser?.stats?.recentActivities || [];
    
    // Filter quiz activities and sort by date
    const quizActivities = activities
        .filter(activity => activity.type === 'quiz')
        .sort((a, b) => new Date(a.date) - new Date(b.date));
    
    // If no quiz data, show message and hide canvas
    if (quizActivities.length === 0) {
        canvas.style.display = 'none';
        const message = document.createElement('p');
        message.textContent = 'No quiz data available yet. Take some quizzes to track your progress!';
        message.style.textAlign = 'center';
        message.style.padding = '20px';
        message.style.color = '#666';
        
        // Check if message already exists
        if (!parent.querySelector('p')) {
            parent.appendChild(message);
        }
        return;
    } else {
        canvas.style.display = 'block';
        // Remove any existing message
        const existingMessage = parent.querySelector('p');
        if (existingMessage) {
            parent.removeChild(existingMessage);
        }
    }
    
    // Destroy existing chart if it exists
    if (window.progressChart) {
        window.progressChart.destroy();
    }
    
    // Prepare chart data (last 7 quizzes)
    const recentQuizzes = quizActivities.slice(-7);
    const labels = recentQuizzes.map((quiz, index) => `Quiz ${index + 1}`);
    const scores = recentQuizzes.map(quiz => quiz.percentage);
    const timeData = recentQuizzes.map(quiz => quiz.averageTime);
    
    try {
        // Create chart
        window.progressChart = new Chart(canvas, {
            type: 'line',
            data: {
                labels: labels,
                datasets: [
                    {
                        label: 'Score (%)',
                        data: scores,
                        borderColor: 'rgba(78, 115, 223, 1)',
                        backgroundColor: 'rgba(78, 115, 223, 0.2)',
                        yAxisID: 'y',
                        tension: 0.3,
                        fill: true
                    },
                    {
                        label: 'Avg Time (s)',
                        data: timeData,
                        borderColor: 'rgba(28, 200, 138, 1)',
                        backgroundColor: 'rgba(28, 200, 138, 0.2)',
                        yAxisID: 'y1',
                        tension: 0.3,
                        fill: true
                    }
                ]
            },
            options: {
                responsive: true,
                maintainAspectRatio: false,
                interaction: {
                    mode: 'index',
                    intersect: false
                },
                scales: {
                    y: {
                        type: 'linear',
                        display: true,
                        position: 'left',
                        beginAtZero: true,
                        max: 100,
                        ticks: {
                            callback: function(value) {
                                return value + '%';
                            }
                        },
                        title: {
                            display: true,
                            text: 'Score (%)'
                        }
                    },
                    y1: {
                        type: 'linear',
                        display: true,
                        position: 'right',
                        beginAtZero: true,
                        grid: {
                            drawOnChartArea: false,
                        },
                        title: {
                            display: true,
                            text: 'Average Time (seconds)'
                        }
                    }
                },
                plugins: {
                    tooltip: {
                        callbacks: {
                            label: function(context) {
                                let label = context.dataset.label || '';
                                if (label) {
                                    label += ': ';
                                }
                                if (context.datasetIndex === 0) {
                                    label += context.parsed.y + '%';
                                } else {
                                    label += context.parsed.y + 's';
                                }
                                return label;
                            }
                        }
                    }
                }
            }
        });
    } catch (error) {
        console.error("Error rendering progress chart:", error);
        canvas.style.display = 'none';
        const errorMessage = document.createElement('p');
        errorMessage.textContent = 'Error loading progress chart.';
        errorMessage.style.textAlign = 'center';
        errorMessage.style.padding = '20px';
        errorMessage.style.color = '#dc3545';
        parent.appendChild(errorMessage);
    }
}
// Load recent activities
function loadRecentActivities() {
    if (!appState.currentUser || !appState.currentUser.stats || !appState.currentUser.stats.recentActivities) {
        elements.activityList.innerHTML = '<p>No recent activity to display</p>';
        return;
    }
    
    elements.activityList.innerHTML = '';
    
    appState.currentUser.stats.recentActivities.forEach(activity => {
        const activityItem = document.createElement('div');
        activityItem.className = 'activity-item';
        
        let activityText;
        if (activity.type === 'quiz') {
            activityText = `Completed ${activity.quiz} quiz with score ${activity.score}/${activity.total} (${activity.percentage}%)`;
        } else if (activity.type === 'video') {
            activityText = `${activity.action === 'started' ? 'Started' : 'Completed'} watching "${activity.video}"`;
        } else if (activity.type === 'challenge') {
            activityText = `${activity.won ? 'Won' : 'Lost'} a challenge in ${activity.subject}`;
        }
        
        const date = new Date(activity.date);
        const formattedDate = `${date.toLocaleDateString()} ${date.toLocaleTimeString([], {hour: '2-digit', minute:'2-digit'})}`;
        
        activityItem.innerHTML = `
            <div>${activityText}</div>
            <div>${formattedDate}</div>
        `;
        
        elements.activityList.appendChild(activityItem);
    });
}

// Calculate user's speed category
function calculateSpeedCategory() {
    if (!appState.currentUser || !appState.currentUser.stats || 
        !appState.currentUser.stats.questionTimes || 
        appState.currentUser.stats.questionTimes.length === 0) {
        elements.speedCategory.textContent = "No data";
        return;
    }
    
    // Calculate average time per question
    const times = appState.currentUser.stats.questionTimes;
    const averageTime = times.reduce((sum, time) => sum + time, 0) / times.length;
    
    // Determine speed category
    let category;
    if (averageTime < 5) {
        category = "Cheetah";
    } else if (averageTime < 10) {
        category = "Shark";
    } else if (averageTime < 15) {
        category = "Horse";
    } else if (averageTime < 20) {
        category = "Bird";
    } else if (averageTime < 30) {
        category = "Turtle";
    } else {
        category = "Snail";
    }
    
    elements.speedCategory.textContent = category;
}

// Handle profile image upload
/**
 * UPDATED: Saves profile image only if user has consented.
 */
const handleProfileUpload = (e) => {
    const file = e.target.files[0];
    if (!file) return;
    
    const reader = new FileReader();
    reader.onload = (event) => {
        const imageData = event.target.result;
        elements.navProfileImage.innerHTML = `<img src="${imageData}" alt="Profile">`;
        elements.dashboardProfileImage.innerHTML = `<img src="${imageData}" alt="Profile">`;
        
        if (localStorage.getItem('rememberMe') === 'true') {
            localStorage.setItem('profileImage', imageData);
        }
    };
    reader.readAsDataURL(file);
};

// Handle logout with confirmation
/**
 * UPDATED: Handles logout with options to clear or keep data.
 */
const handleLogout = () => {
    const logoutModal = document.getElementById('logout-modal');
    if (!logoutModal) return;
    logoutModal.classList.add('active');

    const clearBtn = document.getElementById('logout-clear');
    const keepBtn = document.getElementById('logout-keep');
    const cancelBtn = document.getElementById('logout-cancel');

    clearBtn.onclick = () => {
        console.log("Logging out and clearing all data.");
        localStorage.clear(); // Strictly clears everything.
        appState.currentUser = null;
        logoutModal.classList.remove('active');
        elements.usernameInput.value = '';
        elements.educationSelect.value = '';
        elements.rememberMe.checked = false;
        updateUserInterface();
        showPage('login');
    };

    keepBtn.onclick = () => {
        console.log("Logging out but keeping data.");
        appState.currentUser = null;
        logoutModal.classList.remove('active');
        showPage('login');
    };

    cancelBtn.onclick = () => logoutModal.classList.remove('active');
};


// Add event listener to your logout button
if (elements.logoutBtn) {
    elements.logoutBtn.addEventListener('click', handleLogout);
}

/**
 * FIXED: Initializes and controls the interactive kaleidoscope background.
/**
 * UPGRADED: Initializes and controls a futuristic, physics-based kaleidoscope background.
 * Features:
 * - Automatic, complex background animations.
 * - Interactive user drawing with a glowing effect.
 * - Drawn shapes are affected by gravity after a delay.
/**
 * UPGRADED V2: Initializes and controls a highly dynamic, physics-based kaleidoscope.
 * Features:
 * - Automatic random shape generation.
 * - Five unique and unpredictable physics simulations for shapes:
 * 1. Gravity Shatter: Falls and shatters on impact.
 * 2. Bouncing Shatter: Bounces three times before shattering.
 * 3. Wind Shear: Dissolves into dust particles blown by wind.
 * 4. Windy Shatter: Shatters on impact, and shards are blown by wind.
 * 5. Evaporation: Dissolves into rising, fading droplets.
 * - Enhanced particle effects for smoke, shards, dust, and droplets.
 * - Interactive user drawing with all physics effects applied.
 */
function initKaleidoscopeBackground() {
    const canvas = document.getElementById('kaleidoscope-bg');
    if (!canvas) {
        console.error('Kaleidoscope canvas not found!');
        return;
    }
    const ctx = canvas.getContext('2d');

    const loginContainer = document.querySelector('.login-container');
    const loginForm = document.querySelector('.login');
    if (loginContainer) loginContainer.style.pointerEvents = 'none';
    if (loginForm) loginForm.style.pointerEvents = 'auto';

    let width, height, centerX, centerY;
    let hue = 0;
    const slices = 10;
    const angleSlice = (Math.PI * 2) / slices;
    const GRAVITY = 0.2;
    const WIND_FORCE = 0.15;

    const mouse = { x: 0, y: 0, oldX: 0, oldY: 0, isDown: false };

    let autoMovers = [];
    let particles = [];
    let drawnObjects = []; // Holds both user-drawn and auto-generated shapes
    let currentPath = [];

    // --- CLASSES for Physics and Effects ---

    class Particle {
        constructor(x, y, color, size, life) {
            this.x = x; this.y = y; this.color = color;
            this.size = size; this.life = life; this.initialLife = life;
        }
        update() { this.life--; }
        draw(context) {
            context.fillStyle = this.color;
            context.globalAlpha = Math.max(0, this.life / this.initialLife);
            context.beginPath();
            context.arc(this.x, this.y, this.size, 0, Math.PI * 2);
            context.fill();
            context.globalAlpha = 1;
        }
    }

    class Shard extends Particle {
        constructor(x, y, color, windAffected = false) {
            super(x, y, color, Math.random() * 8 + 2, 120);
            this.vx = (Math.random() - 0.5) * 15;
            this.vy = (Math.random() * -10) - 5;
            this.angle = Math.random() * Math.PI * 2;
            this.rotation = (Math.random() - 0.5) * 0.2;
            this.windAffected = windAffected;
        }
        update() {
            super.update();
            this.vy += GRAVITY;
            if (this.windAffected) this.vx += WIND_FORCE;
            this.x += this.vx; this.y += this.vy; this.angle += this.rotation;
        }
        draw(context) {
            context.save();
            context.translate(this.x, this.y);
            context.rotate(this.angle);
            context.globalAlpha = Math.max(0, this.life / this.initialLife);
            context.fillStyle = this.color;
            context.beginPath();
            context.moveTo(0, -this.size);
            context.lineTo(-this.size / 2, this.size);
            context.lineTo(this.size / 2, this.size);
            context.closePath();
            context.fill();
            context.restore();
        }
    }
    
    class Dust extends Particle {
        constructor(x, y, color) {
            super(x, y, color, Math.random() * 2 + 1, 200);
            this.vx = (Math.random() - 0.2) * 2; // Start with a little upward pop
            this.vy = (Math.random() - 1) * 2;
        }
        update() {
            super.update();
            this.vx += WIND_FORCE;
            this.x += this.vx; this.y += this.vy;
            this.size *= 0.99;
        }
    }
    
    class Droplet extends Particle {
        constructor(x, y, color) {
            super(x, y, color, Math.random() * 4 + 2, 180);
        }
        update() {
            super.update();
            this.y -= 0.3; // Rise slowly
            this.x += (Math.random() - 0.5) * 0.5;
            this.size *= 0.985;
        }
    }

    class AutoMover {
        constructor() { this.reset(); this.oldX = this.x; this.oldY = this.y; }
        reset() {
            this.x = Math.random() * width; this.y = Math.random() * height;
            this.vx = (Math.random() - 0.5) * 3; this.vy = (Math.random() - 0.5) * 3;
            this.life = Math.random() * 300 + 150;
            this.angle = 0; this.turnSpeed = Math.random() * 0.1 - 0.05;
        }
        update() {
            this.life--; if (this.life <= 0) this.reset();
            this.oldX = this.x; this.oldY = this.y;
            this.angle += this.turnSpeed;
            this.vx += Math.cos(this.angle) * 0.1; this.vy += Math.sin(this.angle) * 0.1;
            this.x += this.vx; this.y += this.vy;
            if (this.x > width || this.x < 0) this.vx *= -1;
            if (this.y > height || this.y < 0) this.vy *= -1;
            this.vx *= 0.99; this.vy *= 0.99;
        }
    }
    
    class DrawnShape {
        constructor(points, color) {
            this.points = points; this.color = color;
            this.vy = 0; this.vx = 0; this.bouncesLeft = 3;
            this.isPhysicsActive = false;
            const deathTypes = ['shatter', 'bounce', 'wind', 'windyShatter', 'evaporate'];
            this.deathType = deathTypes[Math.floor(Math.random() * deathTypes.length)];
            setTimeout(() => { this.isPhysicsActive = true; }, 1500);
        }
    }

    // --- SETUP and EVENT LISTENERS ---

    function setup() {
        width = canvas.width = window.innerWidth;
        height = canvas.height = window.innerHeight;
        centerX = width / 2; centerY = height / 2;
        ctx.fillStyle = 'black'; ctx.fillRect(0, 0, width, height);
        autoMovers = Array.from({ length: 5 }, () => new AutoMover());
    }

    window.addEventListener('resize', setup);

    canvas.addEventListener('mousedown', (e) => {
        mouse.isDown = true; mouse.x = e.clientX; mouse.y = e.clientY;
        currentPath = [{ x: mouse.x, y: mouse.y }];
    });

    canvas.addEventListener('mouseup', (e) => {
        if (!mouse.isDown) return;
        mouse.isDown = false;
        if (currentPath.length > 2) {
            drawnObjects.push(new DrawnShape(currentPath, `hsl(${hue}, 100%, 60%)`));
        }
        currentPath = [];
    });

    canvas.addEventListener('mousemove', (e) => {
        mouse.oldX = mouse.x; mouse.oldY = mouse.y;
        mouse.x = e.clientX; mouse.y = e.clientY;
        if (mouse.isDown) { currentPath.push({ x: mouse.x, y: mouse.y }); }
    });

    function createRandomShape() {
        if (drawnObjects.length > 5) return; // Prevent too many objects
        const startX = Math.random() * width * 0.8 + width * 0.1;
        const startY = Math.random() * height * 0.4; // Appear in top half
        const points = [];
        const length = Math.random() * 100 + 50;
        const angle = Math.random() * Math.PI * 2;
        points.push({ x: startX, y: startY });
        points.push({ x: startX + Math.cos(angle) * length, y: startY + Math.sin(angle) * length });
        drawnObjects.push(new DrawnShape(points, `hsl(${Math.random() * 360}, 100%, 70%)`));
    }

    // --- DRAWING & PHYSICS ---

    function drawKaleidoscopePattern(drawFunc) {
        ctx.save(); ctx.translate(centerX, centerY);
        for (let i = 0; i < slices; i++) {
            ctx.rotate(angleSlice); drawFunc();
            ctx.save(); ctx.scale(-1, 1); drawFunc(); ctx.restore();
        }
        ctx.restore();
    }

    function drawLine(p1, p2, color, lineWidth) {
        ctx.strokeStyle = color; ctx.lineWidth = lineWidth;
        ctx.beginPath();
        ctx.moveTo(p1.x - centerX, p1.y - centerY);
        ctx.lineTo(p2.x - centerX, p2.y - centerY);
        ctx.stroke();
    }

    function animate() {
        ctx.fillStyle = 'rgba(0, 0, 0, 0.15)'; ctx.fillRect(0, 0, width, height);
        hue += 0.5;

        autoMovers.forEach(m => {
            m.update();
            drawKaleidoscopePattern(() => drawLine({x:m.oldX,y:m.oldY}, {x:m.x,y:m.y}, `hsl(${hue+40}, 80%, 40%)`, 1));
        });
        
        if (mouse.isDown && currentPath.length > 1) {
            for (let i=1; i<currentPath.length; i++) {
                drawKaleidoscopePattern(() => {
                    drawLine(currentPath[i-1], currentPath[i], `hsl(${hue}, 100%, 70%)`, 5);
                    drawLine(currentPath[i-1], currentPath[i], 'white', 1);
                });
            }
        }

        drawnObjects.forEach((obj, index) => {
            let bottomY = 0, rightX = 0;
            if (obj.isPhysicsActive) {
                switch(obj.deathType) {
                    case 'wind': case 'evaporate':
                        obj.vx = obj.deathType === 'wind' ? obj.vx + WIND_FORCE : 0;
                        obj.points.forEach((p, pIndex) => {
                            p.x += obj.vx;
                            if (Math.random() < 0.1) {
                                const particle = obj.deathType === 'wind' ? new Dust(p.x, p.y, obj.color) : new Droplet(p.x, p.y, obj.color);
                                particles.push(particle);
                                obj.points.splice(pIndex, 1);
                            }
                            if (p.x > rightX) rightX = p.x;
                        });
                        if (obj.points.length === 0 || rightX > width + 50) drawnObjects.splice(index, 1);
                        break;
                    default: // shatter, bounce, windyShatter
                        obj.vy += GRAVITY;
                        obj.points.forEach(p => { p.y += obj.vy; if (p.y > bottomY) bottomY = p.y; });
                }
            }

            for (let i = 1; i < obj.points.length; i++) {
                drawKaleidoscopePattern(() => drawLine(obj.points[i-1], obj.points[i], obj.color, 4));
            }
            
            if (bottomY > height) {
                if (obj.deathType === 'bounce' && obj.bouncesLeft > 0) {
                    obj.bouncesLeft--; obj.vy *= -0.6; // Reverse velocity and dampen
                    obj.points.forEach(p => p.y = height - (p.y - height)); // Correct position
                } else {
                    obj.points.forEach(p => {
                        const wind = obj.deathType === 'windyShatter';
                        for (let i = 0; i < 3; i++) particles.push(new Shard(p.x, height, obj.color, wind));
                    });
                    drawnObjects.splice(index, 1);
                }
            }
        });

        particles.forEach((p, index) => {
            p.update(); p.draw(ctx);
            if (p.life <= 0) particles.splice(index, 1);
        });

        if (!mouse.isDown && mouse.oldX) {
            drawKaleidoscopePattern(() => drawLine(mouse, mouse, `hsl(${hue}, 100%, 50%)`, 2));
        }

        requestAnimationFrame(animate);
    }

    setup();
    setInterval(createRandomShape, 3000);
    animate();
}


/**
 * NEW handleResize function - much simpler.
 * This will be called automatically by the event listener inside the new background script.
 */
function handleResize() {
    // This is a placeholder now. The new background script handles its own resizing.
    // If you need other elements to be responsive, you can add that logic back here later.
    console.log("Window resized.");
}


// Initialize the app when the DOM is loaded
document.addEventListener('DOMContentLoaded', initApp);

// Handle page refresh - CLEANED UP
window.addEventListener('beforeunload', () => {
    // The new background does not require manual cleanup.
    // This listener can be used for other cleanup tasks in the future.
    console.log("Closing app. Any necessary cleanup can go here.");
});

// AI Response Function (placeholder)
function getAIResponse(message, quizzes) {
    // Simple AI response logic - you can expand this with more sophisticated AI
    const lowerMessage = message.toLowerCase();
    
    if (lowerMessage.includes('hello') || lowerMessage.includes('hi') || lowerMessage.includes('hey')) {
        return "Hello! How can I help you with your studies today?";
    } else if (lowerMessage.includes('quiz') || lowerMessage.includes('test')) {
        return "I can help you prepare for quizzes! Which subject are you studying?";
    } else if (lowerMessage.includes('english')) {
        return "For English, I recommend practicing CV writing, formal letters, and punctuation.";
    } else if (lowerMessage.includes('product realization') || lowerMessage.includes('pr')) {
        return "Product realization covers SWOT analysis and turning concepts into marketable products.";
    } else if (lowerMessage.includes('entrepreneur')) {
        return "Entrepreneurship involves identifying business ideas and creating unique selling propositions.";
    } else if (lowerMessage.includes('mindset') || lowerMessage.includes('growth')) {
        return "A growth mindset is about believing abilities can be developed through dedication and hard work.";
    } else {
        return "I'm here to help you with your studies. You can ask me about quizzes, subjects, or study tips!";
    }
} 

    </script>
</body>
</html>
